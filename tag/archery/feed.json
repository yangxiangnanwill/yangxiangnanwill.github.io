{
    "version": "https://jsonfeed.org/version/1",
    "title": "Will • All posts by \"archery\" tag",
    "description": "愿你一生努力，一生被爱",
    "home_page_url": "https://github.com/yangxiangnanwill/yangxiangnanwill.github.io",
    "items": [
        {
            "id": "https://github.com/yangxiangnanwill/yangxiangnanwill.github.io/2023/05/28/%E5%A5%BD%E5%A5%BD%E7%A0%81%E4%BB%A3%E7%A0%81%E5%90%96/%E5%B7%A5%E5%85%B7/Archery%E6%95%99%E7%A8%8B/",
            "url": "https://github.com/yangxiangnanwill/yangxiangnanwill.github.io/2023/05/28/%E5%A5%BD%E5%A5%BD%E7%A0%81%E4%BB%A3%E7%A0%81%E5%90%96/%E5%B7%A5%E5%85%B7/Archery%E6%95%99%E7%A8%8B/",
            "title": "Archery教程",
            "date_published": "2023-05-28T13:00:29.417Z",
            "content_html": "<blockquote>\n<blockquote>\n<p>本文基于官方文档安装，有不太详细的地方请多多包涵，下方为官方文档连接：</p>\n</blockquote>\n<p><a href=\"https://archerydms.com/\">Archery中文官方文档</a></p>\n</blockquote>\n<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><blockquote>\n<p>Archery是<a href=\"https://github.com/jly8866/archer\">archer</a>的分支项目，定位于SQL审核查询平台，旨在提升DBA的工作效率，支持多数据库的SQL上线和查询，同时支持丰富的MySQL运维功能，所有功能都兼容手机端操作</p>\n</blockquote>\n<h1 id=\"功能清单\"><a href=\"#功能清单\" class=\"headerlink\" title=\"功能清单\"></a>功能清单</h1><table>\n<thead>\n<tr>\n<th align=\"left\">查询</th>\n<th align=\"left\">审核</th>\n<th align=\"left\">执行</th>\n<th align=\"left\">备份</th>\n<th align=\"left\">数据字典</th>\n<th align=\"left\">慢日志</th>\n<th align=\"left\">会话管理</th>\n<th align=\"left\">账号管理</th>\n<th align=\"left\">参数管理</th>\n<th align=\"left\">数据归档</th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">MySQL</td>\n<td align=\"left\">√</td>\n<td align=\"left\">√</td>\n<td align=\"left\">√</td>\n<td align=\"left\">√</td>\n<td align=\"left\">√</td>\n<td align=\"left\">√</td>\n<td align=\"left\">√</td>\n<td align=\"left\">√</td>\n<td align=\"left\">√</td>\n<td>√</td>\n</tr>\n<tr>\n<td align=\"left\">MsSQL</td>\n<td align=\"left\">√</td>\n<td align=\"left\">×</td>\n<td align=\"left\">√</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td>×</td>\n</tr>\n<tr>\n<td align=\"left\">Redis</td>\n<td align=\"left\">√</td>\n<td align=\"left\">×</td>\n<td align=\"left\">√</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td>×</td>\n</tr>\n<tr>\n<td align=\"left\">PgSQL</td>\n<td align=\"left\">√</td>\n<td align=\"left\">×</td>\n<td align=\"left\">√</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td>×</td>\n</tr>\n<tr>\n<td align=\"left\">Oracle</td>\n<td align=\"left\">√</td>\n<td align=\"left\">×</td>\n<td align=\"left\">√</td>\n<td align=\"left\">√</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td>×</td>\n</tr>\n<tr>\n<td align=\"left\">MongoDB</td>\n<td align=\"left\">√</td>\n<td align=\"left\">×</td>\n<td align=\"left\">√</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td align=\"left\">×</td>\n<td>×</td>\n</tr>\n</tbody></table>\n<h1 id=\"部署升级\"><a href=\"#部署升级\" class=\"headerlink\" title=\"部署升级\"></a>部署升级</h1><blockquote>\n<p>支持docker部署、手动部署，支持升级。</p>\n<p>由于安装包部署略微繁琐，本文不提供介绍，详细请看上方文档地址，自行搭建，本次只是提供基于docker的部署教程。</p>\n</blockquote>\n<ul>\n<li>docker部署</li>\n<li>安装包部署</li>\n</ul>\n<h1 id=\"Docker部署\"><a href=\"#Docker部署\" class=\"headerlink\" title=\"Docker部署\"></a>Docker部署</h1><h2 id=\"安装Docker-compose\"><a href=\"#安装Docker-compose\" class=\"headerlink\" title=\"安装Docker-compose\"></a>安装Docker-compose</h2><blockquote>\n<p>安装Docker-compose有两种方法：一个通过Python的pip安装；另外一个是通过连接。</p>\n<p>本文会详细介绍两种方法。</p>\n</blockquote>\n<h3 id=\"通过pip安装\"><a href=\"#通过pip安装\" class=\"headerlink\" title=\"通过pip安装\"></a>通过pip安装</h3><h4 id=\"更新Python3-X版本\"><a href=\"#更新Python3-X版本\" class=\"headerlink\" title=\"更新Python3.X版本\"></a>更新Python3.X版本</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sh\"><span class=\"hljs-comment\"># 进入安装包目录</span><br><span class=\"hljs-built_in\">cd</span> /source<br><span class=\"hljs-comment\"># 下载Python3安装包</span><br>wget https://www.python.org/ftp/python/3.7.10/Python-3.7.10.tgz<br><span class=\"hljs-comment\"># 解压</span><br>tar xzvf Python-3.7.0.tgz<br><span class=\"hljs-built_in\">cd</span> Python-3.7.0<br><span class=\"hljs-built_in\">mkdir</span> /usr/local/src/python3   <span class=\"hljs-comment\">#这个是个人喜好放在这个目录</span><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"安装GC编译器\"><a href=\"#安装GC编译器\" class=\"headerlink\" title=\"安装GC编译器\"></a>安装GC编译器</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs shell\">yum -y install gcc<br></code></pre></td></tr></table></figure>\n\n<blockquote>\n<p>先安装一下GC编译器，要不然编译失败，没办法安装。</p>\n<p><strong>检查一下：</strong>要注意的是产生了：python3和pip3.7</p>\n</blockquote>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs awk\">ls <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/src/</span>python3/bin<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"安装pip\"><a href=\"#安装pip\" class=\"headerlink\" title=\"安装pip\"></a>安装pip</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs shell\"><span class=\"hljs-meta prompt_\"># </span><span class=\"language-bash\">安装依赖</span><br>yum install -y epel-release<br><span class=\"hljs-meta prompt_\">#</span><span class=\"language-bash\">安装pip</span><br>yum install -y python-pip<br><span class=\"hljs-meta prompt_\">#</span><span class=\"language-bash\">查看pip版本</span><br>pip --version<br><span class=\"hljs-meta prompt_\">#</span><span class=\"language-bash\">升级pip版本</span><br>pip install -U pip<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"安装docker-compose\"><a href=\"#安装docker-compose\" class=\"headerlink\" title=\"安装docker-compose\"></a>安装docker-compose</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs shell\"><span class=\"hljs-meta prompt_\"># </span><span class=\"language-bash\">安装</span><br>pip install docker-compose<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"通过docker安装\"><a href=\"#通过docker安装\" class=\"headerlink\" title=\"通过docker安装\"></a>通过docker安装</h3><h4 id=\"安装docker\"><a href=\"#安装docker\" class=\"headerlink\" title=\"安装docker\"></a>安装docker</h4><blockquote>\n<p>已安装docker该步骤略过。</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs shell\">curl -fsSL https://get.docker.com -o get-docker.sh | sudo sh<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"安装-Docker-Compos\"><a href=\"#安装-Docker-Compos\" class=\"headerlink\" title=\"安装 Docker Compos\"></a>安装 Docker Compos</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs shell\">sudo curl -L &quot;https://github.com/docker/compose/releases/download/1.24.1/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose<br>sudo chmod +x /usr/local/bin/docker-compose<br></code></pre></td></tr></table></figure>\n\n<h2 id=\"下载REALEASE文件\"><a href=\"#下载REALEASE文件\" class=\"headerlink\" title=\"下载REALEASE文件\"></a>下载REALEASE文件</h2><blockquote>\n<p>下载下图路径下的文件，里面包含项目执行的所需要的SQL以及依赖。</p>\n</blockquote>\n<p><img src=\"https://gitee.com/yangxiangnanWorkSpace/uploadImages/raw/master/static/20210316105046.png\" alt=\"image-20210316105036672\"></p>\n<h2 id=\"准备运行配置\"><a href=\"#准备运行配置\" class=\"headerlink\" title=\"准备运行配置\"></a>准备运行配置</h2><p>具体可参考：<a href=\"https://github.com/hhyo/Archery/tree/master/src/docker-compose\">文档地址</a></p>\n<blockquote>\n<p>docker-compose.yml文件内的services可按照本身的运行环境来调整，同时注意检查版本号是否正确，比如说外部已经装好了mysql、redis、inception，就可以将对应的services删除，但是需要注意修改settings.py文件的相关配置，具体可以参考<a href=\"https://archerydms.com/installation/manual/#_5\">修改配置</a></p>\n</blockquote>\n<h2 id=\"启动部署\"><a href=\"#启动部署\" class=\"headerlink\" title=\"启动部署\"></a>启动部署</h2><blockquote>\n<p>下载 <a href=\"https://github.com/hhyo/archery/releases/\">Releases</a>文件，解压后进入docker-compose文件夹,按照本文4.3步骤进行本地配置。</p>\n<p>因本人使用的是新建的虚拟机，所以就按照默认配置进行执行了。</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs shell\"><span class=\"hljs-meta prompt_\"># </span><span class=\"language-bash\">启动</span><br>docker-compose -f docker-compose.yml up -d<br><span class=\"hljs-meta prompt_\"></span><br><span class=\"hljs-meta prompt_\"># </span><span class=\"language-bash\">表结构初始化</span><br>docker exec -ti archery /bin/bash<br>cd /opt/archery<br>source /opt/venv4archery/bin/activate<br>python3 manage.py makemigrations sql  <br>python3 manage.py migrate <br><span class=\"hljs-meta prompt_\"></span><br><span class=\"hljs-meta prompt_\"># </span><span class=\"language-bash\">数据初始化</span><br>python3 manage.py dbshell&lt;sql/fixtures/auth_group.sql<br>python3 manage.py dbshell&lt;src/init_sql/mysql_slow_query_review.sql<br><span class=\"hljs-meta prompt_\"></span><br><span class=\"hljs-meta prompt_\"># </span><span class=\"language-bash\">创建管理用户</span><br>python3 manage.py createsuperuser<br><span class=\"hljs-meta prompt_\"></span><br><span class=\"hljs-meta prompt_\"># </span><span class=\"language-bash\">重启</span><br>docker restart archery<br><span class=\"hljs-meta prompt_\"></span><br><span class=\"hljs-meta prompt_\"># </span><span class=\"language-bash\">日志查看和问题排查</span><br>docker logs archery -f --tail=50<br></code></pre></td></tr></table></figure>\n\n<h2 id=\"访问\"><a href=\"#访问\" class=\"headerlink\" title=\"访问\"></a>访问</h2><p><a href=\"http://127.0.0.1:9123/\">http://127.0.0.1:9123</a></p>\n<h2 id=\"启动后配置\"><a href=\"#启动后配置\" class=\"headerlink\" title=\"启动后配置\"></a>启动后配置</h2><p>在启动后 Archery 有一些配置(如Inception , 资源组, 权限组等)需要按需配置, 请详细阅读 <a href=\"https://archerydms.com/configuration/\">配置项说明</a> , 按照自己的需要进行配置</p>\n<h2 id=\"运行界面\"><a href=\"#运行界面\" class=\"headerlink\" title=\"运行界面\"></a>运行界面</h2><p><img src=\"https://gitee.com/yangxiangnanWorkSpace/uploadImages/raw/master/static/20210316113345.png\" alt=\"image-20210316113342723\"></p>\n",
            "tags": [
                "工具",
                "Archery",
                "MySql"
            ]
        }
    ]
}
{
    "version": "https://jsonfeed.org/version/1",
    "title": "Will • All posts by \"工具类\" tag",
    "description": "愿你一生努力，一生被爱",
    "home_page_url": "https://github.com/yangxiangnanwill/yangxiangnanwill.github.io",
    "items": [
        {
            "id": "https://github.com/yangxiangnanwill/yangxiangnanwill.github.io/2023/07/16/%E5%A5%BD%E5%A5%BD%E7%A0%81%E4%BB%A3%E7%A0%81%E5%90%96/JAVA/%E5%B8%B8%E7%94%A8%E7%B1%BB%E5%BA%93%E8%AF%A6%E8%A7%A3/Spring%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E7%B1%BB/",
            "url": "https://github.com/yangxiangnanwill/yangxiangnanwill.github.io/2023/07/16/%E5%A5%BD%E5%A5%BD%E7%A0%81%E4%BB%A3%E7%A0%81%E5%90%96/JAVA/%E5%B8%B8%E7%94%A8%E7%B1%BB%E5%BA%93%E8%AF%A6%E8%A7%A3/Spring%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E7%B1%BB/",
            "title": "Spring常用工具类",
            "date_published": "2023-07-16T09:33:26.151Z",
            "content_html": "<blockquote>\n<p>Spring作为常用的开发框架，在Spring框架应用中，排在ApacheCommon，Guava, Huool等通用库后，第二优先级可以考虑使用Spring-core-xxx.jar中的util包。<br>另外对于工具类，要站在高一点的角度知道有哪些，而不是只看到代码… 用的时候具体看下即可)。</p>\n</blockquote>\n<h1 id=\"内置的resouce类型\"><a href=\"#内置的resouce类型\" class=\"headerlink\" title=\"内置的resouce类型\"></a>内置的resouce类型</h1><ul>\n<li>UrlResource</li>\n<li>ClassPathResource</li>\n<li>FileSystemResource</li>\n<li>ServletContextResource</li>\n<li>InputStreamResource</li>\n<li>ByteArrayResource</li>\n<li>EncodedResource 也就是Resource加上encoding, 可以认为是有编码的资源</li>\n<li>VfsResource(在jboss里经常用到, 相应还有 工具类 VfsUtils)</li>\n<li>org.springframework.util.xml.ResourceUtils 用于处理表达资源字符串前缀描述资源的工具. 如: “classpath:”. 有 getURL, getFile, isFileURL, isJarURL, extractJarFileURL</li>\n</ul>\n<h1 id=\"工具类\"><a href=\"#工具类\" class=\"headerlink\" title=\"工具类\"></a>工具类</h1><ul>\n<li>org.springframework.core.annotation.AnnotationUtils 处理注解</li>\n<li>org.springframework.core.io.support.PathMatchingResourcePatternResolver 用 于处理 ant 匹配风格,找出所有的资源, 结合上面的resource的概念一起使用,对于遍历文件很有用. 具体请详细查看javadoc</li>\n<li>org.springframework.core.io.support.PropertiesLoaderUtils 加载Properties资源工具类,和Resource结合</li>\n<li>org.springframework.core.BridgeMethodResolver 桥接方法分析器. 关于桥接方法请参考: <a href=\"http://java.sun.com/docs/books/jls/third_edition/html/expressions.html#15.12.4.5\">http://java.sun.com/docs/books/jls/third_edition/html/expressions.html#15.12.4.5</a></li>\n<li>org.springframework.core.GenericTypeResolver 范型分析器, 在用于对范型方法, 参数分析.</li>\n<li>org.springframework.core.NestedExceptionUtils</li>\n</ul>\n<h2 id=\"xml工具\"><a href=\"#xml工具\" class=\"headerlink\" title=\"# xml工具\"></a><a href=\"#xml%E5%B7%A5%E5%85%B7\">#</a> xml工具</h2><ul>\n<li>org.springframework.util.xml.AbstractStaxContentHandler</li>\n<li>org.springframework.util.xml.AbstractStaxXMLReader</li>\n<li>org.springframework.util.xml.AbstractXMLReader</li>\n<li>org.springframework.util.xml.AbstractXMLStreamReader</li>\n<li>org.springframework.util.xml.DomUtils</li>\n<li>org.springframework.util.xml.SimpleNamespaceContext</li>\n<li>org.springframework.util.xml.SimpleSaxErrorHandler</li>\n<li>org.springframework.util.xml.SimpleTransformErrorListener</li>\n<li>org.springframework.util.xml.StaxUtils</li>\n<li>org.springframework.util.xml.TransformerUtils</li>\n</ul>\n<h2 id=\"其它工具集\"><a href=\"#其它工具集\" class=\"headerlink\" title=\"# 其它工具集\"></a><a href=\"#%E5%85%B6%E5%AE%83%E5%B7%A5%E5%85%B7%E9%9B%86\">#</a> 其它工具集</h2><ul>\n<li>org.springframework.util.AntPathMatcherant风格的处理</li>\n<li>org.springframework.util.AntPathStringMatcher</li>\n<li>org.springframework.util.Assert断言,在我们的参数判断时应该经常用</li>\n<li>org.springframework.util.CachingMapDecorator</li>\n<li>org.springframework.util.ClassUtils用于Class的处理</li>\n<li>org.springframework.util.CollectionUtils用于处理集合的工具</li>\n<li>org.springframework.util.CommonsLogWriter</li>\n<li>org.springframework.util.CompositeIterator</li>\n<li>org.springframework.util.ConcurrencyThrottleSupport</li>\n<li>org.springframework.util.CustomizableThreadCreator</li>\n<li>org.springframework.util.DefaultPropertiesPersister</li>\n<li>org.springframework.util.DigestUtils摘要处理, 这里有用于md5处理信息的</li>\n<li>org.springframework.util.FileCopyUtils文件的拷贝处理, 结合Resource的概念一起来处理, 真的是很方便</li>\n<li>org.springframework.util.FileSystemUtils</li>\n<li>org.springframework.util.LinkedCaseInsensitiveMap key值不区分大小写的LinkedMap</li>\n<li>org.springframework.util.LinkedMultiValueMap一个key可以存放多个值的LinkedMap</li>\n<li>org.springframework.util.Log4jConfigurer一个log4j的启动加载指定配制文件的工具类</li>\n<li>org.springframework.util.NumberUtils处理数字的工具类, 有parseNumber 可以把字符串处理成我们指定的数字格式, 还支持format格式, convertNumberToTargetClass 可以实现Number类型的转化.</li>\n<li>org.springframework.util.ObjectUtils有很多处理null object的方法. 如nullSafeHashCode, nullSafeEquals, isArray, containsElement, addObjectToArray, 等有用的方法</li>\n<li>org.springframework.util.PatternMatchUtilsspring里用于处理简单的匹配. 如 Spring’s typical “xxx”, “xxx” and “xxx” pattern styles</li>\n<li>org.springframework.util.PropertyPlaceholderHelper用于处理占位符的替换</li>\n<li>org.springframework.util.ReflectionUtils反映常用工具方法. 有 findField, setField, getField, findMethod, invokeMethod等有用的方法</li>\n<li>org.springframework.util.SerializationUtils用于java的序列化与反序列化. serialize与deserialize方法</li>\n<li>org.springframework.util.StopWatch一个很好的用于记录执行时间的工具类, 且可以用于任务分阶段的测试时间. 最后支持一个很好看的打印格式. 这个类应该经常用</li>\n<li>org.springframework.util.StringUtils</li>\n<li>org.springframework.util.SystemPropertyUtils</li>\n<li>org.springframework.util.TypeUtils用于类型相容的判断. isAssignable</li>\n<li>org.springframework.util.WeakReferenceMonitor弱引用的监控</li>\n</ul>\n<h2 id=\"和web相关的工具\"><a href=\"#和web相关的工具\" class=\"headerlink\" title=\"# 和web相关的工具\"></a><a href=\"#%E5%92%8Cweb%E7%9B%B8%E5%85%B3%E7%9A%84%E5%B7%A5%E5%85%B7\">#</a> 和web相关的工具</h2><ul>\n<li>org.springframework.web.util.CookieGenerator</li>\n<li>org.springframework.web.util.HtmlCharacterEntityDecoder</li>\n<li>org.springframework.web.util.HtmlCharacterEntityReferences</li>\n<li>org.springframework.web.util.HtmlUtils</li>\n<li>org.springframework.web.util.HttpUrlTemplate<ul>\n<li>这个类用于用字符串模板构建url, 它会自动处理url里的汉字及其它相关的编码. 在读取别人提供的url资源时, 应该经常用</li>\n<li>String url &#x3D; “<a href=\"http://localhost/myapp/%7Bname%7D/%7Bid%7D\">http://localhost/myapp/{name}/{id}</a>“;</li>\n</ul>\n</li>\n<li>org.springframework.web.util.JavaScriptUtils</li>\n<li>org.springframework.web.util.Log4jConfigListener<ul>\n<li>用listener的方式来配制log4j在web环境下的初始化</li>\n</ul>\n</li>\n<li>org.springframework.web.util.UriTemplate</li>\n<li>org.springframework.web.util.UriUtils处理uri里特殊字符的编码</li>\n<li>org.springframework.web.util.WebUtils</li>\n</ul>\n",
            "tags": [
                "工具类",
                "常用开发库",
                "Spring常用工具类"
            ]
        },
        {
            "id": "https://github.com/yangxiangnanwill/yangxiangnanwill.github.io/2023/07/16/%E5%A5%BD%E5%A5%BD%E7%A0%81%E4%BB%A3%E7%A0%81%E5%90%96/JAVA/%E5%B8%B8%E7%94%A8%E7%B1%BB%E5%BA%93%E8%AF%A6%E8%A7%A3/Hutool/",
            "url": "https://github.com/yangxiangnanwill/yangxiangnanwill.github.io/2023/07/16/%E5%A5%BD%E5%A5%BD%E7%A0%81%E4%BB%A3%E7%A0%81%E5%90%96/JAVA/%E5%B8%B8%E7%94%A8%E7%B1%BB%E5%BA%93%E8%AF%A6%E8%A7%A3/Hutool/",
            "title": "Hutool",
            "date_published": "2023-07-16T08:54:49.158Z",
            "content_html": "<blockquote>\n<p>Hutool作为后起之秀，功能上也比较全。但是要注意一点，它的开源协议是：中国第一个开源协议<a href=\"http://license.coscl.org.cn/MulanPSL\">木兰宽松许可证, 第1版</a>，对此在商业项目中需要谨慎些，在个人项目无所谓。</p>\n</blockquote>\n<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><p>Hutool是一个小而全的Java工具类库，通过静态方法封装，降低相关API的学习成本，提高工作效率，使Java拥有函数式语言般的优雅，让Java语言也可以“甜甜的”。</p>\n<p>Hutool中的工具方法来自于每个用户的精雕细琢，它涵盖了Java开发底层代码中的方方面面，它既是大型项目开发中解决小问题的利器，也是小型项目中的效率担当；</p>\n<p>Hutool是项目中“util”包友好的替代，它节省了开发人员对项目中公用类和公用工具方法的封装时间，使开发专注于业务，同时可以最大限度的避免封装不完善带来的bug。</p>\n<h2 id=\"Hutool名称的由来\"><a href=\"#Hutool名称的由来\" class=\"headerlink\" title=\"Hutool名称的由来\"></a>Hutool名称的由来</h2><p>Hutool &#x3D; Hu + tool，是原公司项目底层代码剥离后的开源库，“Hu”是公司名称的表示，tool表示工具。Hutool谐音“糊涂”，一方面简洁易懂，一方面寓意“难得糊涂”。</p>\n<h2 id=\"Hutool如何改变我们的coding方式\"><a href=\"#Hutool如何改变我们的coding方式\" class=\"headerlink\" title=\"Hutool如何改变我们的coding方式\"></a>Hutool如何改变我们的coding方式</h2><p>Hutool的目标是使用一个工具方法代替一段复杂代码，从而最大限度的避免“复制粘贴”代码的问题，彻底改变我们写代码的方式。</p>\n<p>以计算MD5为例：</p>\n<ul>\n<li>【以前】打开搜索引擎 -&gt; 搜“Java MD5加密” -&gt; 打开某篇博客-&gt; 复制粘贴 -&gt; 改改好用</li>\n<li>【现在】引入Hutool -&gt; SecureUtil.md5()</li>\n</ul>\n<p>Hutool的存在就是为了减少代码搜索成本，避免网络上参差不齐的代码出现导致的bug。</p>\n<h1 id=\"包含组件\"><a href=\"#包含组件\" class=\"headerlink\" title=\"包含组件\"></a>包含组件</h1><p>一个Java基础工具类，对文件、流、加密解密、转码、正则、线程、XML等JDK方法进行封装，组成各种Util工具类，同时提供以下组件：</p>\n<table>\n<thead>\n<tr>\n<th>模块</th>\n<th>介绍</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>hutool-aop</td>\n<td>JDK动态代理封装，提供非IOC下的切面支持</td>\n</tr>\n<tr>\n<td>hutool-bloomFilter</td>\n<td>布隆过滤，提供一些Hash算法的布隆过滤</td>\n</tr>\n<tr>\n<td>hutool-cache</td>\n<td>简单缓存实现</td>\n</tr>\n<tr>\n<td>hutool-core</td>\n<td>核心，包括Bean操作、日期、各种Util等</td>\n</tr>\n<tr>\n<td>hutool-cron</td>\n<td>定时任务模块，提供类Crontab表达式的定时任务</td>\n</tr>\n<tr>\n<td>hutool-crypto</td>\n<td>加密解密模块，提供对称、非对称和摘要算法封装</td>\n</tr>\n<tr>\n<td>hutool-db</td>\n<td>JDBC封装后的数据操作，基于ActiveRecord思想</td>\n</tr>\n<tr>\n<td>hutool-dfa</td>\n<td>基于DFA模型的多关键字查找</td>\n</tr>\n<tr>\n<td>hutool-extra</td>\n<td>扩展模块，对第三方封装（模板引擎、邮件、Servlet、二维码、Emoji、FTP、分词等）</td>\n</tr>\n<tr>\n<td>hutool-http</td>\n<td>基于HttpUrlConnection的Http客户端封装</td>\n</tr>\n<tr>\n<td>hutool-log</td>\n<td>自动识别日志实现的日志门面</td>\n</tr>\n<tr>\n<td>hutool-script</td>\n<td>脚本执行封装，例如Javascript</td>\n</tr>\n<tr>\n<td>hutool-setting</td>\n<td>功能更强大的Setting配置文件和Properties封装</td>\n</tr>\n<tr>\n<td>hutool-system</td>\n<td>系统参数调用封装（JVM信息等）</td>\n</tr>\n<tr>\n<td>hutool-json</td>\n<td>JSON实现</td>\n</tr>\n<tr>\n<td>hutool-captcha</td>\n<td>图片验证码实现</td>\n</tr>\n<tr>\n<td>hutool-poi</td>\n<td>针对POI中Excel的封装</td>\n</tr>\n<tr>\n<td>hutool-socket</td>\n<td>基于Java的NIO和AIO的Socket封装</td>\n</tr>\n</tbody></table>\n<p>可以根据需求对每个模块单独引入，也可以通过引入<code>hutool-all</code>方式引入所有模块。</p>\n<h1 id=\"文档\"><a href=\"#文档\" class=\"headerlink\" title=\"文档\"></a>文档</h1><ul>\n<li><a href=\"https://www.hutool.cn/docs/\">中文文档</a> 看这里</li>\n<li><a href=\"https://www.hutool.club/docs/\">中文文档（备用）</a></li>\n<li><a href=\"https://apidoc.gitee.com/loolly/hutool/\">参考API</a></li>\n</ul>\n<h1 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h1><h2 id=\"Maven\"><a href=\"#Maven\" class=\"headerlink\" title=\"Maven\"></a>Maven</h2><p>在项目的pom.xml的dependencies中加入以下内容:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>cn.hutool<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>hutool-all<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>              <br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>5.1.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n<h2 id=\"Gradle\"><a href=\"#Gradle\" class=\"headerlink\" title=\"Gradle\"></a>Gradle</h2><figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs gradle\"><span class=\"hljs-keyword\">compile</span> <span class=\"hljs-string\">&#x27;cn.hutool:hutool-all:5.1.0&#x27;</span><br></code></pre></td></tr></table></figure>\n\n<h2 id=\"非Maven项目\"><a href=\"#非Maven项目\" class=\"headerlink\" title=\"非Maven项目\"></a>非Maven项目</h2><p>点击以下任一链接，下载<code>hutool-all-X.X.X.jar</code>即可：</p>\n<ul>\n<li><a href=\"https://repo1.maven.org/maven2/cn/hutool/hutool-all/5.1.0/\">Maven中央库1</a></li>\n<li><a href=\"http://repo2.maven.org/maven2/cn/hutool/hutool-all/5.1.0/\">Maven中央库2</a></li>\n</ul>\n<blockquote>\n<p>注意 Hutool 5.x支持JDK8+，对Android平台没有测试，不能保证所有工具类获工具方法可用。 如果你的项目使用JDK7，请使用Hutool 4.x版本</p>\n</blockquote>\n<h2 id=\"编译安装\"><a href=\"#编译安装\" class=\"headerlink\" title=\"编译安装\"></a>编译安装</h2><p>访问Hutool的码云主页：<a href=\"https://gitee.com/loolly/hutool\">https://gitee.com/loolly/hutool在新窗口打开</a> 下载整个项目源码（v5-master或v5-dev分支都可）然后进入Hutool项目目录执行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">./hutool.sh install<br></code></pre></td></tr></table></figure>\n\n<p>然后就可以使用Maven引入了。</p>\n<hr>\n<p>著作权归@pdai所有 原文链接：<a href=\"https://pdai.tech/md/develop/package/dev-package-x-hu-tool.html\">https://pdai.tech/md/develop/package/dev-package-x-hu-tool.html</a></p>\n",
            "tags": [
                "Hutool",
                "工具类",
                "常用开发库"
            ]
        },
        {
            "id": "https://github.com/yangxiangnanwill/yangxiangnanwill.github.io/2023/07/03/%E5%A5%BD%E5%A5%BD%E7%A0%81%E4%BB%A3%E7%A0%81%E5%90%96/JAVA/%E5%B8%B8%E7%94%A8%E7%B1%BB%E5%BA%93%E8%AF%A6%E8%A7%A3/Google%20Guava/",
            "url": "https://github.com/yangxiangnanwill/yangxiangnanwill.github.io/2023/07/03/%E5%A5%BD%E5%A5%BD%E7%A0%81%E4%BB%A3%E7%A0%81%E5%90%96/JAVA/%E5%B8%B8%E7%94%A8%E7%B1%BB%E5%BA%93%E8%AF%A6%E8%A7%A3/Google%20Guava/",
            "title": "Google Guava",
            "date_published": "2023-07-03T07:55:32.429Z",
            "content_html": "<h1 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h1><p>Guava工程包含了若干被Google的 Java项目广泛依赖 的核心库，例如：集合 <code>[collections]</code> 、缓存<code> [caching]</code> 、原生类型支持 <code>[primitives support]</code> 、并发库<code> [concurrency libraries]</code> 、通用注解<code> [common annotations]</code> 、字符串处理<code> [string processing]</code> 、<code>I/O</code> 等等。 所有这些工具每天都在被Google的工程师应用在产品服务中。</p>\n<p>guava的优点：</p>\n<ul>\n<li>高效设计良好的API，被Google的开发者设计，实现和使用</li>\n<li>遵循高效的java语法实践</li>\n<li>使代码更刻度，简洁，简单</li>\n<li>节约时间，资源，提高生产力</li>\n</ul>\n<h1 id=\"推荐网址\"><a href=\"#推荐网址\" class=\"headerlink\" title=\"推荐网址\"></a>推荐网址</h1><ul>\n<li><a href=\"https://github.com/google/guava/wiki/Home\">Guava Wiki</a></li>\n<li><a href=\"https://guava.dev/releases/snapshot-jre/api/docs/\">Guava API Doc</a></li>\n<li><a href=\"https://github.com/google/guava\">Guava Github</a></li>\n<li><a href=\"http://ifeve.com/google-guava/\">Guava 中文教程 - ifeve.com</a></li>\n</ul>\n<h1 id=\"使用Guava\"><a href=\"#使用Guava\" class=\"headerlink\" title=\"使用Guava\"></a>使用Guava</h1><blockquote>\n<p>注意：JDK 1.8 or higher.</p>\n</blockquote>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.google.guava<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>guava<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>28.2-jre<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>  <span class=\"hljs-comment\">&lt;!-- or, for Android: --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>28.2-android<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n<h1 id=\"内容简介\"><a href=\"#内容简介\" class=\"headerlink\" title=\"内容简介\"></a>内容简介</h1><h2 id=\"基本工具-Basic-utilities\"><a href=\"#基本工具-Basic-utilities\" class=\"headerlink\" title=\"基本工具 [Basic utilities]\"></a>基本工具 <code>[Basic utilities]</code></h2><p>让使用Java语言变得更舒适</p>\n<h3 id=\"Optional\"><a href=\"#Optional\" class=\"headerlink\" title=\"Optional\"></a>Optional</h3><blockquote>\n<p> 使用和避免null：null是模棱两可的，会引起令人困惑的错误，有些时候它让人很不舒服。很多Guava工具类用快速失败拒绝null值，而不是盲目地接受</p>\n</blockquote>\n<p>Optional类是Java8为了解决null值判断问题，借鉴google guava类库的Optional类而引入的一个同名Optional类，使用Optional类可以避免显式的null值判断（null的防御性检查），避免null导致的NPE（NullPointerException）。</p>\n<p>这里讲的optional 也是指jdk中的optional，其实二者类似，但是编码使用gauva的optional，阿里巴巴编程规范会提醒换成jdk自带的optional。</p>\n<p>这里强调一下Optional的用法。</p>\n<ul>\n<li><strong>不要用isPressent判断一个对象是否为空</strong><br>这种用法不但没有减少null的防御性检查，而且增加了Optional包装的过程，违背了Optional设计的初衷，因此开发中要避免这种糟糕的使用</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">enum</span> <span class=\"hljs-title class_\">TestEnum</span> &#123;<br>    <span class=\"hljs-comment\">/***</span><br><span class=\"hljs-comment\">     * 编号和对应的名称</span><br><span class=\"hljs-comment\">     */</span><br>    a(<span class=\"hljs-string\">&quot;aaa&quot;</span>, <span class=\"hljs-string\">&quot;aname&quot;</span>),<br>    b(<span class=\"hljs-string\">&quot;bbbb&quot;</span>, <span class=\"hljs-string\">&quot;bname&quot;</span>),<br>    c(<span class=\"hljs-string\">&quot;cccc&quot;</span>, <span class=\"hljs-string\">&quot;cname&quot;</span>),<br>    ;<br>    <span class=\"hljs-meta\">@Getter</span><br>    <span class=\"hljs-keyword\">private</span> String code;<br>    <span class=\"hljs-meta\">@Getter</span><br>    <span class=\"hljs-keyword\">private</span> String name;<br><br>    TestEnum(String code, String name) &#123;<br>        <span class=\"hljs-built_in\">this</span>.code = code;<br>        <span class=\"hljs-built_in\">this</span>.name = name;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> String <span class=\"hljs-title function_\">getNameByCod</span><span class=\"hljs-params\">(String code)</span> &#123;<br>        Optional&lt;String&gt; nameOfCode = Arrays.stream(TestEnum.values())<br>                .filter(item -&gt; StringUtils.equals(item.code, code))<br>                .map(TestEnum::getName)<br>                .findFirst();<br>        <span class=\"hljs-comment\">//不要这样使用optional 这样optional的意义：优雅的处理空指针 就不存在了</span><br>        <span class=\"hljs-keyword\">if</span> (nameOfCode.isPresent()) &#123;<br>            <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">RuntimeException</span>(<span class=\"hljs-string\">&quot;不存在&quot;</span>);<br>        &#125;<br>        <span class=\"hljs-comment\">// 请使用orElseThrow 和orElse</span><br>        <span class=\"hljs-keyword\">return</span> nameOfCode.orElseThrow(() -&gt; <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">RuntimeException</span>(<span class=\"hljs-string\">&quot;不存在&quot;</span>));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<ul>\n<li><strong>考虑让方法返回optional</strong></li>\n</ul>\n<p>《Effective Java》中对方法返回Optional的一些观点:</p>\n<ul>\n<li>容器（包括，集合，映射，数组，stream，optional）都不应该包装在Optional进行返回，返回空的容器能让客户端免于处理一个Optional</li>\n<li>如果无法返回结果，且没有返回结果客户端必须进行特殊的处理，那么就应该声明返回optional</li>\n<li>返回optional并不是一个不需要成本的操作，无论返回空，还是非空，使用optional作为返回值的方法都是需要初始化的，所以optional在看重性能的情况下使用不当是一种性能的浪费</li>\n<li>永远不要返回基本类型对于包装类型的Optional，这需要进行基本类型-&gt;包装类型-&gt;optional的三层包装，可以使用OptionalInt，optionallong等。</li>\n</ul>\n<h3 id=\"PreConditions前置条件检查\"><a href=\"#PreConditions前置条件检查\" class=\"headerlink\" title=\"PreConditions前置条件检查\"></a>PreConditions前置条件检查</h3><p>前置条件: 让方法中的条件检查更简单</p>\n<p>根据参数分为三种：</p>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>没有额外参数</td>\n<td>抛出的异常中没有错误消息</td>\n</tr>\n<tr>\n<td>有一个Object对象作为额外参数</td>\n<td>抛出的异常使用Object.toString() 作为错误消息</td>\n</tr>\n<tr>\n<td>有一个String对象作为额外参数，并且有一组任意数量的附加Object对象</td>\n<td>这个变种处理异常消息的方式有点类似printf，但考虑GWT的兼容性和效率，只支持%s指示符。</td>\n</tr>\n</tbody></table>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> String <span class=\"hljs-title function_\">test1</span><span class=\"hljs-params\">(Integer index, List&lt;String&gt;list)</span>&#123;<br>    <span class=\"hljs-keyword\">if</span> (Objects.isNull(index))&#123;<br>        <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">RuntimeException</span>(<span class=\"hljs-string\">&quot;index不可以为空&quot;</span>);<br>    &#125;<br>    <span class=\"hljs-keyword\">if</span> (CollectionUtils.isEmpty(list))&#123;<br>        <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">RuntimeException</span>(<span class=\"hljs-string\">&quot;list不可以为空&quot;</span>);<br>    &#125;<br>    <span class=\"hljs-keyword\">if</span> (index&lt;<span class=\"hljs-number\">0</span>||index&gt;=list.size())&#123;<br>        <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">RuntimeException</span>(String.format(<span class=\"hljs-string\">&quot;越界无法获取，下标%S&quot;</span>,index));<br>    &#125;<br>    <span class=\"hljs-keyword\">return</span> list.get(index);<br>&#125;<br><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> String <span class=\"hljs-title function_\">test2</span><span class=\"hljs-params\">(Integer index, List&lt;String&gt;list)</span>&#123;<br>    Preconditions.checkNotNull(index,<span class=\"hljs-string\">&quot;index不可以为空&quot;</span>);<br>    Preconditions.checkNotNull(list,<span class=\"hljs-string\">&quot;list不可以为空&quot;</span>);<br>    Preconditions.checkElementIndex(index,list.size(),String.format(<span class=\"hljs-string\">&quot;越界无法获取，下标%S&quot;</span>,index));<br>    Preconditions.checkArgument(index &gt;= <span class=\"hljs-number\">0</span>&amp;&amp;index&lt;list.size(),<span class=\"hljs-string\">&quot;越界无法获取，下标%S&quot;</span>,index);<br>    <span class=\"hljs-keyword\">return</span> list.get(index);<br>&#125;<br><br></code></pre></td></tr></table></figure>\n\n<p>test1 缺点：if看起来臃肿，优点：可用抛出我们系统的自定义异常便于前端反馈<br>test2 优点：简单直接，缺点：抛出的都是jdk中的异常，通一异常处理可能无法返回正确提示的通一结果集给前端<br>我们可用写一个带异常Class的工具类或者直接代理guava中的Predition 加一层try catch 使我其抛出我们系统的自定义异常。</p>\n<h3 id=\"ComparisonChain和Ordering\"><a href=\"#ComparisonChain和Ordering\" class=\"headerlink\" title=\"ComparisonChain和Ordering\"></a>ComparisonChain和Ordering</h3><p>想象一个场景，人先根据age排序后根据height排序</p>\n<h4 id=\"实现comparable\"><a href=\"#实现comparable\" class=\"headerlink\" title=\"实现comparable\"></a>实现comparable</h4><p>这是常规写法。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-meta\">@Data</span><br><span class=\"hljs-meta\">@Builder</span><br><span class=\"hljs-meta\">@NoArgsConstructor</span><br><span class=\"hljs-meta\">@AllArgsConstructor</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">People</span> <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title class_\">Comparable</span>&lt;People&gt; &#123;<br>    <span class=\"hljs-keyword\">private</span> Integer age;<br>    <span class=\"hljs-keyword\">private</span> Integer height;<br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-type\">int</span> <span class=\"hljs-title function_\">compareTo</span><span class=\"hljs-params\">(People o)</span> &#123;<br>        <span class=\"hljs-keyword\">if</span> (!Objects.equals(<span class=\"hljs-built_in\">this</span>.age, o.age)) &#123;<br>            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">this</span>.age - o.age;<br>        &#125;<span class=\"hljs-keyword\">else</span> &#123;<br>            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">this</span>.height - o.height;<br>        &#125;<br>    &#125;<br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String[] args)</span> &#123;<br>        <span class=\"hljs-type\">People</span> <span class=\"hljs-variable\">p1</span> <span class=\"hljs-operator\">=</span> People.builder().build();<br>        <span class=\"hljs-type\">People</span> <span class=\"hljs-variable\">p2</span> <span class=\"hljs-operator\">=</span> People.builder().build();<br>        List&lt;People&gt; list = Arrays.asList(p1, p2);<br>        Collections.sort(list);<br>        System.out.println(list);<br>    &#125;<br>&#125;<br><br><span class=\"hljs-comment\">//你或许会写得更高级一点 如下</span><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-type\">int</span> <span class=\"hljs-title function_\">compareTo</span><span class=\"hljs-params\">(People o)</span> &#123;<br>        <span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">ageCompare</span> <span class=\"hljs-operator\">=</span> Ints.compare(<span class=\"hljs-built_in\">this</span>.age, o.age);<br>        <span class=\"hljs-keyword\">if</span> (ageCompare==<span class=\"hljs-number\">0</span>)&#123;<br>            <span class=\"hljs-keyword\">return</span> Ints.compare(<span class=\"hljs-built_in\">this</span>.height, o.height);<br>        &#125;<span class=\"hljs-keyword\">else</span> &#123;<br>            <span class=\"hljs-keyword\">return</span> ageCompare;<br>        &#125;<br>    &#125;<br><br></code></pre></td></tr></table></figure>\n\n<p>上述代码缺点：</p>\n<ul>\n<li>写法繁琐  </li>\n<li>忽略了空指针， return this.age - o.age; 这一句存在空指针的情况，对null进行拆箱直接NPE（NullPoint Exception，及空指针异常）  </li>\n<li>维护复杂，再加一个存款，加逻辑复杂。</li>\n</ul>\n<h4 id=\"JAVA8使用Stream进行操作\"><a href=\"#JAVA8使用Stream进行操作\" class=\"headerlink\" title=\"JAVA8使用Stream进行操作\"></a>JAVA8使用Stream进行操作</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-meta\">@Override</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-type\">int</span> <span class=\"hljs-title function_\">compareTo</span><span class=\"hljs-params\">(People o)</span> &#123;<br>    <span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">thisAge</span> <span class=\"hljs-operator\">=</span> Optional.ofNullable(<span class=\"hljs-built_in\">this</span>.age).orElse(Integer.MAX_VALUE);<br>    <span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">thisHeight</span> <span class=\"hljs-operator\">=</span> Optional.ofNullable(<span class=\"hljs-built_in\">this</span>.height).orElse(Integer.MAX_VALUE);<br>    <span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">oAge</span> <span class=\"hljs-operator\">=</span> Optional.ofNullable(o.age).orElse(Integer.MAX_VALUE);<br>    <span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">oHeight</span> <span class=\"hljs-operator\">=</span> Optional.ofNullable(o.height).orElse(Integer.MAX_VALUE);<br>    <span class=\"hljs-keyword\">if</span> (thisAge!=oAge)&#123;<br>        <span class=\"hljs-keyword\">return</span> thisAge-oAge;<br>    &#125;<span class=\"hljs-keyword\">else</span> &#123;<br>        <span class=\"hljs-keyword\">return</span> thisHeight - oHeight;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>上述代码，规避了NPE,但是缺点依旧存在：</p>\n<ul>\n<li>Stream复杂的写法，导致语法不明显，逻辑不通俗易懂。</li>\n<li>维护复杂，如果增加条件则需要变更方法。</li>\n</ul>\n<h4 id=\"ComparisonChain\"><a href=\"#ComparisonChain\" class=\"headerlink\" title=\"ComparisonChain\"></a>ComparisonChain</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-meta\">@Override</span>  <br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-type\">int</span> <span class=\"hljs-title function_\">compareTo</span><span class=\"hljs-params\">(People o)</span> &#123;  <br>    <span class=\"hljs-keyword\">return</span> ComparisonChain.start()  <br>            .compare(<span class=\"hljs-built_in\">this</span>.getAge(), o.getAge(), Ordering.natural().nullsFirst())  <br>            .compare(<span class=\"hljs-built_in\">this</span>.getHeight(), o.getHeight(), Ordering.natural().nullsFirst())  <br>            .result();  <br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>优点：</p>\n<ul>\n<li>优雅的处理空指针，传入比较器 Ordering.natural().nullsFirst() 让null在最前面</li>\n<li>语义化明显：先比较age 后比较 height，null在最前面</li>\n<li>更易于维护，只需要加一行</li>\n</ul>\n<h4 id=\"Ordering\"><a href=\"#Ordering\" class=\"headerlink\" title=\"Ordering\"></a>Ordering</h4><p>Ordering是Guava流畅风格比较器Comparator的实现，它可以用来构建复杂的比较器，以完成排序的功能。</p>\n<p>从实现上说Ordering实例就是一个特殊的Comparator实例。Ordering把很多基于Comparator的静态方法比如</p>\n<p>Collections.max包装成自己的实例方法(非静态方法)，并且提供了链式调用方法，来定制和增强现有的比较器。</p>\n<h5 id=\"创建排序器\"><a href=\"#创建排序器\" class=\"headerlink\" title=\"创建排序器\"></a>创建排序器</h5><p>常见的排序器可以由下面的静态方法创建</p>\n<ul>\n<li>natural()</li>\n</ul>\n<p>对可排序类型做自然排序，如数字按照大小，日期按照先后顺序</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">List&lt;Integer&gt; list = Lists.newArrayList(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">5</span>,<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">6</span>,<span class=\"hljs-number\">9</span>,<span class=\"hljs-number\">7</span>,<span class=\"hljs-number\">8</span>);<br>    list.sort(Ordering.natural());<br>    System.out.println(list.toString());<span class=\"hljs-comment\">//[1, 3, 5, 6, 7, 8, 9]</span><br></code></pre></td></tr></table></figure>\n\n<ul>\n<li>usingToString()</li>\n</ul>\n<p>按对象的字符串形式做字典排序，即使用toString()返回的字符串按字典顺序进行排序。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">List&lt;String&gt; stringList = Lists.newArrayList(<span class=\"hljs-string\">&quot;zhangsan&quot;</span>,<span class=\"hljs-string\">&quot;lisi&quot;</span>,<span class=\"hljs-string\">&quot;wangwu&quot;</span>);<br>        Collections.sort(stringList,Ordering.usingToString());<br>        System.out.println(stringList.toString());<span class=\"hljs-comment\">//[lisi, wangwu, zhangsan]</span><br>        list.sort(Ordering.usingToString());<br>        System.out.println(list.toString());<span class=\"hljs-comment\">//[1, 3, 5, 6, 7, 8, 9]</span><br></code></pre></td></tr></table></figure>\n\n<ul>\n<li>from()<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-type\">User</span> <span class=\"hljs-variable\">zhangsan</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">User</span>(<span class=\"hljs-string\">&quot;张三&quot;</span>,<span class=\"hljs-number\">20</span>,<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Company</span>());<br><span class=\"hljs-type\">User</span> <span class=\"hljs-variable\">lisi</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">User</span>(<span class=\"hljs-string\">&quot;李四&quot;</span>,<span class=\"hljs-number\">30</span>,<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Company</span>());<br>List&lt;User&gt; users =  Lists.newArrayList(zhangsan,lisi);<br><span class=\"hljs-comment\">//按照age字段进行排序</span><br>Ordering&lt;User&gt; ordering1 = Ordering.from(Comparator.comparingInt(u -&gt; u.getAge()));<br>users.sort(ordering1);<br>System.out.println(users.toString());<br></code></pre></td></tr></table></figure></li>\n</ul>\n<h5 id=\"链式调用方法\"><a href=\"#链式调用方法\" class=\"headerlink\" title=\"链式调用方法\"></a>链式调用方法</h5><ul>\n<li><p>reverse()<br>获取语义相反的排序器</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">List&lt;Integer&gt; list = Lists.newArrayList(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">5</span>,<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">6</span>,<span class=\"hljs-number\">9</span>,<span class=\"hljs-number\">7</span>,<span class=\"hljs-number\">8</span>);<br>list.sort(Ordering.natural().reverse());<br>System.out.println(list.toString());<span class=\"hljs-comment\">//[9, 8, 7, 6, 5, 3, 1]</span><br></code></pre></td></tr></table></figure>\n</li>\n<li><p>nullsFirst()<br>使用当前排序器，但额外把null值排到最前面</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">List&lt;Integer&gt; list1 = Arrays.asList(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">5</span>, <span class=\"hljs-literal\">null</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">8</span>, <span class=\"hljs-number\">2</span>);<br><span class=\"hljs-comment\">//Collections.sort(list1); // 出现异常...</span><br>Collections.sort(list1, Ordering.natural().nullsFirst());<br>System.out.println(list1);<span class=\"hljs-comment\">//[null, 1, 2, 3, 5, 8]</span><br></code></pre></td></tr></table></figure></li>\n<li><p>nullsLast()<br>使用当前排序器，但额外把null值排到最后面</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">List&lt;Integer&gt; list2 = Arrays.asList(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">5</span>, <span class=\"hljs-literal\">null</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">8</span>, <span class=\"hljs-number\">2</span>);<br><span class=\"hljs-comment\">//Collections.sort(list1); // 出现异常...</span><br>Collections.sort(list1, Ordering.natural().nullsLast());<br>System.out.println(list1);<span class=\"hljs-comment\">//[1, 2, 3, 5, 8, null]</span><br></code></pre></td></tr></table></figure></li>\n<li><p>compound(Comparator)<br>成另一个比较器，以处理当前排序器中的相等情况</p>\n</li>\n</ul>\n<p>首先按照年龄进行排序，如果年龄相同则按照薪水排序</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">Comparator&lt;UserPojo&gt; objectComparator = Comparator.comparingInt(u -&gt; u.getAge());<br>        Comparator&lt;UserPojo&gt; objectComparator2 = Comparator.comparing(u -&gt; u.getSalary());<br>        Ordering&lt;UserPojo&gt; ordering1 = Ordering.from(objectComparator).compound(objectComparator2);<br>        <span class=\"hljs-type\">UserPojo</span> <span class=\"hljs-variable\">zhangsan</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">UserPojo</span>(<span class=\"hljs-string\">&quot;张三&quot;</span>,<span class=\"hljs-number\">20</span>,<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Company</span>(),<span class=\"hljs-number\">1000</span>);<br>        <span class=\"hljs-type\">UserPojo</span> <span class=\"hljs-variable\">lisi</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">UserPojo</span>(<span class=\"hljs-string\">&quot;李四&quot;</span>,<span class=\"hljs-number\">30</span>,<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Company</span>(),<span class=\"hljs-number\">2000</span>);<br>        <span class=\"hljs-type\">UserPojo</span> <span class=\"hljs-variable\">wangwu</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">UserPojo</span>(<span class=\"hljs-string\">&quot;王五&quot;</span>,<span class=\"hljs-number\">30</span>,<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Company</span>(),<span class=\"hljs-number\">3000</span>);<br>        <span class=\"hljs-type\">UserPojo</span> <span class=\"hljs-variable\">amao</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">UserPojo</span>(<span class=\"hljs-string\">&quot;杨猫&quot;</span>,<span class=\"hljs-number\">30</span>,<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Company</span>(),<span class=\"hljs-number\">4000</span>);<br>        List&lt;UserPojo&gt; users =  Lists.newArrayList(zhangsan,lisi,wangwu,amao);<br>        users.sort(ordering1);<br>        <span class=\"hljs-comment\">//[UserPojo(name=张三, age= 20,company=Company(name=null, address=null), salary=1000), UserPojo(name=李四, age= 30,company=Company(name=null, address=null), salary=2000), UserPojo(name=王五, age= 30,company=Company(name=null, address=null), salary=3000), UserPojo(name=杨猫, age= 30,company=Company(name=null, address=null), salary=4000)]</span><br>        System.out.println(users.toString());<br></code></pre></td></tr></table></figure>\n\n<ul>\n<li>onResultOf(Function)<br>把比较器的元素使用Function函数转化成一个值result，再对这个值应用Ordering的比较方法。result的排序顺序就是最后的排序顺序<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">List&lt;UserPojo&gt; users2 =  Lists.newArrayList(zhangsan,lisi,wangwu,amao,<span class=\"hljs-literal\">null</span>);<br>        Ordering&lt;UserPojo&gt; fOrdering = Ordering.natural().onResultOf(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Function</span>&lt;UserPojo, Comparable&gt;() &#123;<br>            <span class=\"hljs-meta\">@Override</span><br>            <span class=\"hljs-keyword\">public</span> <span class=\"hljs-meta\">@Nullable</span> Comparable <span class=\"hljs-title function_\">apply</span><span class=\"hljs-params\">(<span class=\"hljs-meta\">@Nullable</span> UserPojo userPojo)</span> &#123;<br>                <span class=\"hljs-keyword\">return</span> userPojo.getSalary();<br>            &#125;<br>        &#125;).nullsFirst();<br>        users2.sort(fOrdering);<br>        <span class=\"hljs-comment\">//[null, UserPojo(name=张三, age= 20,company=Company(name=null, address=null), salary=1000), UserPojo(name=李四, age= 30,company=Company(name=null, address=null), salary=2000), UserPojo(name=王五, age= 30,company=Company(name=null, address=null), salary=3000), UserPojo(name=杨猫, age= 30,company=Company(name=null, address=null), salary=4000)]</span><br>        System.out.println(users2.toString());<br></code></pre></td></tr></table></figure></li>\n</ul>\n<p>注意</p>\n<blockquote>\n<p>注意链式排序器的调用顺序–从右往左的顺序，上面Ordering.natural().onResultOf().nullsFirst();<br>先调用apply方法获取salary值，并把salary为null的元素放到最前面，然后把剩下的进行自然排序<br>所以如果将nullsFirst放在onResultOf的左边则会报异常</p>\n</blockquote>\n<h5 id=\"运用排序器\"><a href=\"#运用排序器\" class=\"headerlink\" title=\"运用排序器\"></a>运用排序器</h5><ul>\n<li><p>greatestOf(Iterable iterable,int k)<br>获取可迭代对象中最大的k个元素</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">List&lt;Integer&gt; result = Ordering.natural().greatestOf(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ArrayList</span>&lt;&gt;(Arrays.asList(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">5</span>)),<span class=\"hljs-number\">2</span>);<br>       System.out.println(result);<span class=\"hljs-comment\">//[5, 4]</span><br></code></pre></td></tr></table></figure>\n</li>\n<li><p>leastOf(Iterable iterable,int k)<br>对元素按照从小到大排序，并返回前k个元素</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">List&lt;Integer&gt; result1 = Ordering.natural().leastOf(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ArrayList</span>&lt;&gt;(Arrays.asList(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">5</span>)),<span class=\"hljs-number\">2</span>);<br>System.out.println(result1);<span class=\"hljs-comment\">//[1, 2]</span><br></code></pre></td></tr></table></figure></li>\n<li><p>isOrdered(Iterable)<br>判断可迭代对象是否已按照排序器排序:允许有排序值相等的元素</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">List&lt;Integer&gt; list = Arrays.asList(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">5</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">8</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">2</span>);<br>Collections.sort(list);<br><span class=\"hljs-type\">boolean</span> <span class=\"hljs-variable\">order</span> <span class=\"hljs-operator\">=</span> Ordering.natural().isOrdered(list);<br>System.out.println(order);<span class=\"hljs-comment\">//true</span><br></code></pre></td></tr></table></figure></li>\n<li><p>sortedCopy(Iterable)<br>返回一个新的已经排序的列表，原来的列表顺序不会变</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">List&lt;Integer&gt; nums = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ArrayList</span>&lt;&gt;(Arrays.asList(<span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">3</span>));<br>List&lt;Integer&gt; resultCopy = Ordering.natural().sortedCopy(nums);<br>System.out.println(resultCopy); <span class=\"hljs-comment\">// [1, 3, 4]</span><br>System.out.println(nums); <span class=\"hljs-comment\">// [4, 1, 3]</span><br></code></pre></td></tr></table></figure></li>\n<li><p>min(E,E,…)<br>返回最小值，如果有多个，则返回第一个</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-type\">Integer</span> <span class=\"hljs-variable\">min</span> <span class=\"hljs-operator\">=</span> Ordering.natural().min(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">1</span>);<br>System.out.println(min);<br></code></pre></td></tr></table></figure></li>\n<li><p>max(E,E,…)<br>返回最大值，如果有多个，则返回第一个</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-type\">Integer</span> <span class=\"hljs-variable\">max</span> <span class=\"hljs-operator\">=</span> Ordering.natural().max(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">1</span>);<br>System.out.println(max)<br></code></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"不可变集合\"><a href=\"#不可变集合\" class=\"headerlink\" title=\"不可变集合\"></a>不可变集合</h3><p>使用场景：</p>\n<p>如定义一系列状态比如吃饭，睡觉，过马路，需要根据这个状态判断是否可以玩手机，可以在类中定义集合包装这个三个状态，如果当前状态属于三个之一那么不可以玩手机，你可以使用基本的hashset，但是hashset的元素可以被更改，导致可能方法的判断和原本的语义出现出入</p>\n<p>优点</p>\n<p>当对象被不可信的库调用时，不可变形式是安全的；<br>不可变对象被多个线程调用时，不存在竞态条件问题<br>不可变集合不需要考虑变化，因此可以节省时间和空间。所有不可变的集合都比它们的可变 形式有更好的内存利用率（分析和测试细节）；<br>不可变对象因为有固定不变，可以作为常量来安全使用</p>\n<h3 id=\"新集合类型\"><a href=\"#新集合类型\" class=\"headerlink\" title=\"新集合类型\"></a>新集合类型</h3><h4 id=\"Multiset\"><a href=\"#Multiset\" class=\"headerlink\" title=\"Multiset\"></a>Multiset</h4><p>可以用两种方式看待Multiset：</p>\n<ul>\n<li>没有元素顺序限制的ArrayList<br>  当把Multiset看成普通的Collection时，它表现得就像无序的ArrayList<ul>\n<li>add(E)添加单个给定元素</li>\n<li>iterator()返回一个迭代器，包含Multiset的所有元素（包括重复的元素）</li>\n<li>size()返回所有元素的总个数（包括重复的元素）</li>\n<li>Map&lt;E, Integer&gt;，键为元素，值为计数0</li>\n</ul>\n</li>\n<li>Multiset看作Map&lt;E, Integer&gt;时，它也提供了符合性能期望的查询操作：<br>  - count(Object)返回给定元素的计数。HashMultiset.count的复杂度为O(1)，TreeMultiset.count的复杂度为O(log n)。<br>  - entrySet()返回Set&lt;Multiset.Entry&gt;，和Map的entrySet类似。<br>  - elementSet()返回所有不重复元素的Set，和Map的keySet()类似。</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MultiSetTest</span> &#123;<br><br>    <span class=\"hljs-comment\">/****</span><br><span class=\"hljs-comment\">     * java 8 一下</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@param</span> list</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@return</span></span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> Map&lt;String, Integer&gt; <span class=\"hljs-title function_\">statisticsWordCount1</span><span class=\"hljs-params\">(List&lt;String&gt; list)</span> &#123;<br>        Map&lt;String, Integer&gt; countMap = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">HashMap</span>&lt;&gt;();<br>        <span class=\"hljs-keyword\">if</span> (list == <span class=\"hljs-literal\">null</span> || list.size() == <span class=\"hljs-number\">0</span>) &#123;<br>            <span class=\"hljs-keyword\">return</span> countMap;<br>        &#125;<br>        <span class=\"hljs-keyword\">for</span> (String s : list) &#123;<br>            <span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">nowCount</span> <span class=\"hljs-operator\">=</span> countMap.getOrDefault(s, <span class=\"hljs-number\">0</span>);<br>            countMap.put(s, nowCount + <span class=\"hljs-number\">1</span>);<br>        &#125;<br>        <span class=\"hljs-keyword\">return</span> countMap;<br>    &#125;<br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * java 8</span><br><span class=\"hljs-comment\">     *</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@param</span> list</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@return</span></span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> Map&lt;String, Integer&gt; <span class=\"hljs-title function_\">statisticsWordCount2</span><span class=\"hljs-params\">(List&lt;String&gt; list)</span> &#123;<br>        list = Optional.ofNullable(list).orElse(Collections.emptyList());<br>        <span class=\"hljs-keyword\">return</span> list.stream()<br>                .collect(Collectors.groupingBy(t -&gt; t,<br>                        Collectors.reducing(<span class=\"hljs-number\">0</span>, num -&gt; <span class=\"hljs-number\">1</span>, Integer::sum)));<br><br>    &#125;<br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * guava api</span><br><span class=\"hljs-comment\">     *</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@param</span> list</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@return</span></span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> Map&lt;String, Integer&gt; <span class=\"hljs-title function_\">statisticsWordCount3</span><span class=\"hljs-params\">(List&lt;String&gt; list)</span> &#123;<br>        list = Optional.ofNullable(list).orElse(Collections.emptyList());<br>        HashMultiset&lt;String&gt; multiset = HashMultiset.create(list);<br>        System.out.println(multiset);<br>        <span class=\"hljs-keyword\">return</span> multiset.stream()<br>                .collect(Collectors.toMap(item -&gt; item, multiset::count, BinaryOperator.maxBy(Ordering.natural())));<br>    &#125;<br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String[] args)</span> &#123;<br>        Map&lt;String, Integer&gt; map = statisticsWordCount3(Arrays.asList(<span class=\"hljs-string\">&quot;a&quot;</span>, <span class=\"hljs-string\">&quot;b&quot;</span>, <span class=\"hljs-string\">&quot;a&quot;</span>, <span class=\"hljs-string\">&quot;c&quot;</span>));<br>        map.forEach((k, v) -&gt; System.out.println(k + <span class=\"hljs-string\">&quot;-&quot;</span> + v));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<h4 id=\"SortedMultiset\"><a href=\"#SortedMultiset\" class=\"headerlink\" title=\"SortedMultiset\"></a>SortedMultiset</h4><p>Multiset 接口的变种，它支持高效地获取指定范围的子集。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SortMultiSetTest</span> &#123;<br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * 在不改变源money 元素的情况下 统计介于min和max间的钱</span><br><span class=\"hljs-comment\">     * money中的null 视为0</span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> List&lt;Float&gt; <span class=\"hljs-title function_\">findMoneyBetween1</span><span class=\"hljs-params\">(<span class=\"hljs-type\">float</span> min, <span class=\"hljs-type\">float</span> max, List&lt;Float&gt; money)</span> &#123;<br>        money = Optional.ofNullable(money).orElse(Collections.emptyList());<br>        <span class=\"hljs-keyword\">return</span> money.stream().map(item -&gt; Optional.ofNullable(item).orElse(<span class=\"hljs-number\">0F</span>))<br>                .filter(item -&gt; item &gt; min &amp;&amp; item &lt; max)<br>                .collect(Collectors.toList());<br>    &#125;<br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * 在不改变源money 元素的情况下 统计介于min和max间的钱</span><br><span class=\"hljs-comment\">     * money中的null 视为0</span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> List&lt;Float&gt; <span class=\"hljs-title function_\">findMoneyBetween2</span><span class=\"hljs-params\">(<span class=\"hljs-type\">float</span> min, <span class=\"hljs-type\">float</span> max, List&lt;Float&gt; money)</span> &#123;<br>        money = Optional.ofNullable(money).orElse(Collections.emptyList());<br>        TreeMultiset&lt;Float&gt; treeMultiset = TreeMultiset.create(Ordering.&lt;Float&gt;natural().onResultOf(f1 -&gt; Optional.ofNullable(f1).orElse(<span class=\"hljs-number\">0F</span>)));<br>        treeMultiset.addAll(money);<br>        <span class=\"hljs-keyword\">return</span> Lists.newLinkedList(treeMultiset.subMultiset(min, BoundType.CLOSED, max, BoundType.CLOSED));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<h4 id=\"Multimap\"><a href=\"#Multimap\" class=\"headerlink\" title=\"Multimap\"></a>Multimap</h4><p>Guava的 Multimap可以很容易地把一个键映射到多个值。换句话说，Multimap是把键映射到任意多个值的一般方式。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> Map&lt;String, Collection&lt;Integer&gt;&gt; <span class=\"hljs-title function_\">mergeMap1</span><span class=\"hljs-params\">(Map&lt;String, Integer&gt; map1, Map&lt;String, Integer&gt; map2)</span> &#123;<br>    map1 = Optional.ofNullable(map1).orElse(Collections.emptyMap());<br>    map2 = Optional.ofNullable(map2).orElse(Collections.emptyMap());<br>    Set&lt;String&gt; allKey = Stream.of(map1.keySet(), map2.keySet()).flatMap(Collection::stream).collect(Collectors.toSet());<br>    Map&lt;String, Collection&lt;Integer&gt;&gt; resMap = Maps.newHashMap();<br>    <span class=\"hljs-keyword\">for</span> (String key : allKey) &#123;<br>        <span class=\"hljs-type\">Integer</span> <span class=\"hljs-variable\">integer1</span> <span class=\"hljs-operator\">=</span> map1.get(key);<br>        <span class=\"hljs-type\">Integer</span> <span class=\"hljs-variable\">integer2</span> <span class=\"hljs-operator\">=</span> map2.get(key);<br>        Set&lt;Integer&gt; tempSet = Sets.newHashSet();<br>        <span class=\"hljs-keyword\">if</span> (Objects.nonNull(integer1)) &#123;<br>            tempSet.add(integer1);<br>        &#125;<br>        <span class=\"hljs-keyword\">if</span> (Objects.nonNull(integer2)) &#123;<br>            tempSet.add(integer2);<br>        &#125;<br>        resMap.put(key, tempSet);<br>    &#125;<br>    <span class=\"hljs-keyword\">return</span> resMap;<br>&#125;<br><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> Map&lt;String, Collection&lt;Integer&gt;&gt; <span class=\"hljs-title function_\">mergeMap2</span><span class=\"hljs-params\">(Map&lt;String, Integer&gt; map1, Map&lt;String, Integer&gt; map2)</span> &#123;<br>    map1 = Optional.ofNullable(map1).orElse(Collections.emptyMap());<br>    map2 = Optional.ofNullable(map2).orElse(Collections.emptyMap());<br>    Multimap&lt;String, Integer&gt; multimap = HashMultimap.create();<br>    map1.forEach(multimap::put);<br>    map2.forEach(multimap::put);<br>    <span class=\"hljs-keyword\">return</span> multimap.asMap();<br>&#125;<br><br></code></pre></td></tr></table></figure>\n<h4 id=\"BiMap\"><a href=\"#BiMap\" class=\"headerlink\" title=\"BiMap\"></a>BiMap</h4><p>BiMap是特殊的Map：</p>\n<ul>\n<li>可以用 inverse()反转BiMap&lt;K, V&gt;的键值映射</li>\n<li>保证值是唯一的，因此 values()返回Set而不是普通的Collection</li>\n<li>在BiMap中，如果你想把键映射到已经存在的值，会抛出IllegalArgumentException异常。如果对特定值，你想要强制替换它的键，请使用 BiMap.forcePut(key, value)。<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">BiMapLearn</span> &#123;<br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String[] args)</span> &#123;<br>        <span class=\"hljs-comment\">//想象这是用户id 和用户名对应map</span><br>        <span class=\"hljs-comment\">//你需要根据id查询用户名。根据用户名查询id（用户名同样不可以重复）</span><br>        HashBiMap&lt;String, String&gt; userNameAndIdMap = HashBiMap.create();<br>        userNameAndIdMap.put(<span class=\"hljs-string\">&quot;2017015600&quot;</span>,<span class=\"hljs-string\">&quot;陈兴cupk&quot;</span>);<br>        userNameAndIdMap.put(<span class=\"hljs-string\">&quot;80309525&quot;</span>,<span class=\"hljs-string\">&quot;陈兴cmbnk&quot;</span>);<br>        <span class=\"hljs-comment\">// 重复value 会抛出异常ava.lang.IllegalArgumentException:</span><br>        <span class=\"hljs-comment\">// value already present: 陈兴cmbnk</span><br><span class=\"hljs-comment\">//        userNameAndIdMap.put(&quot;309525&quot;,&quot;陈兴cmbnk&quot;);</span><br>        <span class=\"hljs-comment\">//forcePut 可以强制替换 key -value 组合</span><br><span class=\"hljs-comment\">//        userNameAndIdMap.forcePut(&quot;309525&quot;,&quot;陈兴cmbnk&quot;);</span><br>        System.out.println(userNameAndIdMap.get(<span class=\"hljs-string\">&quot;2017015600&quot;</span>));<br>        System.out.println(userNameAndIdMap.inverse().get(<span class=\"hljs-string\">&quot;陈兴cmbnk&quot;</span>));<br>        System.out.println(userNameAndIdMap.get(<span class=\"hljs-string\">&quot;80309525&quot;</span>));<br>        <span class=\"hljs-comment\">//set类型的key value</span><br>        Set&lt;String&gt; strings = userNameAndIdMap.keySet();<br>        Set&lt;String&gt; values = userNameAndIdMap.values();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>\n</ul>\n<h4 id=\"Table\"><a href=\"#Table\" class=\"headerlink\" title=\"Table\"></a>Table</h4><p>使用场景：当你需要多个字段作为key时，你可能为这个key编写一个类，重写equals和hashMap。或者使用形同Map&lt;FirstName, Map&lt;LastName, Person&gt;&gt;的map结构，前者编码繁琐，后者使用不友好（第一个get后判空，后才能左第二次get）</p>\n<p>Guava为此提供了新集合类型Table，它有两个支持所有类型的键：”行”和”列”。Table提供多种视图，以便你从各种角度使用它：</p>\n<p>rowMap()：用Map&lt;R, Map&lt;C, V&gt;&gt;表现Table&lt;R, C, V&gt;。同样的， rowKeySet()返回”行”的集合Set。</p>\n<p>row ：用Map&lt;C, V&gt;返回给定”行”的所有列，对这个map进行的写操作也将写入Table中。</p>\n<p>类似的列访问方法：columnMap()、columnKeySet()、column。（基于列的访问会比基于的行访问稍微低效点）</p>\n<p>cellSet()：用元素类型为Table.Cell的Set表现Table&lt;R, C, V&gt;。Cell类似于Map.Entry，但它是用行和列两个键区分的。</p>\n<p>使用案例</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TableLearn</span> &#123;<br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String[] args)</span> &#123;<br>        System.out.println(getNameByAgeAndNo1(<span class=\"hljs-number\">17</span>, <span class=\"hljs-string\">&quot;201715600&quot;</span>));<br>        System.out.println(getNameByAgeAndNo2(<span class=\"hljs-number\">17</span>, <span class=\"hljs-string\">&quot;201715600&quot;</span>));<br>    &#125;<br><br>\t<span class=\"hljs-comment\">//根据年龄和编号 获取名字，编写KeyOfAgeAndNo 重写equals hashcode</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> String <span class=\"hljs-title function_\">getNameByAgeAndNo1</span><span class=\"hljs-params\">(<span class=\"hljs-type\">int</span> age,String no)</span>&#123;<br>        HashMap&lt;KeyOfAgeAndNo, String&gt; memory = Maps.newHashMap();<br>        memory.put(KeyOfAgeAndNo.of(<span class=\"hljs-number\">17</span>,<span class=\"hljs-string\">&quot;201715600&quot;</span>),<span class=\"hljs-string\">&quot;大一的陈兴&quot;</span>);<br>        memory.put(KeyOfAgeAndNo.of(<span class=\"hljs-number\">14</span>,<span class=\"hljs-string\">&quot;0929&quot;</span>),<span class=\"hljs-string\">&quot;高一的陈兴&quot;</span>);<br>        memory.put(KeyOfAgeAndNo.of(<span class=\"hljs-number\">20</span>,<span class=\"hljs-string\">&quot;80303697&quot;</span>),<span class=\"hljs-string\">&quot;实习的陈兴&quot;</span>);<br><br>        <span class=\"hljs-keyword\">return</span> Optional.ofNullable(memory.get(KeyOfAgeAndNo.of(age, no)))<br>                .orElseThrow(() -&gt; <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">RuntimeException</span>(<span class=\"hljs-string\">&quot;查无此人&quot;</span>));<br>    &#125;<br>\t<span class=\"hljs-comment\">//编写KeyOfAgeAndNo 重写equals hashcode</span><br>    <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">KeyOfAgeAndNo</span>&#123;<br>        Integer age;<br>        String no;<br>        <span class=\"hljs-keyword\">static</span> KeyOfAgeAndNo <span class=\"hljs-title function_\">of</span><span class=\"hljs-params\">( Integer age,String no)</span>&#123;<br>            <span class=\"hljs-type\">KeyOfAgeAndNo</span> <span class=\"hljs-variable\">res</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">KeyOfAgeAndNo</span>();<br>            res.age=age;<br>            res.no=no;<br>            <span class=\"hljs-keyword\">return</span> res;<br>        &#125;<br>        <span class=\"hljs-meta\">@Override</span><br>        <span class=\"hljs-keyword\">public</span> <span class=\"hljs-type\">boolean</span> <span class=\"hljs-title function_\">equals</span><span class=\"hljs-params\">(Object o)</span> &#123;<br>            <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-built_in\">this</span> == o) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">true</span>;<br>            <span class=\"hljs-keyword\">if</span> (!(o <span class=\"hljs-keyword\">instanceof</span> KeyOfAgeAndNo)) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>;<br>            <span class=\"hljs-type\">KeyOfAgeAndNo</span> <span class=\"hljs-variable\">that</span> <span class=\"hljs-operator\">=</span> (KeyOfAgeAndNo) o;<br>            <span class=\"hljs-keyword\">return</span> Objects.equals(age, that.age) &amp;&amp;<br>                    Objects.equals(no, that.no);<br>        &#125;<br><br>        <span class=\"hljs-meta\">@Override</span><br>        <span class=\"hljs-keyword\">public</span> <span class=\"hljs-type\">int</span> <span class=\"hljs-title function_\">hashCode</span><span class=\"hljs-params\">()</span> &#123;<br>            <span class=\"hljs-keyword\">return</span> Objects.hash(age, no);<br>        &#125;<br>    &#125;<br>\t<span class=\"hljs-comment\">//使用table </span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> String <span class=\"hljs-title function_\">getNameByAgeAndNo2</span><span class=\"hljs-params\">(<span class=\"hljs-type\">int</span> age,String no)</span>&#123;<br>        HashBasedTable&lt;Integer ,String,String&gt;table=HashBasedTable.create();<br>        table.put(<span class=\"hljs-number\">17</span>,<span class=\"hljs-string\">&quot;201715600&quot;</span>,<span class=\"hljs-string\">&quot;大一的陈兴&quot;</span>);<br>        table.put(<span class=\"hljs-number\">14</span>,<span class=\"hljs-string\">&quot;0929&quot;</span>,<span class=\"hljs-string\">&quot;高一的陈兴&quot;</span>);<br>        table.put(<span class=\"hljs-number\">20</span>,<span class=\"hljs-string\">&quot;80303697&quot;</span>,<span class=\"hljs-string\">&quot;实习的陈兴&quot;</span>);<br>        <span class=\"hljs-keyword\">return</span> Optional.ofNullable(table.get(age, no))<br>                .orElseThrow(() -&gt; <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">RuntimeException</span>(<span class=\"hljs-string\">&quot;查无此人&quot;</span>));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<h4 id=\"ClassToInstanceMap\"><a href=\"#ClassToInstanceMap\" class=\"headerlink\" title=\"ClassToInstanceMap\"></a>ClassToInstanceMap</h4><ul>\n<li>使用场景，类型指向实例，使用普通map需要</li>\n<li>示例<br>  getInstanceByClass1需要进行强转因为map get方法返回object类型，不能限制key的类型<br>  getInstanceByClass2则没有这种需要 且可以限定key的类型<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ClassToInstanceMapLearn</span> &#123;<br><span class=\"hljs-comment\">//静态内部类实现单例 和ClassToInstanceMap 使用没有必要关系</span><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SingletonHolder</span> &#123;<br>        <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> ClassToInstanceMapLearn INSTANCE;<br><br>        <span class=\"hljs-keyword\">static</span> &#123;<br>            INSTANCE = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ClassToInstanceMapLearn</span>();<br>        &#125;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-title function_\">ClassToInstanceMapLearn</span><span class=\"hljs-params\">()</span> &#123;<br>        System.out.println(<span class=\"hljs-string\">&quot;ClassToInstanceMapLearn Constructor&quot;</span>);<br>    &#125;<br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> ClassToInstanceMapLearn <span class=\"hljs-title function_\">newInstance</span><span class=\"hljs-params\">()</span> &#123;<br>        <span class=\"hljs-keyword\">return</span> SingletonHolder.INSTANCE;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> Map&lt;Class&lt;?&gt;, ? <span class=\"hljs-built_in\">super</span> ClassToInstanceMapLearn&gt; Memory1 = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">HashMap</span>&lt;&gt;();<br><br>    <span class=\"hljs-keyword\">static</span> &#123;<br>        Memory1.put(ClassToInstanceMapLearn.class, ClassToInstanceMapLearn.newInstance());<br>        <span class=\"hljs-comment\">//加入从 简单工场拿SingletonHolder实例 强转化 将抛出异常</span><br>        Memory1.put(SingletonHolder.class, ClassToInstanceMapLearn.newInstance());<br>    &#125;<br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> &lt;T <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">ClassToInstanceMapLearn</span>&gt; T <span class=\"hljs-title function_\">getInstanceByClass1</span><span class=\"hljs-params\">(Class&lt;T&gt; clazz)</span> &#123;<br>        <span class=\"hljs-comment\">//需要强转需要去判断 是否是clazz的实例 错误写法</span><br>        <span class=\"hljs-keyword\">return</span> (T) Optional.ofNullable(Memory1.get(clazz))<br>                .orElseThrow(() -&gt; <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">RuntimeException</span>(<span class=\"hljs-string\">&quot;不存在&quot;</span>));<br>    &#125;<br><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> ClassToInstanceMap&lt;? <span class=\"hljs-built_in\">super</span> ClassToInstanceMapLearn&gt; Memory2 = MutableClassToInstanceMap.create();<br><br>    <span class=\"hljs-keyword\">static</span> &#123;<br>        Memory2.putInstance(ClassToInstanceMapLearn.class, ClassToInstanceMapLearn.newInstance());<br>        <span class=\"hljs-comment\">//无法加入</span><br><span class=\"hljs-comment\">//        Memory2.put(SingletonHolder.class, ClassToInstanceMapLearn.newInstance());</span><br>    &#125;<br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> &lt;T <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">ClassToInstanceMapLearn</span>&gt; T <span class=\"hljs-title function_\">getInstanceByClass2</span><span class=\"hljs-params\">(Class&lt;T&gt; clazz)</span> &#123;<br>        <span class=\"hljs-comment\">//不需要强转</span><br>        <span class=\"hljs-keyword\">return</span> Optional.ofNullable(Memory2.getInstance(clazz))<br>                .orElseThrow(() -&gt; <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">RuntimeException</span>(<span class=\"hljs-string\">&quot;不存在&quot;</span>));<br>    &#125;<br><br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String[] args)</span> &#123;<br>        System.out.println(getInstanceByClass1(ClassToInstanceMapLearn.class));<br>         System.out.println(getInstanceByClass2(ClassToInstanceMapLearn.class));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"集合-Collections\"><a href=\"#集合-Collections\" class=\"headerlink\" title=\"集合[Collections]\"></a>集合<code>[Collections]</code></h2><p>Guava对JDK集合的扩展，这是Guava最成熟和为人所知的部分<br>guava 中的集合工具常常以集合名称加s出现</p>\n<ul>\n<li>Collections2 因为java存在Collections guava加了2</li>\n<li>Lists</li>\n<li>Maps</li>\n<li>Sets<br>等等 上面介绍的新集合类型也存在对应的工具类<br>这些工具类的共性<strong>都存在静态工厂方法</strong><br>为什么要使用静态工厂方法，它相比于构造方法（这里的静态工厂方法不是指，设计模式中的工厂模式）<br>《Effective Java》第一条 使用静态工厂方法代替构造器，给予了解答</li>\n<li>静态工厂方法有名字<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">//这一句是什么意思</span><br><span class=\"hljs-type\">BigInteger</span> <span class=\"hljs-variable\">big1</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">BigInteger</span>(<span class=\"hljs-number\">10</span>, <span class=\"hljs-number\">100</span>, <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Random</span>(<span class=\"hljs-number\">10</span>));<br>System.out.println(big1);<br><span class=\"hljs-comment\">//这一句又是什么意思</span><br><span class=\"hljs-type\">BigInteger</span> <span class=\"hljs-variable\">big2</span> <span class=\"hljs-operator\">=</span> BigInteger.probablePrime(<span class=\"hljs-number\">10</span>, <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Random</span>(<span class=\"hljs-number\">10</span>));<br>System.out.println(big2);<br></code></pre></td></tr></table></figure></li>\n<li>静态工厂方法，不必每次都生成一个对象<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">//虽然下面两句都在放屁，但是前者的屁更臭</span><br><span class=\"hljs-type\">boolean</span> <span class=\"hljs-variable\">flag</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Random</span>().nextInt() % <span class=\"hljs-number\">2</span> == <span class=\"hljs-number\">0</span>;<br><span class=\"hljs-comment\">//每次生成一个新对象</span><br><span class=\"hljs-type\">Boolean</span> <span class=\"hljs-variable\">b1</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Boolean</span>(flag);<br><span class=\"hljs-comment\">//不会生成新对象</span><br><span class=\"hljs-type\">Boolean</span> <span class=\"hljs-variable\">b2</span> <span class=\"hljs-operator\">=</span> Boolean.valueOf(flag);<br></code></pre></td></tr></table></figure></li>\n<li>静态工厂方法可以返回任何原返回类型的子类型，如guava中的api</li>\n<li>静态工厂的返回对象的类可也随着每次调用而变化，取决于入参类似于简单工厂模式</li>\n<li>静态工厂方法返回的对象所属的类可以在，在编写百行该静态工厂方法的类时不存在，如JDBC数据库连接</li>\n</ul>\n<h3 id=\"Collections2\"><a href=\"#Collections2\" class=\"headerlink\" title=\"Collections2\"></a>Collections2</h3><ul>\n<li>过滤<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">filterLearn</span><span class=\"hljs-params\">()</span> &#123;<br>    List&lt;Integer&gt; list = Arrays.asList(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">4</span>, <span class=\"hljs-literal\">null</span>);<br>    Collection&lt;Integer&gt; filter = Collections2.filter(list, Objects::nonNull);<br>    System.out.println(list);<br>    System.out.println(filter);<br>    <span class=\"hljs-comment\">//返回一个继承了AbstractCollection的集合</span><br>    System.out.println(filter.getClass());<br>&#125;<br></code></pre></td></tr></table></figure></li>\n<li>转换<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Collections2Test</span> &#123;<br>    <span class=\"hljs-keyword\">private</span> Integer nums;<br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-title function_\">Collections2Test</span><span class=\"hljs-params\">(Integer nums)</span> &#123;<br>        <span class=\"hljs-built_in\">this</span>.nums = nums;<br>    &#125;<br>    <br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">transformLearn</span><span class=\"hljs-params\">()</span> &#123;<br>        <span class=\"hljs-type\">Collections2Test</span> <span class=\"hljs-variable\">c1</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Collections2Test</span>(<span class=\"hljs-number\">1</span>);<br>        <span class=\"hljs-type\">Collections2Test</span> <span class=\"hljs-variable\">c2</span> <span class=\"hljs-operator\">=</span> ne <span class=\"hljs-title function_\">Collections2Test</span><span class=\"hljs-params\">(<span class=\"hljs-number\">2</span>)</span>;<br>        <span class=\"hljs-type\">Collections2Test</span> <span class=\"hljs-variable\">c3</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Collections2Test</span>(<span class=\"hljs-number\">3</span>);<br>        List&lt;Collections2Test&gt; list = Arrays.asList(c1, c2, c3);<br>        Collection&lt;Integer&gt; transform = Collections2.transform(list,<br>                t -&gt; Optional.ofNullable(t)<br>                        .orElse(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Collections2Test</span>(<span class=\"hljs-number\">0</span>)).nums);<br>        System.out.println(transform);<br>        System.out.println(transform.getClass());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>\n<li>全排列<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String[] args)</span> &#123;<br>    ArrayList&lt;Integer&gt; list = Lists.newArrayList(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>);<br>    Collection&lt;List&lt;Integer&gt;&gt; lists = Collections2.orderedPermutations(list);<br>    lists.forEach(System.out::println);<br>    Collection&lt;List&lt;Integer&gt;&gt; permutations = Collections2.permutations(list);<br>    System.out.println(<span class=\"hljs-string\">&quot;====&quot;</span>);<br>    permutations.forEach(System.out::println);<br>&#125;<br></code></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"Lists\"><a href=\"#Lists\" class=\"headerlink\" title=\"Lists\"></a>Lists</h3><ul>\n<li>切割<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">//获取一个字符串中的全部字符，返回不可变集合</span><br>ImmutableList&lt;Character&gt; chars = Lists.charactersOf(<span class=\"hljs-string\">&quot;123&quot;</span>);<br>System.out.println(chars);<br><span class=\"hljs-comment\">//按照大小分割list</span><br>ArrayList&lt;Integer&gt; intList = Lists.newArrayList(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">5</span>, <span class=\"hljs-number\">6</span>, <span class=\"hljs-number\">7</span>);<br>List&lt;List&lt;Integer&gt;&gt; partitionList = Lists.partition(intList, <span class=\"hljs-number\">2</span>);<br>System.out.println(partitionList);<br></code></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"Sets\"><a href=\"#Sets\" class=\"headerlink\" title=\"Sets\"></a>Sets</h3><ul>\n<li>交集<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">HashSet&lt;Integer&gt; set1 = Sets.newHashSet(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>);<br>HashSet&lt;Integer&gt; set2 = Sets.newHashSet(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">5</span>);<br><span class=\"hljs-comment\">//返回交集</span><br>Sets.SetView&lt;Integer&gt; intersection = Sets.intersection(set1, set2);<br>System.out.println(intersection);<br></code></pre></td></tr></table></figure></li>\n<li>差集<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">//返回set1中存在 s2中不存在的元素</span><br>System.out.println(Sets.difference(set1, set2));<br>System.out.println(Sets.difference(set2, set1));<br></code></pre></td></tr></table></figure></li>\n<li>并集<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">//返回并集</span><br>Sets.SetView&lt;Integer&gt; union = Sets.union(set1, set2);<br>System.out.println(union);<br></code></pre></td></tr></table></figure></li>\n<li>过滤<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">System.out.println(Sets.filter(union, t -&gt; t % <span class=\"hljs-number\">2</span> == <span class=\"hljs-number\">0</span>));<br></code></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"Maps\"><a href=\"#Maps\" class=\"headerlink\" title=\"Maps\"></a>Maps</h3><ul>\n<li>uniqueIndex 根据传入的function生成map<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">ArrayList&lt;Integer&gt; list1 = Lists.newArrayList(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">6</span>);<br><span class=\"hljs-comment\">//传入function根据function生成map 要求 key 不可重复</span><br>ImmutableMap&lt;String, Integer&gt; integerImmutableMap = Maps.uniqueIndex(list1, String::valueOf);<br></code></pre></td></tr></table></figure></li>\n<li>获取两个map的不同<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">//如果你预计hashMap的大小请使用这个方法</span><br>HashMap&lt;String, Integer&gt; map1 = Maps.newHashMapWithExpectedSize(<span class=\"hljs-number\">3</span>);<br>map1.put(<span class=\"hljs-string\">&quot;1&quot;</span>, <span class=\"hljs-number\">1</span>);<br>map1.put(<span class=\"hljs-string\">&quot;2&quot;</span>, <span class=\"hljs-number\">2</span>);<br>map1.put(<span class=\"hljs-string\">&quot;3&quot;</span>, <span class=\"hljs-number\">3</span>);<br>map1.put(<span class=\"hljs-string\">&quot;4&quot;</span>, <span class=\"hljs-number\">3</span>);<br>map1.put(<span class=\"hljs-string\">&quot;5&quot;</span>, <span class=\"hljs-number\">5</span>);<br>ArrayList&lt;Integer&gt; list1 = Lists.newArrayList(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">6</span>);<br><span class=\"hljs-comment\">//传入function根据function生成map 要求 key 不可重复</span><br>ImmutableMap&lt;String, Integer&gt; integerImmutableMap = Maps.uniqueIndex(list1, String::valueOf);<br>MapDifference&lt;String, Integer&gt; difference = Maps.difference(map1, integerImmutableMap);<br><span class=\"hljs-comment\">//左边独有key</span><br>Map&lt;String, Integer&gt; mapLeft = difference.entriesOnlyOnLeft();<br><span class=\"hljs-comment\">//右边独有key</span><br>Map&lt;String, Integer&gt; mapRight = difference.entriesOnlyOnRight();<br><span class=\"hljs-comment\">//两个map相同key 但是不同value</span><br>Map&lt;String, MapDifference.ValueDifference&lt;Integer&gt;&gt; valueDifferenceMap = difference.entriesDiffering();<br><span class=\"hljs-comment\">//左边map的值 有边map的值</span><br>System.out.println(valueDifferenceMap.get(<span class=\"hljs-string\">&quot;4&quot;</span>).rightValue());<br>System.out.println(valueDifferenceMap.get(<span class=\"hljs-string\">&quot;4&quot;</span>).leftValue());<br></code></pre></td></tr></table></figure></li>\n<li>过滤<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">//过滤map 中的Entries</span><br>Map&lt;String, Integer&gt; filterEntriesMap = Maps.filterEntries(map1, e -&gt; &#123;<br>    <span class=\"hljs-keyword\">assert</span> e != <span class=\"hljs-literal\">null</span>;<br>    <span class=\"hljs-keyword\">return</span> StringUtils.equals(e.getKey(), String.valueOf(e.getValue()));<br>&#125;);<br><span class=\"hljs-comment\">//过滤key</span><br>Map&lt;String, Integer&gt; filterKeysMap = Maps.filterKeys(map1, StringUtils::isNotBlank);<br><span class=\"hljs-comment\">//过滤value</span><br>Map&lt;String, Integer&gt; filterValuesMap = Maps.filterValues(map1, v -&gt; &#123;<br>    <span class=\"hljs-keyword\">assert</span> v != <span class=\"hljs-literal\">null</span>;<br>    <span class=\"hljs-keyword\">return</span> v % <span class=\"hljs-number\">2</span> == <span class=\"hljs-number\">0</span>;<br>&#125;);<br></code></pre></td></tr></table></figure></li>\n<li>根据map构造转换器<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">HashBiMap&lt;String, Integer&gt; biMapForConverter = HashBiMap.create(integerImmutableMap);<br>Converter&lt;String, Integer&gt; converter = Maps.asConverter(biMapForConverter);<br>System.out.println(converter.convert(<span class=\"hljs-string\">&quot;1&quot;</span>));<br>Iterable&lt;Integer&gt; convertRes = converter.convertAll(Arrays.asList(<span class=\"hljs-string\">&quot;1&quot;</span>, <span class=\"hljs-string\">&quot;2&quot;</span>));<br></code></pre></td></tr></table></figure></li>\n<li>转换<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">Map&lt;String, String&gt; transformEntriesMap = Maps.transformEntries(map1, (key, value) -&gt; String.valueOf(map1.get(key)));<br><span class=\"hljs-comment\">//同样还存在</span><br><span class=\"hljs-comment\">//        Maps.transformValues()</span><br></code></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"字符串处理\"><a href=\"#字符串处理\" class=\"headerlink\" title=\"字符串处理\"></a>字符串处理</h2><h3 id=\"连接器-Joiner\"><a href=\"#连接器-Joiner\" class=\"headerlink\" title=\"连接器[Joiner]\"></a>连接器<code>[Joiner]</code></h3><p><strong>连接任何实现了Iterable结果的类型</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">List&lt;Integer&gt; list = Arrays.asList(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">4</span>, <span class=\"hljs-literal\">null</span>, <span class=\"hljs-number\">5</span>, <span class=\"hljs-literal\">null</span>);<br><span class=\"hljs-comment\">//跳过null</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">str1</span> <span class=\"hljs-operator\">=</span> Joiner.on(<span class=\"hljs-string\">&quot;-&quot;</span>).skipNulls().join(list);<br>System.out.println(str1);<br><span class=\"hljs-comment\">//用NNNN代替空</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">str2</span> <span class=\"hljs-operator\">=</span> Joiner.on(<span class=\"hljs-string\">&quot;-&quot;</span>).useForNull(<span class=\"hljs-string\">&quot;NNNN&quot;</span>).join(list);<br>System.out.println(str2);<br><span class=\"hljs-comment\">//空指针</span><br>String str3= Joiner.on(<span class=\"hljs-string\">&quot;-&quot;</span>).join(list);<br>System.out.println(str3);<br></code></pre></td></tr></table></figure>\n<ul>\n<li>连接map<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">HashMap&lt;String, String&gt; map = Maps.newHashMap();<br>map.put(<span class=\"hljs-string\">&quot;a&quot;</span>,<span class=\"hljs-string\">&quot;1&quot;</span>);<br>map.put(<span class=\"hljs-string\">&quot;b&quot;</span>,<span class=\"hljs-string\">&quot;2&quot;</span>);<br><span class=\"hljs-comment\">//每一个k-v连接方式为\\n  kv连接方式为-&gt;</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">str1</span> <span class=\"hljs-operator\">=</span> Joiner.on(<span class=\"hljs-string\">&quot;\\n&quot;</span>).withKeyValueSeparator(<span class=\"hljs-string\">&quot;-&gt;&quot;</span>).join(map);<br>System.out.println(str1);<br></code></pre></td></tr></table></figure></li>\n<li>连接实现了Appendable的任何类型<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-type\">StringBuilder</span> <span class=\"hljs-variable\">str3</span> <span class=\"hljs-operator\">=</span> Joiner.on(<span class=\"hljs-string\">&quot;-&quot;</span>).appendTo(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">StringBuilder</span>(), Arrays.asList(<span class=\"hljs-string\">&quot;1&quot;</span>, <span class=\"hljs-string\">&quot;a&quot;</span>,<span class=\"hljs-string\">&quot;2&quot;</span>));<br>System.out.println(str3);<br></code></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"分割器-Splitter\"><a href=\"#分割器-Splitter\" class=\"headerlink\" title=\"分割器[Splitter]\"></a>分割器<code>[Splitter]</code></h3><ul>\n<li>分隔成list<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">String str=<span class=\"hljs-string\">&quot;1-2  -3 - 4- - - &quot;</span>;<br>List&lt;String&gt; list1 = Splitter.fixedLength(<span class=\"hljs-number\">2</span>).splitToList(str);<br>System.out.println(list1);<br>List&lt;String&gt; list2 = Splitter.on(<span class=\"hljs-string\">&quot;-&quot;</span>).splitToList(str);<br>System.out.println(list2);<br>List&lt;String&gt; list3 = Splitter.on(<span class=\"hljs-string\">&quot;-&quot;</span>).trimResults().splitToList(str);<br>System.out.println(list3);<br></code></pre></td></tr></table></figure></li>\n<li>分割成map<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">String str2=<span class=\"hljs-string\">&quot;1#2-2#3-3#1&quot;</span>;<br><span class=\"hljs-comment\">//每一组entry使用的是-分割 k和v使用的#分割</span><br>Map&lt;String, String&gt; map = Splitter.on(<span class=\"hljs-string\">&quot;-&quot;</span>).withKeyValueSeparator(<span class=\"hljs-string\">&quot;#&quot;</span>).split(str2);<br>map.forEach((k,v)-&gt; System.out.println(k+<span class=\"hljs-string\">&quot;-&gt;&quot;</span>+v));<br></code></pre></td></tr></table></figure></li>\n<li>分割成Iterable<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">Iterable&lt;String&gt; stringIterable = Splitter.on(<span class=\"hljs-string\">&quot;-&quot;</span>).split(str);<br>stringIterable.iterator().forEachRemaining(System.out::println);<br></code></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"字符匹配器\"><a href=\"#字符匹配器\" class=\"headerlink\" title=\"字符匹配器\"></a>字符匹配器</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">//删除字符</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">str</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;/1/2/3/4&quot;</span>;<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">str1</span> <span class=\"hljs-operator\">=</span> CharMatcher.is(<span class=\"hljs-string\">&#x27;/&#x27;</span>).removeFrom(str);<br>System.out.println(str1);<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">str2</span> <span class=\"hljs-operator\">=</span> CharMatcher.anyOf(<span class=\"hljs-string\">&quot;/1&quot;</span>).removeFrom(str);<br>System.out.println(str2);<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">str3</span> <span class=\"hljs-operator\">=</span> CharMatcher.noneOf(<span class=\"hljs-string\">&quot;12/&quot;</span>).removeFrom(str);<br>System.out.println(str3);<br><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">str4</span> <span class=\"hljs-operator\">=</span> CharMatcher.inRange(<span class=\"hljs-string\">&#x27;1&#x27;</span>, <span class=\"hljs-string\">&#x27;9&#x27;</span>).removeFrom(str);<br>System.out.println(str4);<br><span class=\"hljs-comment\">//替换</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">str5</span> <span class=\"hljs-operator\">=</span> CharMatcher.inRange(<span class=\"hljs-string\">&#x27;1&#x27;</span>, <span class=\"hljs-string\">&#x27;9&#x27;</span>).replaceFrom(<span class=\"hljs-string\">&quot;a1b2c3&quot;</span>, <span class=\"hljs-string\">&quot;.&quot;</span>);<br>System.out.println(str5);<br><span class=\"hljs-comment\">//裁剪</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">str6</span> <span class=\"hljs-operator\">=</span> CharMatcher.inRange(<span class=\"hljs-string\">&#x27;1&#x27;</span>, <span class=\"hljs-string\">&#x27;9&#x27;</span>).trimTrailingFrom(<span class=\"hljs-string\">&quot;a1b2c3&quot;</span>);<br>System.out.println(str6);<br><span class=\"hljs-comment\">//比对</span><br>System.out.println(CharMatcher.inRange(<span class=\"hljs-string\">&#x27;1&#x27;</span>, <span class=\"hljs-string\">&#x27;9&#x27;</span>).matchesAllOf(<span class=\"hljs-string\">&quot;1b2&quot;</span>));<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"字符集和大小写格式\"><a href=\"#字符集和大小写格式\" class=\"headerlink\" title=\"字符集和大小写格式\"></a>字符集和大小写格式</h3><ul>\n<li>Charsets针对所有Java平台都要保证支持的六种字符集提供了常量引用。尝试使用这些常量，而不是通过名称获取字符集实例。</li>\n<li>CaseFormat</li>\n</ul>\n<h2 id=\"缓存-Caches\"><a href=\"#缓存-Caches\" class=\"headerlink\" title=\"缓存[Caches]\"></a>缓存<code>[Caches]</code></h2><p>Guava Cache：本地缓存实现，支持多种缓存过期策略</p>\n<h2 id=\"函数式风格-Functional-idioms\"><a href=\"#函数式风格-Functional-idioms\" class=\"headerlink\" title=\"函数式风格[Functional idioms]\"></a>函数式风格<code>[Functional idioms]</code></h2><p>Guava的函数式支持可以显著简化代码，但请谨慎使用它</p>\n<h2 id=\"并发-Concurrency\"><a href=\"#并发-Concurrency\" class=\"headerlink\" title=\"并发[Concurrency]\"></a>并发<code>[Concurrency]</code></h2><p>强大而简单的抽象，让编写正确的并发代码更简单</p>\n<ul>\n<li>ListenableFuture：完成后触发回调的Future</li>\n<li>Service框架：抽象可开启和关闭的服务，帮助你维护服务的状态逻辑</li>\n</ul>\n<h2 id=\"字符串处理-Strings\"><a href=\"#字符串处理-Strings\" class=\"headerlink\" title=\"字符串处理[Strings]\"></a>字符串处理<code>[Strings]</code></h2><p>非常有用的字符串工具，包括分割、连接、填充等操作</p>\n<h2 id=\"原生类型-Primitives\"><a href=\"#原生类型-Primitives\" class=\"headerlink\" title=\"原生类型[Primitives]\"></a>原生类型<code>[Primitives]</code></h2><p>扩展 JDK 未提供的原生类型（如int、char）操作， 包括某些类型的无符号形式</p>\n<h2 id=\"区间-Ranges\"><a href=\"#区间-Ranges\" class=\"headerlink\" title=\"区间[Ranges]\"></a>区间<code>[Ranges]</code></h2><p>可比较类型的区间API，包括连续和离散类型</p>\n<h2 id=\"I-x2F-O\"><a href=\"#I-x2F-O\" class=\"headerlink\" title=\"I&#x2F;O\"></a>I&#x2F;O</h2><p>简化I&#x2F;O尤其是I&#x2F;O流和文件的操作，针对Java5和6版本</p>\n<h2 id=\"散列-Hash\"><a href=\"#散列-Hash\" class=\"headerlink\" title=\"散列[Hash]\"></a>散列<code>[Hash]</code></h2><p>提供比Object.hashCode()更复杂的散列实现，并提供布鲁姆过滤器的实现</p>\n<h2 id=\"事件总线-EventBus\"><a href=\"#事件总线-EventBus\" class=\"headerlink\" title=\"事件总线[EventBus]\"></a>事件总线<code>[EventBus]</code></h2><p>发布-订阅模式的组件通信，但组件不需要显式地注册到其他组件中</p>\n<h2 id=\"数学运算-Math\"><a href=\"#数学运算-Math\" class=\"headerlink\" title=\"数学运算[Math]\"></a>数学运算<code>[Math]</code></h2><p>优化的、充分测试的数学工具类</p>\n<h2 id=\"反射-Reflection\"><a href=\"#反射-Reflection\" class=\"headerlink\" title=\"反射[Reflection]\"></a>反射<code>[Reflection]</code></h2><p>Guava 的 Java 反射机制工具类</p>\n",
            "tags": [
                "工具类",
                "常用开发库",
                "Google Guava"
            ]
        },
        {
            "id": "https://github.com/yangxiangnanwill/yangxiangnanwill.github.io/2023/06/26/%E5%A5%BD%E5%A5%BD%E7%A0%81%E4%BB%A3%E7%A0%81%E5%90%96/JAVA/%E5%B8%B8%E7%94%A8%E7%B1%BB%E5%BA%93%E8%AF%A6%E8%A7%A3/Apache%20Common/",
            "url": "https://github.com/yangxiangnanwill/yangxiangnanwill.github.io/2023/06/26/%E5%A5%BD%E5%A5%BD%E7%A0%81%E4%BB%A3%E7%A0%81%E5%90%96/JAVA/%E5%B8%B8%E7%94%A8%E7%B1%BB%E5%BA%93%E8%AF%A6%E8%A7%A3/Apache%20Common/",
            "title": "Apache Common",
            "date_published": "2023-06-26T12:40:00.893Z",
            "content_html": "<h1 id=\"Apache-Common包简介\"><a href=\"#Apache-Common包简介\" class=\"headerlink\" title=\"Apache Common包简介\"></a>Apache Common包简介</h1><p>Apache Commons是对JDK的拓展，包含了很多开源的工具，用于解决平时编程经常会遇到的问题，减少重复劳动。官网网址:<a href=\"http://commons.apache.org/\">http://commons.apache.org</a></p>\n<h1 id=\"Common包包含哪些类？\"><a href=\"#Common包包含哪些类？\" class=\"headerlink\" title=\"Common包包含哪些类？\"></a>Common包包含哪些类？</h1><blockquote>\n<p>请参考：<a href=\"http://commons.apache.org/\">Apache Common官方网站</a></p>\n</blockquote>\n<h2 id=\"常用包梳理\"><a href=\"#常用包梳理\" class=\"headerlink\" title=\"常用包梳理\"></a>常用包梳理</h2><p>| 包名         | 介绍     |<br>| ————- |:————-:| <br>| commons-lang      | 提供字符串处理、数值处理、对象等工具方法 |<br>| commons-collections | 集合工具类,用来操作各种集合     |<br>| commons-io         | IO流操作的工具类     |<br>| commons-beanutils  | Java Bean 操作和封装工具     |  <br>| commons-dbcp2     | 数据库连接池实现  |<br>| commons-pool2      | 对象池实现,用于数据库连接池等 |<br>| commons-fileupload | HTML文件上传工具     | <br>| commons-codec      | 编码&#x2F;解码算法,如Base64、Hex、MD5等 |  <br>| commons-net        | 网络工具,如FTP、Telnet、DNS等 |<br>| commons-configuration | 配置文件解析器   |<br>| commons-vfs        | 虚拟文件系统,对各种文件系统的包装| <br>| commons-digester   | XML解析器    | <br>| commons-logging    | 日志记录器抽象层|<br>| commons-validator  | 数据校验器|</p>\n<h3 id=\"Commons-BeanUtils\"><a href=\"#Commons-BeanUtils\" class=\"headerlink\" title=\"Commons BeanUtils\"></a>Commons BeanUtils</h3><p>针对Bean的一个工具集。由于Bean往往是有一堆get和set组成，所以BeanUtils也是在此基础上进行一些包装。它利用Java的反射机制，从动态的生成对bean的getter和setter的调用代码，到模拟创建一个动态的bean，等等。<br>这个包看似简单，却是很多开源项目的基石：如在著名的Struts和Spring Framework中，我们都能找到BeanUtils的影子。大家猜猜看，有哪位名人是BeanUtils的作者之一？没错，就是Struts的创始人Craig McClanahan。<br>一个比较常用的功能是Bean Copy，也就是copy bean的属性。如果做分层架构开发的话就会用到，比如从PO（Persistent Object）拷贝数据到VO（Value Object）。</p>\n<h4 id=\"模块介绍\"><a href=\"#模块介绍\" class=\"headerlink\" title=\"模块介绍\"></a>模块介绍</h4><table>\n<thead>\n<tr>\n<th>包名</th>\n<th>介绍</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>beanutils</td>\n<td>核心包，主要是一些常用的工具类及接口定义</td>\n</tr>\n<tr>\n<td>converters</td>\n<td>转换String到需要类型的类，实现Converter接口</td>\n</tr>\n<tr>\n<td></td>\n<td>这些转换器实现了 LocaleConverter 接口,并提供了根据本地语言环境格式化对象到字符串以及解析字符串到对象的功能。<br/>主要用途是:<br/>国际化:    根据不同语言环境解析和格式化数值<br/>本地化的 Bean 操作:    解析不同本地语言环境的请求参数到 Bean</td>\n</tr>\n<tr>\n<td>expression</td>\n<td>统一的表达式语言接口,定义表达式解析、求值和设置属性值等方法。</td>\n</tr>\n</tbody></table>\n<h4 id=\"代码案例\"><a href=\"#代码案例\" class=\"headerlink\" title=\"代码案例\"></a>代码案例</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">import</span> lombok.Data;  <br><span class=\"hljs-keyword\">import</span> org.apache.commons.beanutils.BeanUtils;  <br><span class=\"hljs-keyword\">import</span> org.apache.commons.beanutils.ConvertUtils;  <br><span class=\"hljs-keyword\">import</span> org.apache.commons.beanutils.converters.DateConverter;  <br><span class=\"hljs-keyword\">import</span> org.junit.Test;  <br>  <br><span class=\"hljs-keyword\">import</span> java.lang.reflect.InvocationTargetException;  <br><span class=\"hljs-keyword\">import</span> java.util.Arrays;  <br><span class=\"hljs-keyword\">import</span> java.util.Date;  <br><span class=\"hljs-keyword\">import</span> java.util.HashMap;  <br><span class=\"hljs-keyword\">import</span> java.util.Map;  <br>  <br><span class=\"hljs-comment\">/**  </span><br><span class=\"hljs-comment\"> * CovertTest * <span class=\"hljs-doctag\">@author</span> will */</span><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">BeanUtilTest</span> &#123;  <br>  <br>    <span class=\"hljs-comment\">//将字符串转换为指定类型  </span><br>    <span class=\"hljs-meta\">@Test</span>  <br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testCovertToInteger</span><span class=\"hljs-params\">()</span> &#123;  <br>        <span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">i</span> <span class=\"hljs-operator\">=</span> ConvertUtils.convert(<span class=\"hljs-string\">&quot;123&quot;</span>, Integer.class);  <br>        <span class=\"hljs-keyword\">if</span> (i <span class=\"hljs-keyword\">instanceof</span> Integer) &#123;  <br>            System.out.println(<span class=\"hljs-string\">&quot;it can cast to integer&quot;</span>);  <br>            System.out.println(<span class=\"hljs-string\">&quot;the number result is &quot;</span> + (Integer) i);  <br>        &#125; <span class=\"hljs-keyword\">else</span> &#123;  <br>            System.err.print(<span class=\"hljs-string\">&quot;it can not cast to target Instance!&quot;</span>);  <br>        &#125;  <br>    &#125;  <br>    <span class=\"hljs-comment\">//将字符串数组转换为指定类型数组  </span><br>    <span class=\"hljs-meta\">@Test</span>  <br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testConvertArrToIntegerArr</span><span class=\"hljs-params\">()</span> &#123;  <br>        <span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">convert</span> <span class=\"hljs-operator\">=</span> ConvertUtils.convert(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">String</span>[]&#123;<span class=\"hljs-string\">&quot;1&quot;</span>, <span class=\"hljs-string\">&quot;2&quot;</span>, <span class=\"hljs-string\">&quot;3&quot;</span>&#125;, Integer.class);  <br>        <span class=\"hljs-keyword\">if</span> (convert <span class=\"hljs-keyword\">instanceof</span> Integer[]) &#123;  <br>            System.out.println(<span class=\"hljs-string\">&quot;it can cast to Integer Array&quot;</span>);  <br>            Integer[] integers = (Integer[]) convert;  <br>            Arrays.stream(integers).forEach(System.out::println);  <br>        &#125; <span class=\"hljs-keyword\">else</span> &#123;  <br>            System.err.print(<span class=\"hljs-string\">&quot;it can not cast to target Instance!&quot;</span>);  <br>        &#125;  <br>    &#125;  <br>    <span class=\"hljs-comment\">//将字符串转换为日期类型  </span><br>    <span class=\"hljs-meta\">@Test</span>  <br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testCovertToDate</span> <span class=\"hljs-params\">()</span> &#123;  <br>        <span class=\"hljs-comment\">// 日期格式转换  </span><br>        <span class=\"hljs-type\">DateConverter</span> <span class=\"hljs-variable\">dateConverter</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">DateConverter</span>();  <br>        dateConverter.setPatterns(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">String</span>[]&#123;<span class=\"hljs-string\">&quot;yyyy-MM-dd&quot;</span>,<span class=\"hljs-string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>&#125;);  <br>        ConvertUtils.register(dateConverter, Date.class);  <br>        <span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">convert</span> <span class=\"hljs-operator\">=</span> ConvertUtils.convert(<span class=\"hljs-string\">&quot;2023-12-01&quot;</span>, Date.class);  <br>        System.out.println(convert);  <br>        <span class=\"hljs-comment\">// 常规时间类型转换  </span><br>        System.out.println(ConvertUtils.convert(<span class=\"hljs-string\">&quot;2023-06-30 09:53:55&quot;</span>, Date.class));  <br>    &#125;  <br>  <br>    <span class=\"hljs-meta\">@Test</span>  <br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testBeanUtil</span><span class=\"hljs-params\">()</span> <span class=\"hljs-keyword\">throws</span> InvocationTargetException, IllegalAccessException, InstantiationException, NoSuchMethodException &#123;  <br>        Map&lt;String, Object&gt; map = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">HashMap</span>&lt;String, Object&gt;();  <br>        map.put(<span class=\"hljs-string\">&quot;name&quot;</span>, <span class=\"hljs-string\">&quot;will&quot;</span>);  <br>        map.put(<span class=\"hljs-string\">&quot;age&quot;</span>, <span class=\"hljs-string\">&quot;18&quot;</span>);  <br>  <br>        <span class=\"hljs-comment\">// 将map数据拷贝到Java Bean中  </span><br>        <span class=\"hljs-type\">Person</span> <span class=\"hljs-variable\">p</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Person</span>();  <br>        BeanUtils.populate(p, map);  <br>        System.out.println(<span class=\"hljs-string\">&quot;p is &quot;</span> + p);  <br>        <span class=\"hljs-comment\">// 对象拷贝  </span><br>        <span class=\"hljs-type\">Person</span> <span class=\"hljs-variable\">p1</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Person</span>();  <br>        BeanUtils.copyProperties(p1, p);  <br>        System.out.println(<span class=\"hljs-string\">&quot;p1 is &quot;</span> + p1);  <br>        <span class=\"hljs-comment\">// 拷贝指定的属性  </span><br>        <span class=\"hljs-type\">Person</span> <span class=\"hljs-variable\">p2</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Person</span>();  <br>        BeanUtils.copyProperty(p2,<span class=\"hljs-string\">&quot;name&quot;</span>,<span class=\"hljs-string\">&quot;will_yang&quot;</span>);  <br>        System.out.println(<span class=\"hljs-string\">&quot;p2 is &quot;</span> + p2);  <br>        <span class=\"hljs-comment\">// 设置指定的属性  </span><br>        BeanUtils.setProperty(p2, <span class=\"hljs-string\">&quot;age&quot;</span>, <span class=\"hljs-number\">20</span>);  <br>        System.out.println(<span class=\"hljs-string\">&quot;p2 is &quot;</span> + p2);  <br>        <span class=\"hljs-comment\">//对象克隆  </span><br>        <span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">bean</span> <span class=\"hljs-operator\">=</span> BeanUtils.cloneBean(p2);  <br>        System.out.println(<span class=\"hljs-string\">&quot;bean = &quot;</span> + bean);  <br>    &#125;  <br>  <br>    <span class=\"hljs-meta\">@Data</span>  <br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Person</span>&#123;  <br>        <span class=\"hljs-keyword\">private</span> String name;  <br>        <span class=\"hljs-keyword\">private</span> String age;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure>\n\n<h2 id=\"Commons-Codec\"><a href=\"#Commons-Codec\" class=\"headerlink\" title=\"Commons Codec\"></a>Commons Codec</h2><p>是编码和解码组件，提供常用的编码和解码方法，如DES、SHA1、MD5、Base64、URL和Soundx等。</p>\n<h3 id=\"二进制相关\"><a href=\"#二进制相关\" class=\"headerlink\" title=\"二进制相关\"></a>二进制相关</h3><p>二进制包主要提供16进制、Base64、Base32等的编解码工具类。</p>\n<h4 id=\"16进制（Hex类）\"><a href=\"#16进制（Hex类）\" class=\"headerlink\" title=\"16进制（Hex类）\"></a>16进制（Hex类）</h4><p>十六进制常用于将二进制以更简短的方式展示，比如MD5是128位，展现起来太长，而转换为16进制后只需要32个字符即可表示出来。<br>示例代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// byte数组转为16进制字符串</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">hex</span> <span class=\"hljs-operator\">=</span> Hex.encodeHexString(<span class=\"hljs-string\">&quot;123&quot;</span>.getBytes());<br>System.out.println(hex);<br><span class=\"hljs-comment\">// 16进制字符串解码</span><br><span class=\"hljs-type\">byte</span>[] src = Hex.decodeHex(hex);<br>System.out.println(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">String</span>(src));<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"2-Base64，Base32，Base16\"><a href=\"#2-Base64，Base32，Base16\" class=\"headerlink\" title=\"2. Base64，Base32，Base16\"></a>2. Base64，Base32，Base16</h4><p>Base64是网络上最常见的用于传输二进制数据的编码方式之一，Base64就是一种基于64个可打印字符来表示二进制数据的方法。Base32就是使用32个可打印字符，Base16就是使用16个（实际上相当于16进制）。</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>名称</td>\n<td>编码表字符串</td>\n<td>位数不足是否会补全 &#x3D;</td>\n</tr>\n<tr>\n<td>base16</td>\n<td>数字0<del>9 和 字母 A</del>F</td>\n<td>不会，位数刚好是 4 的倍数</td>\n</tr>\n<tr>\n<td>base32</td>\n<td>大写字母A<del>Z 和 数字2</del>7</td>\n<td>会</td>\n</tr>\n<tr>\n<td>base64</td>\n<td>Base大写字母A-Z，小写字母a-z，数字0~9以及”+”，”&#x2F;“</td>\n<td>会</td>\n</tr>\n</tbody></table>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// base64编码</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">base64</span> <span class=\"hljs-operator\">=</span> Base64.encodeBase64String(<span class=\"hljs-string\">&quot;测试&quot;</span>.getBytes());<br>System.out.println(base64);<br><span class=\"hljs-comment\">// base64解码</span><br><span class=\"hljs-type\">byte</span>[] src = Base64.decodeBase64(base64);<br>System.out.println(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">String</span>(src));<br><span class=\"hljs-comment\">// 字符串是否是base64</span><br>Base64.isBase64(base64);<br><br><span class=\"hljs-comment\">// Base32 Base16 同理</span><br></code></pre></td></tr></table></figure>\n\n<p>Codec还提供了Base系列的流处理，以流的方式去处理Base编解码，示例如下</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// 以流方式提供Base64编码和解码</span><br><span class=\"hljs-comment\">// 附：&quot;123&quot;的base64编码为&quot;MTIz&quot;</span><br><br><span class=\"hljs-comment\">// 对输入流做base64编码</span><br><span class=\"hljs-type\">InputStream</span> <span class=\"hljs-variable\">is</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ByteArrayInputStream</span>(<span class=\"hljs-string\">&quot;123&quot;</span>.getBytes());<br><span class=\"hljs-type\">Base64InputStream</span> <span class=\"hljs-variable\">ebis</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Base64InputStream</span>(is, <span class=\"hljs-literal\">true</span>);<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">enc</span> <span class=\"hljs-operator\">=</span> IOUtils.toString(ebis, <span class=\"hljs-string\">&quot;UTF-8&quot;</span>); <span class=\"hljs-comment\">// MTIz</span><br><br><span class=\"hljs-comment\">// 对base64数据流做解码</span><br>is = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ByteArrayInputStream</span>(enc.getBytes());<br><span class=\"hljs-type\">Base64InputStream</span> <span class=\"hljs-variable\">dbis</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Base64InputStream</span>(is, <span class=\"hljs-literal\">false</span>);<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">dec</span> <span class=\"hljs-operator\">=</span> IOUtils.toString(dbis, <span class=\"hljs-string\">&quot;UTF-8&quot;</span>); <span class=\"hljs-comment\">// 123</span><br><br><span class=\"hljs-comment\">// -----------------------</span><br><br><span class=\"hljs-comment\">// 将数据做base64编码写入输出流</span><br><span class=\"hljs-keyword\">final</span> <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">data</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;123&quot;</span>;<br><span class=\"hljs-type\">ByteArrayOutputStream</span> <span class=\"hljs-variable\">baos</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ByteArrayOutputStream</span>();<br><span class=\"hljs-type\">Base64OutputStream</span> <span class=\"hljs-variable\">ebos</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Base64OutputStream</span>(baos, <span class=\"hljs-literal\">true</span>);<br>IOUtils.write(data, ebos, <span class=\"hljs-string\">&quot;UTF-8&quot;</span>);<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">enc2</span> <span class=\"hljs-operator\">=</span> baos.toString(); <span class=\"hljs-comment\">// MTIz</span><br><br><span class=\"hljs-comment\">// 将base64数据做解码写入输出流</span><br>baos = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ByteArrayOutputStream</span>();<br><span class=\"hljs-type\">Base64OutputStream</span> <span class=\"hljs-variable\">dbos</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Base64OutputStream</span>(baos, <span class=\"hljs-literal\">false</span>);<br>IOUtils.write(data, dbos, <span class=\"hljs-string\">&quot;UTF-8&quot;</span>);<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">dec2</span> <span class=\"hljs-operator\">=</span> dbos.toString(); <span class=\"hljs-comment\">// 123</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"URL相关\"><a href=\"#URL相关\" class=\"headerlink\" title=\"URL相关\"></a>URL相关</h3><p>URL之所以要进行编码，是因为URL中有些字符会引起歧义。</p>\n<p>例如URL参数字符串中使用key&#x3D;value键值对这样的形式来传参，键值对之间以&amp;符号分隔，如&#x2F;s?q&#x3D;abc&amp;ie&#x3D;utf-8。如果你的value字符串中包含了&#x3D;或者&amp;，那么势必会造成接收URL的服务器解析错误，因此必须将引起歧义的&amp;和&#x3D;符号进行转义，也就是对其进行编码。</p>\n<p>又如URL的编码格式采用的是ASCII码，而不是Unicode，这也就是说你不能在URL中包含任何非ASCII字符，例如中文。否则如果客户端浏览器和服务端浏览器支持的字符集不同的情况下，中文可能会造成问题。</p>\n<p>URL编码的原则就是使用安全的字符（没有特殊用途或者特殊意义的可打印字符）去表示那些不安全的字符。</p>\n<p>编解码示例代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-type\">URLCodec</span> <span class=\"hljs-variable\">urlCodec</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">URLCodec</span>();<br><span class=\"hljs-comment\">// url编码</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">encUrl</span> <span class=\"hljs-operator\">=</span> urlCodec.encode(<span class=\"hljs-string\">&quot;http://x.com?f=哈&quot;</span>);<br>System.out.println(encUrl);<br><span class=\"hljs-comment\">// url解码</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">decUrl</span> <span class=\"hljs-operator\">=</span> urlCodec.decode(encUrl);<br>System.out.println(decUrl);<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"摘要算法\"><a href=\"#摘要算法\" class=\"headerlink\" title=\"摘要算法\"></a>摘要算法</h3><p>摘要算法是一种单向的散列算法，它满足以下几个特点。</p>\n<ul>\n<li>输入长度是任意的</li>\n<li>输出长度是固定的</li>\n<li>对每一个给定的输入，计算输出是很容易的</li>\n<li>不可逆，无法通过输出推算出原数据</li>\n<li>输出不依赖于输入。就是输入数据变动一个字节结果会相差很多</li>\n</ul>\n<p>由于摘要算法以上特点，主要用于数据完整性校验。例如网上的资源一般会提供一个摘要值（一般用MD5算法），用户下载后可以通过工具对资源做MD5后和网上给定的值比较，如果不一致说明文件不完整了，可能是下载过程网络波动内容有丢失，也可能被人篡改过。</p>\n<p>也可以做数据的指纹，比如网盘秒传，就是利用摘要值做判断。客户端上传前先对文件做摘要值，传给服务端，服务端发现有相同摘要的文件说明两个文件内容是一致的，这样就无需上传直接将文件存储路径指向这个文件就可以了，既实现了秒传，还节约了服务器磁盘空间（不同用户相同内容的文件实际上指向的是同一份文件）。</p>\n<p>很多系统也将密码做md5后存储，其中这种方式并不安全。md5已经很很多公开结果了，并且使用彩虹表碰撞也很容易破解了。所以并不建议使用md5存储密码。密码推荐使用BCrypt算法。</p>\n<p>摘要算法主要有以下几个</p>\n<ul>\n<li>MD(Message Digest)：消息摘要</li>\n<li>SHA(Secure Hash Algorithm)：安全散列</li>\n<li>MAC(Message Authentication Code)：消息认证码</li>\n</ul>\n<p><strong>1. MD系列</strong></p>\n<p>主要有MD2、MD4、MD5，目前一般常用MD5</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// 如果使用Java自带的api需要十多行才能实现md5算法</span><br><br><span class=\"hljs-comment\">// 对数据做md5，参数支持字符串，字节数据，输入流</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">md5</span> <span class=\"hljs-operator\">=</span> DigestUtils.md5Hex(<span class=\"hljs-string\">&quot;测试&quot;</span>);<br></code></pre></td></tr></table></figure>\n\n<p><strong>2. SHA系列</strong></p>\n<p>SHA系列有SHA-1、SHA-224、SHA-256、SHA-384、SHA-512，SHA3-224、SHA3-256、SHA3-384、SHA3-512等。目前安全起见一般选择256以上，推荐384以上。当然摘要越长则计算耗时也越长，需要根据需求权衡。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// 参数支持字符串，字节数据，输入流</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sha1</span> <span class=\"hljs-operator\">=</span> DigestUtils.sha1Hex(<span class=\"hljs-string\">&quot;测试&quot;</span>);<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sha256</span> <span class=\"hljs-operator\">=</span> DigestUtils.sha256Hex(<span class=\"hljs-string\">&quot;测试&quot;</span>);<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sha384</span> <span class=\"hljs-operator\">=</span> DigestUtils.sha384Hex(<span class=\"hljs-string\">&quot;测试&quot;</span>);<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sha512</span> <span class=\"hljs-operator\">=</span> DigestUtils.sha512Hex(<span class=\"hljs-string\">&quot;测试&quot;</span>);<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sha3_256</span> <span class=\"hljs-operator\">=</span> DigestUtils.sha3_256Hex(<span class=\"hljs-string\">&quot;测试&quot;</span>);<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sha3_384</span> <span class=\"hljs-operator\">=</span> DigestUtils.sha3_384Hex(<span class=\"hljs-string\">&quot;测试&quot;</span>);<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sha3_512</span> <span class=\"hljs-operator\">=</span> DigestUtils.sha3_512Hex(<span class=\"hljs-string\">&quot;测试&quot;</span>);<br></code></pre></td></tr></table></figure>\n\n<p><strong>3. HMAC系列</strong></p>\n<p>HMAC(keyed-Hash Message Authentication Code)系列是包含密钥的散列算法，包含了MD和SHA两个系列的消息摘要算法。融合了MD，SHA：</p>\n<p>MD系列：HMacMD2，HMacMD4，HMacMD5</p>\n<p>SHA系列：HMacSHA1，HMacSHA224，HMacSHA256，HMacSHA38</p>\n<p>，HMacSHA512</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">key</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;asdf3234asdf3234asdf3234asdf3234&quot;</span>;<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">valueToDigest</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;测试数据&quot;</span>; <span class=\"hljs-comment\">// valueToDigest参数支持字节数据，流，文件等</span><br><span class=\"hljs-comment\">// 做HMAC-MD5摘要</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">hmacMd5</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">HmacUtils</span>(HmacAlgorithms.HMAC_MD5, key).hmacHex(valueToDigest);<br><span class=\"hljs-comment\">// 做HMAC-sha摘要</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">hmacSha256</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">HmacUtils</span>(HmacAlgorithms.HMAC_SHA_256, key).hmacHex(valueToDigest);<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">hmacSha384</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">HmacUtils</span>(HmacAlgorithms.HMAC_SHA_384, key).hmacHex(valueToDigest);<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">hmacSha512</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">HmacUtils</span>(HmacAlgorithms.HMAC_SHA_512, key).hmacHex(valueToDigest);<br></code></pre></td></tr></table></figure>\n\n<h2 id=\"Commons-Collections\"><a href=\"#Commons-Collections\" class=\"headerlink\" title=\"Commons Collections\"></a>Commons Collections</h2><p>Apache Commons Collections 是对 java.util.Collection 的扩展。</p>\n<p>目前 <strong>Collections</strong> 包有两个：</p>\n<ul>\n<li>commons-collections</li>\n<li>commons-collections4<br>commons-collections 最新版本是3.2.2，不支持泛型，目前官方已不在维护。<br>collections4 目前最新版本是4.4，最低要求 Java8 以上。<br>相对于 collections 来说完全支持 Java8 的特性并且支持泛型，该版本无法兼容旧有版本，于是为了避免冲突改名为 collections4。推荐直接使用该版本。（注：两个版本可以共存，使用时需要注意）。<br>这里使用3.2.2版本的中包名做下介绍：</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>包名</th>\n<th>介绍</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>collections</td>\n<td>CommonsCollections自定义的一组公用的接口和工具类</td>\n</tr>\n<tr>\n<td>bag</td>\n<td>实现Bag接口的一组类</td>\n</tr>\n<tr>\n<td>bidimap</td>\n<td>实现BidiMap系列接口的一组类</td>\n</tr>\n<tr>\n<td>buffer</td>\n<td>实现Buffer接口的一组类</td>\n</tr>\n<tr>\n<td>collection</td>\n<td>实现java.util.Collection接口的一组类</td>\n</tr>\n<tr>\n<td>comparators</td>\n<td>实现java.util.Comparator接口的一组类</td>\n</tr>\n<tr>\n<td>functors</td>\n<td>Commons Collections自定义的一组功能类</td>\n</tr>\n<tr>\n<td>iterators</td>\n<td>实现java.util.Iterator接口的一组类</td>\n</tr>\n<tr>\n<td>keyvalue</td>\n<td>实现集合和键&#x2F;值映射相关的一组类</td>\n</tr>\n<tr>\n<td>list</td>\n<td>实现java.util.List接口的一组类</td>\n</tr>\n<tr>\n<td>map</td>\n<td>实现Map系列接口的一组类</td>\n</tr>\n<tr>\n<td>set</td>\n<td>实现Set系列接口的一组类</td>\n</tr>\n</tbody></table>\n<h3 id=\"工具类\"><a href=\"#工具类\" class=\"headerlink\" title=\"工具类\"></a>工具类</h3><h4 id=\"CollectionUtils\"><a href=\"#CollectionUtils\" class=\"headerlink\" title=\"CollectionUtils\"></a>CollectionUtils</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">str</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;<br><span class=\"hljs-type\">List</span> <span class=\"hljs-variable\">list1</span> <span class=\"hljs-operator\">=</span> Arrays.asList(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">String</span>[]&#123;<span class=\"hljs-string\">&quot;1&quot;</span>, <span class=\"hljs-string\">&quot;2&quot;</span>, <span class=\"hljs-string\">&quot;3&quot;</span>&#125;);<br><span class=\"hljs-type\">List</span> <span class=\"hljs-variable\">list2</span> <span class=\"hljs-operator\">=</span> Arrays.asList(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">String</span>[]&#123;<span class=\"hljs-string\">&quot;1&quot;</span>, <span class=\"hljs-string\">&quot;2&quot;</span>, <span class=\"hljs-string\">&quot;4&quot;</span>&#125;);<br><span class=\"hljs-comment\">// 判断是否为空（null或空list都为true）</span><br>CollectionUtils.isEmpty(list1);<br><span class=\"hljs-comment\">// 添加元素（忽略null元素）</span><br>CollectionUtils.addIgnoreNull(list1, str);<br><span class=\"hljs-comment\">// list是否包含subList中的所有元素</span><br>CollectionUtils.containsAll(list1, list2); <span class=\"hljs-comment\">// false</span><br><span class=\"hljs-comment\">// list是否包含subList中的任意一个元素</span><br>CollectionUtils.containsAny(list1, list2); <span class=\"hljs-comment\">// true</span><br><span class=\"hljs-comment\">// list1 减去 list2</span><br>CollectionUtils.subtract(list1, list2); <span class=\"hljs-comment\">// [&quot;3&quot;]</span><br><span class=\"hljs-comment\">// 合并两个list并去重</span><br>CollectionUtils.union(list1, list2); <span class=\"hljs-comment\">//[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;]</span><br><span class=\"hljs-comment\">// 取两个list同时存在的元素</span><br>CollectionUtils.intersection(list1, list2); <span class=\"hljs-comment\">// [1&quot;, &quot;2&quot;]</span><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"ListUtils\"><a href=\"#ListUtils\" class=\"headerlink\" title=\"ListUtils\"></a>ListUtils</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-type\">List</span> <span class=\"hljs-variable\">list1</span> <span class=\"hljs-operator\">=</span> Arrays.asList(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">String</span>[]&#123;<span class=\"hljs-string\">&quot;1&quot;</span>, <span class=\"hljs-string\">&quot;2&quot;</span>, <span class=\"hljs-string\">&quot;3&quot;</span>&#125;);<br><span class=\"hljs-type\">List</span> <span class=\"hljs-variable\">list2</span> <span class=\"hljs-operator\">=</span> Arrays.asList(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">String</span>[]&#123;<span class=\"hljs-string\">&quot;1&quot;</span>, <span class=\"hljs-string\">&quot;2&quot;</span>, <span class=\"hljs-string\">&quot;4&quot;</span>&#125;);<br><span class=\"hljs-comment\">// 同CollectionUtils, 返回结果为List</span><br>ListUtils.subtract(list1, list2); <span class=\"hljs-comment\">// [&quot;3&quot;]</span><br>ListUtils.union(list1, list2); <span class=\"hljs-comment\">//[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;]</span><br>ListUtils.intersection(list1, list2); <span class=\"hljs-comment\">// [1&quot;, &quot;2&quot;]</span><br><span class=\"hljs-comment\">// 判断两个集合中的内容是否完全相同（顺序也一致）</span><br>ListUtils.isEqualList(list1, list2); <span class=\"hljs-comment\">// false</span><br><span class=\"hljs-comment\">// list1如果为null则转换为空List</span><br>ListUtils.emptyIfNull(list1);<br><span class=\"hljs-comment\">// list1中所有元素做Hash</span><br>ListUtils.hashCodeForList(list1);<br></code></pre></td></tr></table></figure>\n\n<p>除了以上介绍了两个还有 MapUtils，SetUtils，EnumerationUtils，IterableUtils 等不是很常用就不多做介绍了。</p>\n<h3 id=\"集合扩展\"><a href=\"#集合扩展\" class=\"headerlink\" title=\"集合扩展\"></a>集合扩展</h3><h4 id=\"FixedSizeList\"><a href=\"#FixedSizeList\" class=\"headerlink\" title=\"FixedSizeList\"></a>FixedSizeList</h4><p>FixedSizeList 用于装饰另一个 List 以阻止修改其大小。不支持添加、删除、清除等操作。set 方法是允许的（因为它不会改变列表大小），下面看代码示例</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">List&lt;String&gt; sourceList = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ArrayList</span>&lt;&gt;();<br>sourceList.add(<span class=\"hljs-string\">&quot;1&quot;</span>);<br><span class=\"hljs-comment\">// 装饰一下原list</span><br>List&lt;String&gt; list = FixedSizeList.fixedSizeList(sourceList);<br>list.set(<span class=\"hljs-number\">0</span>, <span class=\"hljs-string\">&quot;11&quot;</span>);<br>println(list); <span class=\"hljs-comment\">// [11,2,3]</span><br><span class=\"hljs-comment\">// 以下改变容器size的操作会抛出异常</span><br>list.add(<span class=\"hljs-string\">&quot;4&quot;</span>); <span class=\"hljs-comment\">// UnsupportedOperationException(&quot;List is fixed size&quot;)</span><br>list.remove(<span class=\"hljs-string\">&quot;5&quot;</span>); <span class=\"hljs-comment\">// UnsupportedOperationException(&quot;List is fixed size&quot;)</span><br>list.clear(); <span class=\"hljs-comment\">// UnsupportedOperationException(&quot;List is fixed size&quot;)</span><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"SetUniqueList\"><a href=\"#SetUniqueList\" class=\"headerlink\" title=\"SetUniqueList\"></a>SetUniqueList</h4><p>SetUniqueList 用来装饰另一个 List 以确保不存在重复元素，内部使用了 Set 来判断重复问题</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">List&lt;String&gt; sourceList = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ArrayList</span>&lt;&gt;();<br>sourceList.add(<span class=\"hljs-string\">&quot;1&quot;</span>);<br>sourceList.add(<span class=\"hljs-string\">&quot;2&quot;</span>);<br><span class=\"hljs-comment\">// 元素不重复的list</span><br>SetUniqueList&lt;String&gt; list = SetUniqueList.setUniqueList(sourceList);<br><span class=\"hljs-comment\">// 存在则不处理，不会影响原来顺序</span><br>list.add(<span class=\"hljs-string\">&quot;2&quot;</span>);<br>println(list); <span class=\"hljs-comment\">// [1,2]</span><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"TransformedList\"><a href=\"#TransformedList\" class=\"headerlink\" title=\"TransformedList\"></a>TransformedList</h4><p>TransformedList 装饰另一个 List 以转换添加的对象。add 和 set 方法受此类影响。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">List&lt;String&gt; sourceList = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ArrayList</span>&lt;&gt;();<br>sourceList.add(<span class=\"hljs-string\">&quot;1&quot;</span>);<br>sourceList.add(<span class=\"hljs-string\">&quot;2&quot;</span>);<br><span class=\"hljs-comment\">// 转换list,在添加元素的时候会通过第二个参数Transformer转换一下</span><br><span class=\"hljs-comment\">// （Transformer接口只有一个抽象方法可以使用lambda表达式）</span><br>       <br><span class=\"hljs-comment\">// transformingList不会对原list的已有元素做转换</span><br>TransformedList&lt;String&gt; list = TransformedList.transformingList(sourceList, e -&gt; e.concat(<span class=\"hljs-string\">&quot;_&quot;</span>));<br>list.add(<span class=\"hljs-string\">&quot;a&quot;</span>);<br>println(list); <span class=\"hljs-comment\">// [1, 2, a_]</span><br><br><span class=\"hljs-comment\">// transformedList会对原list的已有元素做转换</span><br>list = TransformedList.transformedList(sourceList, e -&gt; e.concat(<span class=\"hljs-string\">&quot;_&quot;</span>));<br>list.add(<span class=\"hljs-string\">&quot;a&quot;</span>);<br>println(list); <span class=\"hljs-comment\">// [1_, 2_, a_]</span><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"PredicatedList\"><a href=\"#PredicatedList\" class=\"headerlink\" title=\"PredicatedList\"></a>PredicatedList</h4><p>PredicatedList 装饰另一个 List ，装饰后的 List 在添加元素的时候会调用 Predicate 接口来判断元素，匹配通过才会被添加到集合中。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">List&lt;String&gt; sourceList = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ArrayList</span>&lt;&gt;();<br><span class=\"hljs-comment\">// 在添加元素的时候会通过第二个参数Predicate判断一下是否符合要求，符合要求才添加进来</span><br>PredicatedList&lt;String&gt; list = PredicatedList.predicatedList(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ArrayList</span>&lt;&gt;(), e -&gt; e.startsWith(<span class=\"hljs-string\">&quot;_&quot;</span>));<br>list.add(<span class=\"hljs-string\">&quot;_4&quot;</span>);<br>println(list); <span class=\"hljs-comment\">// [_4]</span><br><br><span class=\"hljs-comment\">// 以下会抛异常：java.lang.IllegalArgumentException: Cannot add Object &#x27;4&#x27;</span><br>list.add(<span class=\"hljs-string\">&quot;4&quot;</span>);<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"ListOrderedSet\"><a href=\"#ListOrderedSet\" class=\"headerlink\" title=\"ListOrderedSet\"></a>ListOrderedSet</h4><p>ListOrderedSet 有序的Set，顺序按照元素添加顺序排列，类似 List</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// 有序的set，按照插入顺序排序</span><br>Set&lt;String&gt; set = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ListOrderedSet</span>&lt;&gt;();<br>set.add(<span class=\"hljs-string\">&quot;aa&quot;</span>);<br>set.add(<span class=\"hljs-string\">&quot;11&quot;</span>);<br>set.add(<span class=\"hljs-string\">&quot;哈哈&quot;</span>);<br>println(set); <span class=\"hljs-comment\">// [aa,11,哈哈]</span><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"Bag\"><a href=\"#Bag\" class=\"headerlink\" title=\"Bag\"></a>Bag</h4><p>Bag 接口是带计数功能的集合扩展，它继承了 Collection 接口，可以当做集合来使用</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// bag 带计数功能的集合</span><br>Bag&lt;String&gt; bag = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">HashBag</span>&lt;&gt;();<br>bag.add(<span class=\"hljs-string\">&quot;a&quot;</span>);<br>bag.add(<span class=\"hljs-string\">&quot;b&quot;</span>);<br>bag.add(<span class=\"hljs-string\">&quot;a&quot;</span>);<br>println(bag.size()); <span class=\"hljs-comment\">// 3</span><br>println(bag.getCount(<span class=\"hljs-string\">&quot;a&quot;</span>)); <span class=\"hljs-comment\">// 2</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"Map扩展\"><a href=\"#Map扩展\" class=\"headerlink\" title=\"Map扩展\"></a>Map扩展</h3><h4 id=\"MultiValuedMap\"><a href=\"#MultiValuedMap\" class=\"headerlink\" title=\"MultiValuedMap\"></a>MultiValuedMap</h4><p>MultiValuedMap 和正常的 Map 有点区别，同一个 key 允许存放多个 value，这些 value 会放到一个 List 中。这个功能如果用 Java 的 Map 我们需要构造一个 <code>Map&lt;String, List&lt;String&gt;&gt;</code> 加个各种操作来实现</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// list实现，允许value重复</span><br>ListValuedMap&lt;String, String&gt; map = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ArrayListValuedHashMap</span>&lt;&gt;(); <br>map.put(<span class=\"hljs-string\">&quot;user&quot;</span>, <span class=\"hljs-string\">&quot;张三&quot;</span>);<br>map.put(<span class=\"hljs-string\">&quot;user&quot;</span>, <span class=\"hljs-string\">&quot;李四&quot;</span>);<br>map.put(<span class=\"hljs-string\">&quot;user&quot;</span>, <span class=\"hljs-string\">&quot;张三&quot;</span>);<br>map.put(<span class=\"hljs-string\">&quot;age&quot;</span>, <span class=\"hljs-string\">&quot;12&quot;</span>);<br><span class=\"hljs-comment\">// 注意：value的泛型是String, 但是get方法返回的是List&lt;String&gt;</span><br>List&lt;String&gt; users2 = map.get(<span class=\"hljs-string\">&quot;user&quot;</span>); <span class=\"hljs-comment\">// [张三,李四,张三]</span><br><br><span class=\"hljs-comment\">// multiMap的其他方法</span><br>map.containsKey(<span class=\"hljs-string\">&quot;user&quot;</span>); <span class=\"hljs-comment\">// true</span><br>map.containsValue(<span class=\"hljs-string\">&quot;张三&quot;</span>); <span class=\"hljs-comment\">// true</span><br>map.containsMapping(<span class=\"hljs-string\">&quot;user&quot;</span>, <span class=\"hljs-string\">&quot;张三&quot;</span>); <span class=\"hljs-comment\">// true</span><br><br><span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">size</span> <span class=\"hljs-operator\">=</span> map.size(); <span class=\"hljs-comment\">// 4</span><br><br>Collection&lt;String&gt; ss = map.values();<span class=\"hljs-comment\">// [张三,李四,张三,12]</span><br>map.remove(<span class=\"hljs-string\">&quot;user&quot;</span>); <span class=\"hljs-comment\">// 清空user的所有value</span><br><span class=\"hljs-comment\">// 转换为原生map</span><br>Map&lt;String, Collection&lt;String&gt;&gt; jMap = map.asMap();<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"CaseInsensitiveMap\"><a href=\"#CaseInsensitiveMap\" class=\"headerlink\" title=\"CaseInsensitiveMap\"></a>CaseInsensitiveMap</h4><p>key大小写不敏感的Map</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// key大小写不敏感</span><br>Map&lt;String, Integer&gt; map = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">CaseInsensitiveMap</span>&lt;&gt;();<br>map.put(<span class=\"hljs-string\">&quot;one&quot;</span>, <span class=\"hljs-number\">1</span>);<br>map.put(<span class=\"hljs-string\">&quot;two&quot;</span>, <span class=\"hljs-number\">2</span>);<br><span class=\"hljs-type\">Integer</span> <span class=\"hljs-variable\">o</span> <span class=\"hljs-operator\">=</span> map.get(<span class=\"hljs-string\">&quot;ONE&quot;</span>);<br>println(o); <span class=\"hljs-comment\">// 1</span><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"OrderedMap\"><a href=\"#OrderedMap\" class=\"headerlink\" title=\"OrderedMap\"></a>OrderedMap</h4><p>有顺序的 Map，按照插入顺序排序。如果使用 hashMap 的话 key 会按照 hash 值排序，可能和插入顺序一样，也可能不一样。key 数量和不同 JDK 版本都可能影响顺序，这是由于不同版本 jdk map 的 hash 算法有区别，hash 算法和当前 map 的容量也有关系。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// key有序：按照插入顺序</span><br>OrderedMap&lt;String, String&gt; map = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ListOrderedMap</span>&lt;&gt;();<br>map.put(<span class=\"hljs-string\">&quot;哈哈&quot;</span>, <span class=\"hljs-string\">&quot;1&quot;</span>);<br>map.put(<span class=\"hljs-string\">&quot;此处&quot;</span>, <span class=\"hljs-string\">&quot;2&quot;</span>);<br>map.put(<span class=\"hljs-string\">&quot;cc&quot;</span>, <span class=\"hljs-string\">&quot;3&quot;</span>);<br>map.put(<span class=\"hljs-string\">&quot;dd&quot;</span>, <span class=\"hljs-string\">&quot;4&quot;</span>);<br><span class=\"hljs-comment\">// 得到的keySet有序</span><br>Set&lt;String&gt; set = map.keySet(); <span class=\"hljs-comment\">// 哈哈,此处,cc,dd</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">nk</span> <span class=\"hljs-operator\">=</span> map.nextKey(<span class=\"hljs-string\">&quot;此处&quot;</span>); <span class=\"hljs-comment\">// cc</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">pk</span> <span class=\"hljs-operator\">=</span> map.previousKey(<span class=\"hljs-string\">&quot;此处&quot;</span>); <span class=\"hljs-comment\">// 哈哈</span><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"LRUMap\"><a href=\"#LRUMap\" class=\"headerlink\" title=\"LRUMap\"></a>LRUMap</h4><p>LRU（Least recently used，最近最少使用）算法根据数据的历史访问记录来进行淘汰数据，其核心思想是“如果数据最近被访问过，那么将来被访问的几率也更高”。</p>\n<p>各种缓存框架都有对 LRU 算法的支持，如 EhCache，GuavaCache，Redis 等，可以说是很常用的一种算法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\">LRUMap&lt;String, String&gt; map = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">LRUMap</span>&lt;&gt;(<span class=\"hljs-number\">2</span>);<br>map.put(<span class=\"hljs-string\">&quot;aa&quot;</span>, <span class=\"hljs-string\">&quot;1&quot;</span>);<br>map.put(<span class=\"hljs-string\">&quot;bb&quot;</span>, <span class=\"hljs-string\">&quot;2&quot;</span>);<br>map.put(<span class=\"hljs-string\">&quot;cc&quot;</span>, <span class=\"hljs-string\">&quot;3&quot;</span>);<br><span class=\"hljs-comment\">// 最早没有被使用的aa将被移出</span><br>println(map); <span class=\"hljs-comment\">// [bb:2, cc:3]</span><br><span class=\"hljs-comment\">// 访问一次bb，此时在put的话将会移出最早没有被访问的cc</span><br>map.get(<span class=\"hljs-string\">&quot;bb&quot;</span>);<br>map.put(<span class=\"hljs-string\">&quot;dd&quot;</span>, <span class=\"hljs-string\">&quot;4&quot;</span>);<br>println(map); <span class=\"hljs-comment\">// [bb:2, dd:4]</span><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"PassiveExpiringMap\"><a href=\"#PassiveExpiringMap\" class=\"headerlink\" title=\"PassiveExpiringMap\"></a>PassiveExpiringMap</h4><p>装饰一个 Map 以在达到过期时间时删除过期条目。当在 Map 中放置键值对时，此装饰器使用 ExpirationPolicy 来确定条目应保持多长时间，由到期时间值定义。当对 Map 做操作的时候才会检查元素是否过期并触发删除操作。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// 存活一秒钟</span><br><span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">ttlMillis</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">1000</span>;<br>PassiveExpiringMap.ExpirationPolicy&lt;String, String&gt; ep = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">PassiveExpiringMap</span>.ConstantTimeToLiveExpirationPolicy&lt;&gt;(ttlMillis);<br>PassiveExpiringMap&lt;String, String&gt; map = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">PassiveExpiringMap</span>&lt;&gt;(ep);<br>map.put(<span class=\"hljs-string\">&quot;a&quot;</span>, <span class=\"hljs-string\">&quot;1&quot;</span>);<br>map.put(<span class=\"hljs-string\">&quot;b&quot;</span>, <span class=\"hljs-string\">&quot;2&quot;</span>);<br>map.put(<span class=\"hljs-string\">&quot;c&quot;</span>, <span class=\"hljs-string\">&quot;3&quot;</span>);<br><span class=\"hljs-comment\">// 等待一秒后在获取</span><br>Thread.sleep(<span class=\"hljs-number\">1000</span>);<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">vc</span> <span class=\"hljs-operator\">=</span> map.get(<span class=\"hljs-string\">&quot;c&quot;</span>);<br>println(vc); <span class=\"hljs-comment\">// null</span><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"6-ReferenceMap\"><a href=\"#6-ReferenceMap\" class=\"headerlink\" title=\"6. ReferenceMap\"></a>6. ReferenceMap</h4><p>ReferenceMap 允许垃圾收集器删除映射。可以指定使用什么类型的引用来存储映射的键和值。如果使用的不是强引用，则垃圾收集器可以在键或值变得不可访问，或者 JVM 内存不足时删除映射。用它做一个简易的缓存不会导致存放内容过多导致内存溢出。</p>\n<h4 id=\"BidiMap\"><a href=\"#BidiMap\" class=\"headerlink\" title=\"BidiMap\"></a>BidiMap</h4><p>BidiMap 允许在 key 和 value 之间进行双向查找。其中一个键可以查找一个值，一个值可以同样轻松地查找一个键。这个接口扩展了 Map，value 不允许重复，如果重复将同时覆盖旧的键值对。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// 双向map, 可通过value获取key</span><br><span class=\"hljs-comment\">// value也不允许重复，如果重复将会覆盖旧值</span><br>BidiMap&lt;String, String&gt; map = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">TreeBidiMap</span>&lt;&gt;();<br>map.put(<span class=\"hljs-string\">&quot;dog&quot;</span>, <span class=\"hljs-string\">&quot;狗&quot;</span>);<br>map.put(<span class=\"hljs-string\">&quot;cat&quot;</span>, <span class=\"hljs-string\">&quot;猫&quot;</span>);<br><span class=\"hljs-comment\">// value重复的话key也会被覆盖，相当于&quot;cat2:猫&quot;会覆盖掉&quot;cat:猫&quot;</span><br><span class=\"hljs-comment\">// map.put(&quot;cat2&quot;, &quot;猫&quot;);</span><br>println(map); <span class=\"hljs-comment\">// &#123;cat=猫, dog=狗&#125;</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">key</span> <span class=\"hljs-operator\">=</span> map.getKey(<span class=\"hljs-string\">&quot;狗&quot;</span>);<br>println(key); <span class=\"hljs-comment\">// dog</span><br><br><span class=\"hljs-comment\">// 反向，value变为key，key变为value</span><br>BidiMap&lt;String, String&gt; iMap = map.inverseBidiMap();<br>println(iMap); <span class=\"hljs-comment\">// &#123;狗=dog, 猫=cat&#125;</span><br>println(iMap.get(<span class=\"hljs-string\">&quot;狗&quot;</span>)); <span class=\"hljs-comment\">// dog</span><br><br><span class=\"hljs-comment\">// 对反向map操作同时影响原map</span><br>iMap.put(<span class=\"hljs-string\">&quot;鱼&quot;</span>, <span class=\"hljs-string\">&quot;fish&quot;</span>);<br>println(iMap); <span class=\"hljs-comment\">// &#123;狗=dog, 猫=cat, 鱼=fish&#125;</span><br>println(map); <span class=\"hljs-comment\">// &#123;cat=猫, dog=狗, fish=鱼&#125;</span><br></code></pre></td></tr></table></figure>\n\n<h2 id=\"Commons-Compress\"><a href=\"#Commons-Compress\" class=\"headerlink\" title=\"Commons Compress\"></a>Commons Compress</h2><p>压缩、解压缩文件的组件，可以操作rar、cpio、Unix dump、tar、zip、gzip、XZ、Pack200和bzip2格式的压缩文件。</p>\n<h3 id=\"压缩\"><a href=\"#压缩\" class=\"headerlink\" title=\"压缩\"></a>压缩</h3><p>压缩：按某种算法减小文件所占用空间的大小<br>解压：按对应的逆向算法恢复文件</p>\n<table>\n<thead>\n<tr>\n<th>类名</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>GzipCompressorOutputStream</td>\n<td>压缩<code>&quot;*.gz</code>“文件</td>\n</tr>\n<tr>\n<td>GzipCompressorInputStream</td>\n<td>解压<code>&quot;*.gz</code>“文件</td>\n</tr>\n<tr>\n<td>BZip2CompressorOutputStream</td>\n<td>压缩<code>&quot;*.bz2</code>“文件</td>\n</tr>\n<tr>\n<td>BZip2CompressorInputStream</td>\n<td>解压<code>&quot;*.bz2</code>“文件</td>\n</tr>\n<tr>\n<td>XZCompressorOutputStream</td>\n<td>压缩<code>&quot;*.xz</code>“文件</td>\n</tr>\n<tr>\n<td>XZCompressorInputStream</td>\n<td>解压<code>&quot;*.xz</code>“文件</td>\n</tr>\n<tr>\n<td>FramedLZ4CompressorOutputStream</td>\n<td>压缩<code>&quot;*.lz4</code>“文件</td>\n</tr>\n<tr>\n<td>FramedLZ4CompressorInputStream</td>\n<td>解压<code>&quot;*.lz4</code>“文件</td>\n</tr>\n<tr>\n<td>BlockLZ4CompressorOutputStream</td>\n<td>压缩<code>&quot;*.block_lz4</code>“文件</td>\n</tr>\n<tr>\n<td>BlockLZ4CompressorInputStream</td>\n<td>解压<code>&quot;*.block_lz4</code>“文件</td>\n</tr>\n<tr>\n<td>Pack200CompressorOutputStream</td>\n<td>压缩<code>&quot;*.pack</code>“文件</td>\n</tr>\n<tr>\n<td>Pack200CompressorInputStream</td>\n<td>解压<code>&quot;*.pack</code>“文件</td>\n</tr>\n<tr>\n<td>DeflateCompressorOutputStream</td>\n<td>压缩<code>&quot;*.deflate</code>“文件</td>\n</tr>\n<tr>\n<td>DeflateCompressorInputStream</td>\n<td>解压<code>&quot;*.deflate</code>“文件</td>\n</tr>\n<tr>\n<td>LZMACompressorOutputStream</td>\n<td>压缩<code>&quot;*.lzma</code>“文件</td>\n</tr>\n<tr>\n<td>LZMACompressorInputStream</td>\n<td>解压<code>&quot;*.lzma</code>“文件</td>\n</tr>\n<tr>\n<td>FramedSnappyCompressorOutputStream</td>\n<td>压缩<code>&quot;*.sz</code>“文件</td>\n</tr>\n<tr>\n<td>FramedSnappyCompressorInputStream</td>\n<td>解压<code>&quot;*.sz</code>“文件</td>\n</tr>\n<tr>\n<td>ZCompressorInputStream</td>\n<td>解压<code>&quot;*.Z</code>“文件</td>\n</tr>\n</tbody></table>\n<h4 id=\"gzip\"><a href=\"#gzip\" class=\"headerlink\" title=\"gzip\"></a>gzip</h4><p>gzip是Unix，Linux上常用的压缩工具，也是当今的WEB站点上非常流行的压缩技术。其有压缩级别等概念，可以通过GzipParameters去设置。JDK8也自带了GZIPInputStream类，用法类似。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// gzip压缩</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">file</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;/test.js&quot;</span>;<br><span class=\"hljs-type\">GzipParameters</span> <span class=\"hljs-variable\">parameters</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">GzipParameters</span>();<br>parameters.setCompressionLevel(Deflater.BEST_COMPRESSION);<br>parameters.setOperatingSystem(<span class=\"hljs-number\">3</span>);<br>parameters.setFilename(FilenameUtils.getName(file));<br>parameters.setComment(<span class=\"hljs-string\">&quot;Test file&quot;</span>);<br>parameters.setModificationTime(System.currentTimeMillis());<br><span class=\"hljs-type\">FileOutputStream</span> <span class=\"hljs-variable\">fos</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileOutputStream</span>(file + <span class=\"hljs-string\">&quot;.gz&quot;</span>);<br><span class=\"hljs-keyword\">try</span> (<span class=\"hljs-type\">GzipCompressorOutputStream</span> <span class=\"hljs-variable\">gzos</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">GzipCompressorOutputStream</span>(fos, parameters);<br>    <span class=\"hljs-type\">InputStream</span> <span class=\"hljs-variable\">is</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileInputStream</span>(file)) &#123;<br>    IOUtils.copy(is, gzos);<br>&#125;<br><span class=\"hljs-comment\">// gzip解压</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">gzFile</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;/test.js.gz&quot;</span>;<br><span class=\"hljs-type\">FileInputStream</span> <span class=\"hljs-variable\">is</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileInputStream</span>(gzFile);<br><span class=\"hljs-keyword\">try</span> (<span class=\"hljs-type\">GzipCompressorInputStream</span> <span class=\"hljs-variable\">gis</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">GzipCompressorInputStream</span>(is)) &#123;<br>    <span class=\"hljs-type\">GzipParameters</span> <span class=\"hljs-variable\">p</span> <span class=\"hljs-operator\">=</span> gis.getMetaData();<br>    <span class=\"hljs-type\">File</span> <span class=\"hljs-variable\">targetFile</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">File</span>(<span class=\"hljs-string\">&quot;/test.js&quot;</span>);<br>    FileUtils.copyToFile(gis, targetFile);<br>    targetFile.setLastModified(p.getModificationTime());<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"bz2\"><a href=\"#bz2\" class=\"headerlink\" title=\"bz2\"></a>bz2</h4><p>bz2是Linux下常见的压缩文件格式，是由具有高压缩率的压缩工具bzip2生成，以后缀为.bz2结尾的压缩文件。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// 压缩bz2</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">srcFile</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;/test.tar&quot;</span>;<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">targetFile</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;/test.tar.bz2&quot;</span>;<br><span class=\"hljs-type\">FileOutputStream</span> <span class=\"hljs-variable\">os</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileOutputStream</span>(targetFile);<br><span class=\"hljs-keyword\">try</span> (<span class=\"hljs-type\">BZip2CompressorOutputStream</span> <span class=\"hljs-variable\">bzos</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">BZip2CompressorOutputStream</span>(os);<br>    <span class=\"hljs-type\">InputStream</span> <span class=\"hljs-variable\">is</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileInputStream</span>(srcFile)) &#123;<br>    IOUtils.copy(is, bzos);<br>&#125;<br><span class=\"hljs-comment\">// 解压bz2</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">bzFile</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;/test.tar.bz2&quot;</span>;<br><span class=\"hljs-type\">FileInputStream</span> <span class=\"hljs-variable\">is</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileInputStream</span>(bzFile);<br><span class=\"hljs-keyword\">try</span> (<span class=\"hljs-type\">BZip2CompressorInputStream</span> <span class=\"hljs-variable\">bzis</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">BZip2CompressorInputStream</span>(is)) &#123;<br>    <span class=\"hljs-type\">File</span> <span class=\"hljs-variable\">targetFile</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">File</span>(<span class=\"hljs-string\">&quot;test.tar&quot;</span>);<br>    FileUtils.copyToFile(bzis, targetFile);<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>其他压缩算法的使用方式和bz2基本一致，这里就不做代码示例了。</p>\n<h3 id=\"归档\"><a href=\"#归档\" class=\"headerlink\" title=\"归档\"></a>归档</h3><p>归档：将许多零散的文件整理为一个文件，文件总大小基本不变<br>解包：从归档文件中释放文件</p>\n<table>\n<thead>\n<tr>\n<th>类名</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>TarArchiveOutputStream</td>\n<td>归档<code>*.tar</code>文件</td>\n</tr>\n<tr>\n<td>TarArchiveInputStream</td>\n<td>解包<code>*.tar</code>文件</td>\n</tr>\n<tr>\n<td>ZipArchiveOutputStream</td>\n<td>归档压缩<code>*.zip</code>文件</td>\n</tr>\n<tr>\n<td>ZipArchiveInputStream</td>\n<td>解包解压<code>*.zip</code>文件</td>\n</tr>\n<tr>\n<td>JarArchiveOutputStream</td>\n<td>归档压缩<code>*.jar</code>文件</td>\n</tr>\n<tr>\n<td>JarArchiveInputStream</td>\n<td>解包解压<code>*.jar</code>文件</td>\n</tr>\n<tr>\n<td>DumpArchiveOutputStream</td>\n<td>归档<code>*.dump</code>文件</td>\n</tr>\n<tr>\n<td>DumpArchiveInputStream</td>\n<td>解包<code>*.dump</code>文件</td>\n</tr>\n<tr>\n<td>CpioArchiveOutputStream</td>\n<td>归档压缩<code>*.cpio</code>文件</td>\n</tr>\n<tr>\n<td>CpioArchiveInputStream</td>\n<td>解包解压<code>*.cpio</code>文件</td>\n</tr>\n<tr>\n<td>ArArchiveOutputStream</td>\n<td>归档压缩<code>*.ar</code>文件</td>\n</tr>\n<tr>\n<td>ArArchiveInputStream</td>\n<td>解包解压<code>*.ar</code>文件</td>\n</tr>\n<tr>\n<td>ArjArchiveInputStream</td>\n<td>解包解压<code>*.arj</code>文件</td>\n</tr>\n<tr>\n<td>SevenZOutputFile</td>\n<td>归档压缩<code>*.7z</code>文件</td>\n</tr>\n<tr>\n<td>SevenZFile</td>\n<td>解包解压<code>*.7z</code>文件</td>\n</tr>\n</tbody></table>\n<p>其中zip，jar，cpio，ar，7z既支持归档也支持压缩，能在归档的过程中做压缩处理。</p>\n<p>由于他们会处理一个个零散的文件，所以会有ArchiveEntry的概念，即一个ArchiveEntry代表归档包内的一个目录或文件。</p>\n<h4 id=\"tar\"><a href=\"#tar\" class=\"headerlink\" title=\"tar\"></a>tar</h4><p>tar是Unix和Linux系统上的常用的压缩归档工具，可以将多个文件合并为一个文件，打包后的文件后缀亦为”tar”。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// tar压缩</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">tar</span><span class=\"hljs-params\">()</span> <span class=\"hljs-keyword\">throws</span> IOException &#123;<br>    <span class=\"hljs-type\">File</span> <span class=\"hljs-variable\">srcDir</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">File</span>(<span class=\"hljs-string\">&quot;/test&quot;</span>);<br>    <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">targetFile</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;/test.tar&quot;</span>;<br>    <span class=\"hljs-keyword\">try</span> (<span class=\"hljs-type\">TarArchiveOutputStream</span> <span class=\"hljs-variable\">tos</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">TarArchiveOutputStream</span>(<br>            <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileOutputStream</span>(targetFile))) &#123;<br>        tarRecursive(tos, srcDir, <span class=\"hljs-string\">&quot;&quot;</span>);<br>    &#125;<br>&#125;<br><span class=\"hljs-comment\">// 递归压缩目录下的文件和目录</span><br><span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">tarRecursive</span><span class=\"hljs-params\">(TarArchiveOutputStream tos, File srcFile, String basePath)</span> <span class=\"hljs-keyword\">throws</span> IOException &#123;<br>    <span class=\"hljs-keyword\">if</span> (srcFile.isDirectory()) &#123;<br>        File[] files = srcFile.listFiles();<br>        <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">nextBasePath</span> <span class=\"hljs-operator\">=</span> basePath + srcFile.getName() + <span class=\"hljs-string\">&quot;/&quot;</span>;<br>        <span class=\"hljs-keyword\">if</span> (ArrayUtils.isEmpty(files)) &#123;<br>            <span class=\"hljs-comment\">// 空目录</span><br>            <span class=\"hljs-type\">TarArchiveEntry</span> <span class=\"hljs-variable\">entry</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">TarArchiveEntry</span>(srcFile, nextBasePath);<br>            tos.putArchiveEntry(entry);<br>            tos.closeArchiveEntry();<br>        &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>            <span class=\"hljs-keyword\">for</span> (File file : files) &#123;<br>                tarRecursive(tos, file, nextBasePath);<br>            &#125;<br>        &#125;<br>    &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>        <span class=\"hljs-type\">TarArchiveEntry</span> <span class=\"hljs-variable\">entry</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">TarArchiveEntry</span>(srcFile, basePath + srcFile.getName());<br>        tos.putArchiveEntry(entry);<br>        FileUtils.copyFile(srcFile, tos);<br>        tos.closeArchiveEntry();<br>    &#125;<br>&#125;<br><span class=\"hljs-comment\">// tar解压</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">untar</span><span class=\"hljs-params\">()</span> <span class=\"hljs-keyword\">throws</span> IOException &#123;<br>    <span class=\"hljs-type\">InputStream</span> <span class=\"hljs-variable\">is</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileInputStream</span>(<span class=\"hljs-string\">&quot;/test.tar&quot;</span>);<br>    <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">outPath</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;/test&quot;</span>;<br>    <span class=\"hljs-keyword\">try</span> (<span class=\"hljs-type\">TarArchiveInputStream</span> <span class=\"hljs-variable\">tis</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">TarArchiveInputStream</span>(is)) &#123;<br>        TarArchiveEntry nextEntry;<br>        <span class=\"hljs-keyword\">while</span> ((nextEntry = tis.getNextTarEntry()) != <span class=\"hljs-literal\">null</span>) &#123;<br>            <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">name</span> <span class=\"hljs-operator\">=</span> nextEntry.getName();<br>            <span class=\"hljs-type\">File</span> <span class=\"hljs-variable\">file</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">File</span>(outPath, name);<br>            <span class=\"hljs-comment\">//如果是目录，创建目录</span><br>            <span class=\"hljs-keyword\">if</span> (nextEntry.isDirectory()) &#123;<br>                file.mkdir();<br>            &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>                <span class=\"hljs-comment\">//文件则写入具体的路径中</span><br>                FileUtils.copyToFile(tis, file);<br>                file.setLastModified(nextEntry.getLastModifiedDate().getTime());<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"7z\"><a href=\"#7z\" class=\"headerlink\" title=\"7z\"></a>7z</h4><p>7z 是一种全新的压缩格式，它拥有极高的压缩比。</p>\n<p>7z 格式的主要特征：</p>\n<ul>\n<li>开放的结构</li>\n<li>高压缩比</li>\n<li>强大的 AES-256 加密</li>\n<li>能够兼容任意压缩、转换、加密算法</li>\n<li>最高支持 16000000000 GB 的文件压缩</li>\n<li>以 Unicode 为标准的文件名</li>\n<li>支持固实压缩</li>\n<li>支持文件头压缩</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// 7z压缩</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">_7z</span><span class=\"hljs-params\">()</span> <span class=\"hljs-keyword\">throws</span> IOException &#123;<br>    <span class=\"hljs-keyword\">try</span> (<span class=\"hljs-type\">SevenZOutputFile</span> <span class=\"hljs-variable\">outputFile</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">SevenZOutputFile</span>(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">File</span>(<span class=\"hljs-string\">&quot;/test.7z&quot;</span>))) &#123;<br>        <span class=\"hljs-type\">File</span> <span class=\"hljs-variable\">srcFile</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">File</span>(<span class=\"hljs-string\">&quot;/test&quot;</span>);<br>        _7zRecursive(outputFile, srcFile, <span class=\"hljs-string\">&quot;&quot;</span>);<br>    &#125;<br>&#125;<br><span class=\"hljs-comment\">// 递归压缩目录下的文件和目录</span><br><span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">_7zRecursive</span><span class=\"hljs-params\">(SevenZOutputFile _7zFile, File srcFile, String basePath)</span> <span class=\"hljs-keyword\">throws</span> IOException &#123;<br>    <span class=\"hljs-keyword\">if</span> (srcFile.isDirectory()) &#123;<br>        File[] files = srcFile.listFiles();<br>        <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">nextBasePath</span> <span class=\"hljs-operator\">=</span> basePath + srcFile.getName() + <span class=\"hljs-string\">&quot;/&quot;</span>;<br>        <span class=\"hljs-comment\">// 空目录</span><br>        <span class=\"hljs-keyword\">if</span> (ArrayUtils.isEmpty(files)) &#123;<br>            <span class=\"hljs-type\">SevenZArchiveEntry</span> <span class=\"hljs-variable\">entry</span> <span class=\"hljs-operator\">=</span> _7zFile.createArchiveEntry(srcFile, nextBasePath);<br>            _7zFile.putArchiveEntry(entry);<br>            _7zFile.closeArchiveEntry();<br>        &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>            <span class=\"hljs-keyword\">for</span> (File file : files) &#123;<br>                _7zRecursive(_7zFile, file, nextBasePath);<br>            &#125;<br>        &#125;<br>    &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>        <span class=\"hljs-type\">SevenZArchiveEntry</span> <span class=\"hljs-variable\">entry</span> <span class=\"hljs-operator\">=</span> _7zFile.createArchiveEntry(srcFile, basePath + srcFile.getName());<br>        _7zFile.putArchiveEntry(entry);<br>        <span class=\"hljs-type\">byte</span>[] bs = FileUtils.readFileToByteArray(srcFile);<br>        _7zFile.write(bs);<br>        _7zFile.closeArchiveEntry();<br>    &#125;<br>&#125;<br> <span class=\"hljs-comment\">// 7z解压</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">un7z</span><span class=\"hljs-params\">()</span> <span class=\"hljs-keyword\">throws</span> IOException &#123;<br>    <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">outPath</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;/test&quot;</span>;<br>    <span class=\"hljs-keyword\">try</span> (<span class=\"hljs-type\">SevenZFile</span> <span class=\"hljs-variable\">archive</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">SevenZFile</span>(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">File</span>(<span class=\"hljs-string\">&quot;test.7z&quot;</span>))) &#123;<br>        SevenZArchiveEntry entry;<br>        <span class=\"hljs-keyword\">while</span> ((entry = archive.getNextEntry()) != <span class=\"hljs-literal\">null</span>) &#123;<br>            <span class=\"hljs-type\">File</span> <span class=\"hljs-variable\">file</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">File</span>(outPath, entry.getName());<br>            <span class=\"hljs-keyword\">if</span> (entry.isDirectory()) &#123;<br>                file.mkdirs();<br>            &#125;<br>            <span class=\"hljs-keyword\">if</span> (entry.hasStream()) &#123;<br>                <span class=\"hljs-keyword\">final</span> <span class=\"hljs-type\">byte</span> [] buf = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">byte</span> [<span class=\"hljs-number\">1024</span>];<br>                <span class=\"hljs-keyword\">final</span> <span class=\"hljs-type\">ByteArrayOutputStream</span> <span class=\"hljs-variable\">baos</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ByteArrayOutputStream</span>();<br>                <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">len</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; (len = archive.read(buf)) &gt; <span class=\"hljs-number\">0</span>;) &#123;<br>                    baos.write(buf, <span class=\"hljs-number\">0</span>, len);<br>                &#125;<br>                FileUtils.writeByteArrayToFile(file, baos.toByteArray());<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"修改归档文件\"><a href=\"#修改归档文件\" class=\"headerlink\" title=\"修改归档文件\"></a>修改归档文件</h3><p>有时候我们会有修改归档内文件的需求，比如添加、删除一个文件，修改其中的文件内容等，当然我们也可以全部解压出来改完后在压缩回去。这样除了代码量多一些外，归档文件大也会导致操作时间过长。那么有没有办法用代码去动态的修改归档文件里的内容呢？</p>\n<p>org.apache.commons.compress.changes包下正好就提供了一些类用于动态的修改归档文件里的内容。下面看一个简单的例子</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">tarFile</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;/test.tar&quot;</span>;<br><span class=\"hljs-type\">InputStream</span> <span class=\"hljs-variable\">is</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileInputStream</span>(tarFile);<br><span class=\"hljs-comment\">// 替换后会覆盖原test.tar，如果是windows可能会由于文件被访问而覆盖报错</span><br><span class=\"hljs-type\">OutputStream</span> <span class=\"hljs-variable\">os</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileOutputStream</span>(tarFile);<br><span class=\"hljs-keyword\">try</span> (<span class=\"hljs-type\">TarArchiveInputStream</span> <span class=\"hljs-variable\">tais</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">TarArchiveInputStream</span>(is);<br>     <span class=\"hljs-type\">TarArchiveOutputStream</span> <span class=\"hljs-variable\">taos</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">TarArchiveOutputStream</span>(os)) &#123;<br>    <span class=\"hljs-type\">ChangeSet</span> <span class=\"hljs-variable\">changes</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ChangeSet</span>();<br>    <span class=\"hljs-comment\">// 删除&quot;test.tar中&quot;的&quot;dir/1.txt&quot;文件</span><br>    changes.delete(<span class=\"hljs-string\">&quot;dir/1.txt&quot;</span>);<br>    <span class=\"hljs-comment\">// 删除&quot;test.tar&quot;中的&quot;t&quot;目录</span><br>    changes.delete(<span class=\"hljs-string\">&quot;t&quot;</span>);<br>    <span class=\"hljs-comment\">// 添加文件，如果已存在则替换</span><br>    <span class=\"hljs-type\">File</span> <span class=\"hljs-variable\">addFile</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">File</span>(<span class=\"hljs-string\">&quot;/a.txt&quot;</span>);<br>    <span class=\"hljs-type\">ArchiveEntry</span> <span class=\"hljs-variable\">addEntry</span> <span class=\"hljs-operator\">=</span> taos.createArchiveEntry(addFile, addFile.getName());<br>    <span class=\"hljs-comment\">// add可传第三个参数：true: 已存在则替换(默认值)， false: 不替换</span><br>    changes.add(addEntry, <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileInputStream</span>(addFile));<br>    <span class=\"hljs-comment\">// 执行修改</span><br>    <span class=\"hljs-type\">ChangeSetPerformer</span> <span class=\"hljs-variable\">performer</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ChangeSetPerformer</span>(changes);<br>    <span class=\"hljs-type\">ChangeSetResults</span> <span class=\"hljs-variable\">result</span> <span class=\"hljs-operator\">=</span> performer.perform(tais, taos);<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h3><h4 id=\"简单工厂\"><a href=\"#简单工厂\" class=\"headerlink\" title=\"简单工厂\"></a>简单工厂</h4><p>commons-compress还提供了一些简单的工厂类用户动态的获取压缩流和归档流。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// 使用factory动态获取归档流</span><br><span class=\"hljs-type\">ArchiveStreamFactory</span> <span class=\"hljs-variable\">factory</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ArchiveStreamFactory</span>();<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">archiveName</span> <span class=\"hljs-operator\">=</span> ArchiveStreamFactory.TAR;<br><span class=\"hljs-type\">InputStream</span> <span class=\"hljs-variable\">is</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileInputStream</span>(<span class=\"hljs-string\">&quot;/in.tar&quot;</span>);<br><span class=\"hljs-type\">OutputStream</span> <span class=\"hljs-variable\">os</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileOutputStream</span>(<span class=\"hljs-string\">&quot;/out.tar&quot;</span>);<br><span class=\"hljs-comment\">// 动态获取实现类，此时ais实际上是TarArchiveOutPutStream</span><br><span class=\"hljs-type\">ArchiveInputStream</span> <span class=\"hljs-variable\">ais</span> <span class=\"hljs-operator\">=</span> factory.createArchiveInputStream(archiveName, is);<br><span class=\"hljs-type\">ArchiveOutputStream</span> <span class=\"hljs-variable\">aos</span> <span class=\"hljs-operator\">=</span> factory.createArchiveOutputStream(archiveName, os);<br><span class=\"hljs-comment\">// 其他业务操作</span><br><br><span class=\"hljs-comment\">// ------------------------</span><br><br><span class=\"hljs-comment\">// 使用factory动态获取压缩流</span><br><span class=\"hljs-type\">CompressorStreamFactory</span> <span class=\"hljs-variable\">factory</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">CompressorStreamFactory</span>();<br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">compressName</span> <span class=\"hljs-operator\">=</span> CompressorStreamFactory.GZIP;<br><span class=\"hljs-type\">InputStream</span> <span class=\"hljs-variable\">is</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileInputStream</span>(<span class=\"hljs-string\">&quot;/in.gz&quot;</span>);<br><span class=\"hljs-type\">OutputStream</span> <span class=\"hljs-variable\">os</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileOutputStream</span>(<span class=\"hljs-string\">&quot;/out.gz&quot;</span>);<br><span class=\"hljs-comment\">// 动态获取实现类，此时ais实际上是TarArchiveOutPutStream</span><br><span class=\"hljs-type\">CompressorInputStream</span> <span class=\"hljs-variable\">cis</span> <span class=\"hljs-operator\">=</span> factory.createCompressorInputStream(compressName, is);<br><span class=\"hljs-type\">CompressorOutputStream</span> <span class=\"hljs-variable\">cos</span> <span class=\"hljs-operator\">=</span> factory.createCompressorOutputStream(compressName, os);<br><span class=\"hljs-comment\">// 其他业务操作</span><br></code></pre></td></tr></table></figure>\n\n<h4 id=\"同时解压解包\"><a href=\"#同时解压解包\" class=\"headerlink\" title=\"同时解压解包\"></a>同时解压解包</h4><p>上面说了很多都是单一的操作，那么如果解压”test.tar.gz”这种归档和压缩于一体的文件呢？</p>\n<p>其实很简单，我们不需要先解压在解包，可以一步同时完成解压和解包，只需要将对应的流包装一下即可（不得不感叹Java IO的装饰者模式设计真的很巧妙）。下面看代码示例</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">// 解压 解包test.tar.gz文件</span><br><span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">outPath</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;/test&quot;</span>;<br><span class=\"hljs-type\">InputStream</span> <span class=\"hljs-variable\">is</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileInputStream</span>(<span class=\"hljs-string\">&quot;/test.tar.gz&quot;</span>);<br><span class=\"hljs-comment\">// 先解压，所以需要先用gzip流包装文件流</span><br><span class=\"hljs-type\">CompressorInputStream</span> <span class=\"hljs-variable\">gis</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">GzipCompressorInputStream</span>(is);<br><span class=\"hljs-comment\">// 在解包，用tar流包装gzip流</span><br><span class=\"hljs-keyword\">try</span> (<span class=\"hljs-type\">ArchiveInputStream</span> <span class=\"hljs-variable\">tgis</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">TarArchiveInputStream</span>(gis)) &#123;<br>    ArchiveEntry nextEntry;<br>    <span class=\"hljs-keyword\">while</span> ((nextEntry = tgis.getNextEntry()) != <span class=\"hljs-literal\">null</span>) &#123;<br>        <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">name</span> <span class=\"hljs-operator\">=</span> nextEntry.getName();<br>        <span class=\"hljs-type\">File</span> <span class=\"hljs-variable\">file</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">File</span>(outPath, name);<br>        <span class=\"hljs-comment\">// 如果是目录，创建目录</span><br>        <span class=\"hljs-keyword\">if</span> (nextEntry.isDirectory()) &#123;<br>            file.mkdir();<br>        &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>            <span class=\"hljs-comment\">// 文件则写入具体的路径中</span><br>            FileUtils.copyToFile(tgis, file);<br>            file.setLastModified(nextEntry.getLastModifiedDate().getTime());<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<h2 id=\"Commons-Configuration\"><a href=\"#Commons-Configuration\" class=\"headerlink\" title=\"Commons Configuration\"></a>Commons Configuration</h2><p>是一个Java应用程序的配置管理工具，可以从properties或者xml文件中加载配置信息。</p>\n<h2 id=\"Commons-CSV\"><a href=\"#Commons-CSV\" class=\"headerlink\" title=\"Commons CSV\"></a>Commons CSV</h2><p>是一个用来读写各种Comma Separated Value(CSV)格式文件的Java类库。</p>\n<h2 id=\"Commons-Daemon\"><a href=\"#Commons-Daemon\" class=\"headerlink\" title=\"Commons Daemon\"></a>Commons Daemon</h2><p>实现将普通的Java应用变成系统的后台服务,例如 Tomcat 就是利用这个项目来实现作为 Linux 和 Windows 的服务启动和停止的。</p>\n<h2 id=\"Commons-DBCP\"><a href=\"#Commons-DBCP\" class=\"headerlink\" title=\"Commons DBCP\"></a>Commons DBCP</h2><p>数据库连接池。</p>\n<h2 id=\"Commons-DBUtils\"><a href=\"#Commons-DBUtils\" class=\"headerlink\" title=\"Commons DBUtils\"></a>Commons DBUtils</h2><p>是JDBC工具组件，对传统操作数据库的类进行二次封装，可以把结果集转化成List。</p>\n<h2 id=\"Commons-Digester\"><a href=\"#Commons-Digester\" class=\"headerlink\" title=\"Commons Digester\"></a>Commons Digester</h2><p>是XML到Java对象的映射工具集。</p>\n<h2 id=\"Commons-Email\"><a href=\"#Commons-Email\" class=\"headerlink\" title=\"Commons Email\"></a>Commons Email</h2><p>是邮件操作组件，对Java Mail API进行了封装，提供了常用的邮件发送和接收类，简化邮件操作。该组件依赖Java Mail API。</p>\n<h2 id=\"Commons-Exec\"><a href=\"#Commons-Exec\" class=\"headerlink\" title=\"Commons Exec\"></a>Commons Exec</h2><p>提供一些常用的方法用来执行外部进程，如执行exe文件或命令行。</p>\n<h2 id=\"Commons-FileUpload\"><a href=\"#Commons-FileUpload\" class=\"headerlink\" title=\"Commons FileUpload\"></a>Commons FileUpload</h2><p>为Web应用程序或Servlet提供文件上传功能，Struts2和SpringMVC的文件上传组件。</p>\n<h2 id=\"Commons-IO\"><a href=\"#Commons-IO\" class=\"headerlink\" title=\"Commons IO\"></a>Commons IO</h2><p>是处理IO的工具类包，对java.io进行扩展，提供了更加方便的IO操作。</p>\n<h2 id=\"Commons-JCI\"><a href=\"#Commons-JCI\" class=\"headerlink\" title=\"Commons JCI\"></a>Commons JCI</h2><p>提供通用的Java编译器接口。</p>\n<h2 id=\"Commons-Lang3\"><a href=\"#Commons-Lang3\" class=\"headerlink\" title=\"Commons Lang3\"></a>Commons Lang3</h2><p>是处理Java基本对象方法的工具类包，该类包提供对字符、数组等基本对象的操作，弥补了java.lang api基本处理方法上的不足。</p>\n<ul>\n<li><a href=\"http://commons.apache.org/proper/commons-lang/javadocs/api-release/index.html\">API 文档</a></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>工具类</th>\n<th>简介</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>ArrayUtils</td>\n<td>用于对数组的操作，如添加、查找、删除、子数组、倒序、元素类型转换等</td>\n</tr>\n<tr>\n<td>BitField</td>\n<td>用于操作位元，提供了一些方便而安全的方法</td>\n</tr>\n<tr>\n<td>BooleanUtils</td>\n<td>用于操作和转换boolean或者Boolean及相应的数组</td>\n</tr>\n<tr>\n<td>CharEncoding</td>\n<td>包含了Java环境支持的字符编码，提供是否支持某种编码的判断</td>\n</tr>\n<tr>\n<td>CharRange</td>\n<td>用于设定字符范围并做相应检查</td>\n</tr>\n<tr>\n<td>CharSet</td>\n<td>用于设定一组字符作为范围并做相应检查</td>\n</tr>\n<tr>\n<td>CharSetUtils</td>\n<td>用于操作CharSet</td>\n</tr>\n<tr>\n<td>CharUtils</td>\n<td>用于操作char值和Character对象</td>\n</tr>\n<tr>\n<td>ClassUtils</td>\n<td>用于对Java类的操作，不使用反射</td>\n</tr>\n<tr>\n<td>ObjectUtils</td>\n<td>用于操作Java对象，提供null安全的访问和其他一些功能</td>\n</tr>\n<tr>\n<td>RandomStringUtils</td>\n<td>用于生成随机的字符串</td>\n</tr>\n<tr>\n<td>SerializationUtils</td>\n<td>用于处理对象序列化，提供比一般Java序列化更高级的处理能力</td>\n</tr>\n<tr>\n<td>StringEscapeUtils</td>\n<td>用于正确处理转义字符，产生正确的Java、JavaScript、HTML、XML和SQL代码</td>\n</tr>\n<tr>\n<td>StringUtils</td>\n<td>处理String的核心类，提供了相当多的功能</td>\n</tr>\n<tr>\n<td>SystemUtils</td>\n<td>在java.lang.System基础上提供更方便的访问，如用户路径、Java版本、时区、操作系统等判断</td>\n</tr>\n<tr>\n<td>Validate</td>\n<td>提供验证的操作，有点类似assert断言</td>\n</tr>\n<tr>\n<td>WordUtils</td>\n<td>用于处理单词大小写、换行等</td>\n</tr>\n</tbody></table>\n<h2 id=\"Commons-Logging\"><a href=\"#Commons-Logging\" class=\"headerlink\" title=\"Commons Logging\"></a>Commons Logging</h2><p>提供统一的日志接口，同时兼顾轻量级和不依赖于具体的实现。类包给中间件&#x2F;日志工具开发者一个简单的日志操作抽象，允许程序开发人员使用不同的具体日志实现工具。</p>\n<h2 id=\"Commons-Math\"><a href=\"#Commons-Math\" class=\"headerlink\" title=\"Commons Math\"></a>Commons Math</h2><p>轻量级自容器的数学和统计计算方法类包，包含大多数常用的数值算法。</p>\n<h2 id=\"Commons-Net\"><a href=\"#Commons-Net\" class=\"headerlink\" title=\"Commons Net\"></a>Commons Net</h2><p>封装了各种网络协议的客户端，支持FTP、NNTP、SMTP、POP3、Telnet等协议。</p>\n<h2 id=\"Commons-Pool\"><a href=\"#Commons-Pool\" class=\"headerlink\" title=\"Commons Pool\"></a>Commons Pool</h2><p>提供了一整套用于实现对象池化的框架，以及若干各具特色的对象池实现，可以有效地减少处理对象池化时的工作量。类包用于提高像文件句柄、数据库连接、socket通信这类大对象的调用效率，简单的说就是一种对象一次创建多次使用的技术。</p>\n<h2 id=\"Commons-Primitives\"><a href=\"#Commons-Primitives\" class=\"headerlink\" title=\"Commons Primitives\"></a>Commons Primitives</h2><p>提供了一个更小，更快和更易使用的对Java基本类型的支持。</p>\n<h2 id=\"Commons-Validator\"><a href=\"#Commons-Validator\" class=\"headerlink\" title=\"Commons Validator\"></a>Commons Validator</h2><p>提供了一个简单的、可扩展的框架来在一个XML文件中定义校验器(校验方法)和校验规则。支持校验规则的和错误消息的国际化。</p>\n<h2 id=\"Apache-HttpClient\"><a href=\"#Apache-HttpClient\" class=\"headerlink\" title=\"Apache HttpClient\"></a>Apache HttpClient</h2><p>曾经是Apache Commons的子项目，后来独立出来。HttpClient简化HTTP客户端与服务器的各种通讯，实现HTTP客户端程序（也就是浏览器程序）的功能。</p>\n",
            "tags": [
                "工具类",
                "常用开发库",
                "Apache Common"
            ]
        }
    ]
}
<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png"><link rel="icon" href="/img/fluid.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="will"><meta name="keywords" content="will"><meta name="description" content="上文详细介绍了easyExcel的优点以及相关的读操作，通过这些案例你会发现，阿里巴巴的easyExcel真的对POI做了大量的封装和优化，同时让我们开发者使用也变得那么的so easy，那么今天博猪就紧着介绍一下easyExcel相关的写操作，看完这些案例就会发现Excel的处理也不是那么头疼了。  Excel操作-写准备工作 创建导出数据，我们默认用一个私有方法代替。 生成文件为了方便查看，"><meta property="og:type" content="article"><meta property="og:title" content="EasyExcel保姆级教程(2)"><meta property="og:url" content="https://github.com/yangxiangnanwill/yangxiangnanwill.github.io/2023/05/28/%E5%A5%BD%E5%A5%BD%E7%A0%81%E4%BB%A3%E7%A0%81%E5%90%96/JAVA/POI/EasyExcel%E4%BF%9D%E5%A7%86%E7%BA%A7%E6%95%99%E7%A8%8B(2)/index.html"><meta property="og:site_name" content="Will"><meta property="og:description" content="上文详细介绍了easyExcel的优点以及相关的读操作，通过这些案例你会发现，阿里巴巴的easyExcel真的对POI做了大量的封装和优化，同时让我们开发者使用也变得那么的so easy，那么今天博猪就紧着介绍一下easyExcel相关的写操作，看完这些案例就会发现Excel的处理也不是那么头疼了。  Excel操作-写准备工作 创建导出数据，我们默认用一个私有方法代替。 生成文件为了方便查看，"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2023-05-28T13:00:29.396Z"><meta property="article:modified_time" content="2023-05-28T13:03:53.382Z"><meta property="article:author" content="will"><meta property="article:tag" content="POI"><meta property="article:tag" content="EasyExcel"><meta name="twitter:card" content="summary_large_image"><title>EasyExcel保姆级教程(2) - Will</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var dntVal,Fluid=window.Fluid||{},CONFIG=(Fluid.ctx=Object.assign({},Fluid.ctx),{hostname:"github.com",root:"/",version:"1.9.4",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,follow_dnt:!0,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml"});CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 5.4.2"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>WILL</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="EasyExcel保姆级教程(2)"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2023-05-28 21:00" pubdate>2023年5月28日 晚上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 18k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 148 分钟</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">EasyExcel保姆级教程(2)</h1><div class="markdown-body"><blockquote><p>上文详细介绍了<code>easyExcel</code>的优点以及相关的读操作，通过这些案例你会发现，阿里巴巴的<code>easyExcel</code>真的对POI做了大量的封装和优化，同时让我们开发者使用也变得那么的so easy，那么今天博猪就紧着介绍一下<code>easyExcel</code>相关的写操作，看完这些案例就会发现Excel的处理也不是那么头疼了。</p></blockquote><h1 id="Excel操作-写"><a href="#Excel操作-写" class="headerlink" title="Excel操作-写"></a>Excel操作-写</h1><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><blockquote><p>创建导出数据，我们默认用一个私有方法代替。</p><p>生成文件为了方便查看，博猪统一放在<code>C:\Users\$&#123;userName&#125;</code>目录下；</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 生成模拟数据</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> createNum   创建数量</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">private</span> List&lt;SimpleWriteEntity&gt; <span class="hljs-title function_">createData</span><span class="hljs-params">(<span class="hljs-type">int</span> createNum)</span> &#123;<br>    List&lt;SimpleWriteEntity&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <span class="hljs-type">Random</span> <span class="hljs-variable">random</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Random</span>();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; createNum; i++) &#123;<br>        <span class="hljs-type">SimpleWriteEntity</span> <span class="hljs-variable">entity</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleWriteEntity</span>();<br>        entity.setTitle(<span class="hljs-string">&quot;标题&quot;</span> + i);<br>        entity.setDateTitle(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>        entity.setNumberTitle(random.nextDouble());<br>        list.add(entity);<br>    &#125;<br>    <span class="hljs-keyword">return</span> list;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="简单写"><a href="#简单写" class="headerlink" title="简单写"></a>简单写</h2><h3 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Getter</span><br><span class="hljs-meta">@Setter</span><br><span class="hljs-meta">@ToString</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleWriteEntity</span> &#123;<br>    <span class="hljs-meta">@ExcelProperty(&quot;字符串标题&quot;)</span><br>    <span class="hljs-keyword">private</span> String title;<br>    <span class="hljs-meta">@ExcelProperty(&quot;日期标题&quot;)</span><br>    <span class="hljs-keyword">private</span> Date dateTitle;<br>    <span class="hljs-meta">@ExcelProperty(&quot;数字标题&quot;)</span><br>    <span class="hljs-keyword">private</span> Double numberTitle;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 忽略这个字段</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@ExcelIgnore</span><br>    <span class="hljs-keyword">private</span> String ignoreFiled;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="测试代码"><a href="#测试代码" class="headerlink" title="测试代码"></a>测试代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 最简单的写</span><br><span class="hljs-comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="hljs-doctag">@link</span> SimpleWriteEntity&#125;</span><br><span class="hljs-comment"> * &lt;p&gt;2. 直接写即可</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSimpleWrite</span><span class="hljs-params">()</span> &#123;<br>    List&lt;SimpleWriteEntity&gt; data = createData(<span class="hljs-number">10</span>);<br>    <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> FileUtil.readUserHomeFile(<span class="hljs-string">&quot;simpleWrite&quot;</span> + System.currentTimeMillis() + SUFFIX_EXCEL_FILE_TYPE);<br>    <span class="hljs-comment">// 写法1：</span><br>    <span class="hljs-comment">// 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br>    <span class="hljs-comment">// 如果这里想使用03 则 传入excelType参数即可</span><br>    EasyExcel.write(file, SimpleWriteEntity.class).sheet(<span class="hljs-string">&quot;模板&quot;</span>).doWrite(data);<br><br>    <span class="hljs-comment">//写法2</span><br>    <span class="hljs-type">ExcelWriter</span> <span class="hljs-variable">excelWriter</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        excelWriter = EasyExcel.write(file, SimpleWriteEntity.class).build();<br>        <span class="hljs-type">WriteSheet</span> <span class="hljs-variable">writeSheet</span> <span class="hljs-operator">=</span> EasyExcel.writerSheet(<span class="hljs-string">&quot;模板&quot;</span>).build();<br>        excelWriter.write(data, writeSheet);<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">// 千万别忘记finish 会帮忙关闭流</span><br>        <span class="hljs-keyword">if</span> (excelWriter != <span class="hljs-literal">null</span>) &#123;<br>            excelWriter.finish();<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="根据参数只导出指定列"><a href="#根据参数只导出指定列" class="headerlink" title="根据参数只导出指定列"></a>根据参数只导出指定列</h2><h3 id="测试代码-1"><a href="#测试代码-1" class="headerlink" title="测试代码"></a>测试代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 根据参数只导出指定列</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 1. 创建excel对应的实体对象 参照&#123;<span class="hljs-doctag">@link</span> SimpleWriteEntity&#125;</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 2. 根据自己或者排除自己需要的列</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 3. 直接写即可</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2.1.1</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testWriteByParams</span><span class="hljs-params">()</span> &#123;<br>    List&lt;SimpleWriteEntity&gt; data = createData(<span class="hljs-number">10</span>);<br>    <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> FileUtil.readUserHomeFile(<span class="hljs-string">&quot;writeByParams&quot;</span> + System.currentTimeMillis() + SUFFIX_EXCEL_FILE_TYPE);<br><br>    <span class="hljs-comment">// 根据用户传入字段 假设我们要忽略 date</span><br>    Set&lt;String&gt; excludeColumnFiledNames = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;String&gt;();<br>    excludeColumnFiledNames.add(<span class="hljs-string">&quot;dateTitle&quot;</span>);<br>    <span class="hljs-comment">// 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br>    EasyExcel.write(file, SimpleWriteEntity.class).excludeColumnFiledNames(excludeColumnFiledNames).sheet(<span class="hljs-string">&quot;模板&quot;</span>)<br>            .doWrite(data);<br><br>    <span class="hljs-comment">// 根据用户传入字段 假设我们只要导出 date</span><br>    Set&lt;String&gt; includeColumnFiledNames = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;String&gt;();<br>    includeColumnFiledNames.add(<span class="hljs-string">&quot;dateTitle&quot;</span>);<br>    <span class="hljs-comment">// 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br>    EasyExcel.write(file, SimpleWriteEntity.class).includeColumnFiledNames(includeColumnFiledNames).sheet(<span class="hljs-string">&quot;模板&quot;</span>)<br>            .doWrite(data);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="指定写入的列"><a href="#指定写入的列" class="headerlink" title="指定写入的列"></a>指定写入的列</h2><h3 id="对象-1"><a href="#对象-1" class="headerlink" title="对象"></a>对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Getter</span><br><span class="hljs-meta">@Setter</span><br><span class="hljs-meta">@ToString</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WriteByAnnotationEntity</span> &#123;<br>    <span class="hljs-meta">@ExcelProperty(value = &quot;字符串标题&quot;, index = 0)</span><br>    <span class="hljs-keyword">private</span> String title;<br>    <span class="hljs-meta">@ExcelProperty(value = &quot;日期标题&quot;, index = 1)</span><br>    <span class="hljs-keyword">private</span> Date dateTitle;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 这里设置3 会导致第二列空的</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@ExcelProperty(value = &quot;数字标题&quot;, index = 3)</span><br>    <span class="hljs-keyword">private</span> Double numberTitle;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="测试代码-2"><a href="#测试代码-2" class="headerlink" title="测试代码"></a>测试代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 指定写入的列</span><br><span class="hljs-comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="hljs-doctag">@link</span> WriteByAnnotationEntity&#125;</span><br><span class="hljs-comment"> * &lt;p&gt;2. 使用&#123;<span class="hljs-doctag">@link</span> ExcelProperty&#125;注解指定写入的列</span><br><span class="hljs-comment"> * &lt;p&gt;3. 直接写即可</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testWriteByAnnotation</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> FileUtil.readUserHomeFile(<span class="hljs-string">&quot;WriteByAnnotation&quot;</span> + System.currentTimeMillis() + SUFFIX_EXCEL_FILE_TYPE);<br>    <span class="hljs-comment">// 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br>    EasyExcel.write(file, WriteByAnnotationEntity.class).sheet(<span class="hljs-string">&quot;模板&quot;</span>).doWrite(createData(<span class="hljs-number">10</span>));<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="复杂头写入"><a href="#复杂头写入" class="headerlink" title="复杂头写入"></a>复杂头写入</h2><h3 id="对象-2"><a href="#对象-2" class="headerlink" title="对象"></a>对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ComplexHeadEntity</span> &#123;<br>    <span class="hljs-meta">@ExcelProperty(&#123;&quot;主标题&quot;, &quot;字符串标题&quot;&#125;)</span><br>    <span class="hljs-keyword">private</span> String title;<br>    <span class="hljs-meta">@ExcelProperty(&#123;&quot;主标题&quot;, &quot;日期标题&quot;&#125;)</span><br>    <span class="hljs-keyword">private</span> Date dateTitle;<br>    <span class="hljs-meta">@ExcelProperty(&#123;&quot;主标题&quot;, &quot;数字标题&quot;&#125;)</span><br>    <span class="hljs-keyword">private</span> Double numberTitle;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="测试代码-3"><a href="#测试代码-3" class="headerlink" title="测试代码"></a>测试代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 复杂头写入</span><br><span class="hljs-comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="hljs-doctag">@link</span> ComplexHeadEntity&#125;</span><br><span class="hljs-comment"> * &lt;p&gt;2. 使用&#123;<span class="hljs-doctag">@link</span> ExcelProperty&#125;注解指定复杂的头</span><br><span class="hljs-comment"> * &lt;p&gt;3. 直接写即可</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testWriteComplexHead</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> FileUtil.readUserHomeFile(<span class="hljs-string">&quot;WriteComplexHead&quot;</span> + System.currentTimeMillis() + SUFFIX_EXCEL_FILE_TYPE);<br>    EasyExcel.write(file, ComplexHeadEntity.class).sheet(<span class="hljs-string">&quot;模板&quot;</span>).doWrite(createData(<span class="hljs-number">10</span>));<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="同一个对象数据写到同一个Sheet"><a href="#同一个对象数据写到同一个Sheet" class="headerlink" title="同一个对象数据写到同一个Sheet"></a>同一个对象数据写到同一个Sheet</h2><h3 id="测试代码-4"><a href="#测试代码-4" class="headerlink" title="测试代码"></a>测试代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 重复多次写入-写到同一个sheet</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 1. 创建excel对应的实体对象 参照&#123;<span class="hljs-doctag">@link</span> SimpleWriteEntity&#125;</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 2. 使用&#123;<span class="hljs-doctag">@link</span> ExcelProperty&#125;注解指定复杂的头</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 3. 直接调用二次写入即可</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span>  <span class="hljs-title function_">testWriteManyDataToOneSheet</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> FileUtil.readUserHomeFile(<span class="hljs-string">&quot;WriteManyDataToOneSheet&quot;</span> + System.currentTimeMillis() + SUFFIX_EXCEL_FILE_TYPE);<br>    <span class="hljs-type">ExcelWriter</span> <span class="hljs-variable">excelWriter</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">// 这里 需要指定写用哪个class去写</span><br>        excelWriter = EasyExcel.write(file, SimpleWriteEntity.class).build();<br>        <span class="hljs-comment">// 这里注意 如果同一个sheet只要创建一次</span><br>        <span class="hljs-type">WriteSheet</span> <span class="hljs-variable">writeSheet</span> <span class="hljs-operator">=</span> EasyExcel.writerSheet(<span class="hljs-string">&quot;模板&quot;</span>).build();<br>        <span class="hljs-comment">// 去调用写入,这里我调用了五次，实际使用时根据数据库分页的总的页数来</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>            <span class="hljs-comment">// 分页去数据库查询数据 这里可以去数据库查询每一页的数据</span><br>            List&lt;SimpleWriteEntity&gt; data = createData(<span class="hljs-number">10</span>);<br>            excelWriter.write(data, writeSheet);<br>        &#125;<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">// 千万别忘记finish 会帮忙关闭流</span><br>        <span class="hljs-keyword">if</span> (excelWriter != <span class="hljs-literal">null</span>) &#123;<br>            excelWriter.finish();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="同一个对象数据写到不同sheet"><a href="#同一个对象数据写到不同sheet" class="headerlink" title="同一个对象数据写到不同sheet"></a>同一个对象数据写到不同sheet</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 重复多次写入-写到不同的sheet 同一个对象</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 1. 创建excel对应的实体对象 参照&#123;<span class="hljs-doctag">@link</span> SimpleWriteEntity&#125;</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 2. 使用&#123;<span class="hljs-doctag">@link</span> ExcelProperty&#125;注解指定复杂的头</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 3. 直接调用二次写入即可</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testWriteManyDataToManySheet</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> FileUtil.readUserHomeFile(<span class="hljs-string">&quot;WriteManyDataToManySheet&quot;</span> + System.currentTimeMillis() + SUFFIX_EXCEL_FILE_TYPE);<br>    <span class="hljs-type">ExcelWriter</span> <span class="hljs-variable">excelWriter</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">// 这里 指定文件</span><br>        excelWriter = EasyExcel.write(file, SimpleWriteEntity.class).build();<br>        <span class="hljs-comment">// 去调用写入,这里我调用了五次，实际使用时根据数据库分页的总的页数来。这里最终会写到5个sheet里面</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>            <span class="hljs-comment">// 每次都要创建writeSheet 这里注意必须指定sheetNo 而且sheetName必须不一样</span><br>            <span class="hljs-type">WriteSheet</span> <span class="hljs-variable">writeSheet</span> <span class="hljs-operator">=</span> EasyExcel.writerSheet(i, <span class="hljs-string">&quot;模板&quot;</span> + i).build();<br>            <span class="hljs-comment">// 分页去数据库查询数据 这里可以去数据库查询每一页的数据</span><br>            List&lt;SimpleWriteEntity&gt; data = createData(<span class="hljs-number">10</span>);<br>            excelWriter.write(data, writeSheet);<br>        &#125;<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">// 千万别忘记finish 会帮忙关闭流</span><br>        <span class="hljs-keyword">if</span> (excelWriter != <span class="hljs-literal">null</span>) &#123;<br>            excelWriter.finish();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="不同对象写到不同sheet中"><a href="#不同对象写到不同sheet中" class="headerlink" title="不同对象写到不同sheet中"></a>不同对象写到不同sheet中</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 重复多次写入-写到不同的sheet 不同的对象</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 1. 创建excel对应的实体对象 参照&#123;<span class="hljs-doctag">@link</span> SimpleWriteEntity&#125;</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 2. 使用&#123;<span class="hljs-doctag">@link</span> ExcelProperty&#125;注解指定复杂的头</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 3. 直接调用二次写入即可</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testWriteManyDataAndManySheet</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> FileUtil.readUserHomeFile(<span class="hljs-string">&quot;WriteManyDataAndManySheet&quot;</span> + System.currentTimeMillis() + SUFFIX_EXCEL_FILE_TYPE);<br>    <span class="hljs-type">ExcelWriter</span> <span class="hljs-variable">excelWriter</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">// 这里 指定文件</span><br>        excelWriter = EasyExcel.write(file).build();<br>        <span class="hljs-comment">// 去调用写入,这里我调用了五次，实际使用时根据数据库分页的总的页数来。这里最终会写到5个sheet里面</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>            <span class="hljs-comment">/**每次都要创建writeSheet 这里注意必须指定sheetNo 而且sheetName必须不一样。</span><br><span class="hljs-comment">             * 这里注意&#123;<span class="hljs-doctag">@link</span> SimpleWriteEntity&#125;.class 可以每次都变，我这里为了方便 所以用的同一个class 实际上可以一直变</span><br><span class="hljs-comment">              */</span><br>            <span class="hljs-type">WriteSheet</span> <span class="hljs-variable">writeSheet</span> <span class="hljs-operator">=</span> EasyExcel.writerSheet(i, <span class="hljs-string">&quot;模板&quot;</span> + i).head(SimpleWriteEntity.class).build();<br>            <span class="hljs-comment">// 分页去数据库查询数据 这里可以去数据库查询每一页的数据</span><br>            List&lt;SimpleWriteEntity&gt; data = createData(<span class="hljs-number">5</span>);<br>            excelWriter.write(data, writeSheet);<br>        &#125;<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">// 千万别忘记finish 会帮忙关闭流</span><br>        <span class="hljs-keyword">if</span> (excelWriter != <span class="hljs-literal">null</span>) &#123;<br>            excelWriter.finish();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="日期、数字或者自定义格式转换"><a href="#日期、数字或者自定义格式转换" class="headerlink" title="日期、数字或者自定义格式转换"></a>日期、数字或者自定义格式转换</h2><h3 id="对象-3"><a href="#对象-3" class="headerlink" title="对象"></a>对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Getter</span><br><span class="hljs-meta">@Setter</span><br><span class="hljs-meta">@ToString</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CoverDataWriteEntity</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 我想所有的 字符串起前面加上&quot;自定义：&quot;三个字</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@ExcelProperty(value = &quot;字符串标题&quot;, converter = CustomStringConverter.class)</span><br>    <span class="hljs-keyword">private</span> String title;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 我想写到excel 用年月日的格式</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@DateTimeFormat(&quot;yyyy年MM月dd日HH时mm分ss秒&quot;)</span><br>    <span class="hljs-keyword">private</span> Date dateTitle;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 我想写到excel 用百分比表示</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@NumberFormat(&quot;#.##%&quot;)</span><br>    <span class="hljs-meta">@ExcelProperty(&quot;数字标题&quot;)</span><br>    <span class="hljs-keyword">private</span> Double numberTitle;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="测试代码-5"><a href="#测试代码-5" class="headerlink" title="测试代码"></a>测试代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 日期、数字或者自定义格式转换</span><br><span class="hljs-comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="hljs-doctag">@link</span> CoverDataWriteEntity&#125;</span><br><span class="hljs-comment"> * &lt;p&gt;2. 使用&#123;<span class="hljs-doctag">@link</span> ExcelProperty&#125;配合使用注解&#123;<span class="hljs-doctag">@link</span> DateTimeFormat&#125;、&#123;<span class="hljs-doctag">@link</span> NumberFormat&#125;或者自定义注解</span><br><span class="hljs-comment"> * &lt;p&gt;3. 直接写即可</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testWriteWithCovertData</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> FileUtil.readUserHomeFile(<span class="hljs-string">&quot;WriteWithCovertData&quot;</span> + System.currentTimeMillis() + SUFFIX_EXCEL_FILE_TYPE);<br>    <span class="hljs-comment">// 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br>    EasyExcel.write(file, CoverDataWriteEntity.class).sheet(<span class="hljs-string">&quot;模板&quot;</span>).doWrite(createData(<span class="hljs-number">10</span>));<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="图片导出"><a href="#图片导出" class="headerlink" title="图片导出"></a>图片导出</h2><h3 id="对象-4"><a href="#对象-4" class="headerlink" title="对象"></a>对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ContentRowHeight(100)</span><br><span class="hljs-meta">@ColumnWidth(100 / 8)</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ImageWriteEntity</span> &#123;<br>    <span class="hljs-keyword">private</span> File file;<br>    <span class="hljs-keyword">private</span> InputStream inputStream;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 如果string类型 必须指定转换器，string默认转换成string</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@ExcelProperty(converter = StringImageConverter.class)</span><br>    <span class="hljs-keyword">private</span> String string;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">byte</span>[] byteArray;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 根据url导出</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@since</span> 2.1.1</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> URL url;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="测试代码-6"><a href="#测试代码-6" class="headerlink" title="测试代码"></a>测试代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 图片导出</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 1. 创建excel对应的实体对象 参照&#123;<span class="hljs-doctag">@link</span> ImageWriteEntity&#125;</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 2. 直接写即可</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testWriteImage</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> FileUtil.readUserHomeFile(<span class="hljs-string">&quot;WriteImage&quot;</span> + System.currentTimeMillis() + SUFFIX_EXCEL_FILE_TYPE);<br>    <span class="hljs-comment">// 如果使用流 记得关闭</span><br>    <span class="hljs-type">InputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        List&lt;ImageWriteEntity&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;ImageWriteEntity&gt;();<br>        <span class="hljs-type">ImageWriteEntity</span> <span class="hljs-variable">imageData</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageWriteEntity</span>();<br>        list.add(imageData);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">imagePath</span> <span class="hljs-operator">=</span> FileUtil.getPath() + <span class="hljs-string">&quot;image&quot;</span> + File.separator + <span class="hljs-string">&quot;img.jpg&quot;</span>;<br>        <span class="hljs-comment">// 放入五种类型的图片 实际使用只要选一种即可</span><br>        imageData.setByteArray(FileUtils.readFileToByteArray(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(imagePath)));<br>        imageData.setFile(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(imagePath));<br>        imageData.setString(imagePath);<br>        inputStream = FileUtils.openInputStream(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(imagePath));<br>        imageData.setInputStream(inputStream);<br>        imageData.setUrl(<span class="hljs-keyword">new</span> <span class="hljs-title class_">URL</span>(<br>                <span class="hljs-string">&quot;https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fc-ssl.duitang.com%2Fuploads%2Fitem%2F201610%2F05%2F20161005195151_rzGhS.thumb.400_0.jpeg&amp;refer=http%3A%2F%2Fc-ssl.duitang.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1625563170&amp;t=8d28f9633784ab21a52583629fcbac53&quot;</span>));<br>        EasyExcel.write(file, ImageWriteEntity.class).sheet().doWrite(list);<br>    &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>        e.printStackTrace();<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-keyword">if</span> (inputStream != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                inputStream.close();<br>            &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="注解自定义样式"><a href="#注解自定义样式" class="headerlink" title="注解自定义样式"></a>注解自定义样式</h2><h3 id="对象-5"><a href="#对象-5" class="headerlink" title="对象"></a>对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Getter</span><br><span class="hljs-meta">@Setter</span><br><span class="hljs-meta">@ToString</span><br><span class="hljs-comment">// 头背景设置成红色 IndexedColors.RED.getIndex()</span><br><span class="hljs-meta">@HeadStyle(fillPatternType = FillPatternType.SOLID_FOREGROUND, fillForegroundColor = 10)</span><br><span class="hljs-comment">// 头字体设置成20</span><br><span class="hljs-meta">@HeadFontStyle(fontHeightInPoints = 20)</span><br><span class="hljs-comment">// 内容的背景设置成绿色 IndexedColors.GREEN.getIndex()</span><br><span class="hljs-meta">@ContentStyle(fillPatternType = FillPatternType.SOLID_FOREGROUND, fillForegroundColor = 17)</span><br><span class="hljs-comment">// 内容字体设置成20</span><br><span class="hljs-meta">@ContentFontStyle(fontHeightInPoints = 20)</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@ClassName</span> SimpleWriteEntity</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@Description</span> Excel简单写实体类,通过注解写入样式</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@Author</span> will</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@Date</span> 2021/5/29 21:58</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleWriteWithStyleByAnnotationEntity</span> &#123;<br><br>    <span class="hljs-comment">// 字符串的头背景设置成粉红 IndexedColors.PINK.getIndex()</span><br>    <span class="hljs-meta">@HeadStyle(fillPatternType = FillPatternType.SOLID_FOREGROUND, fillForegroundColor = 14)</span><br>    <span class="hljs-comment">// 字符串的头字体设置成20</span><br>    <span class="hljs-meta">@HeadFontStyle(fontHeightInPoints = 30)</span><br>    <span class="hljs-comment">// 字符串的内容的背景设置成天蓝 IndexedColors.SKY_BLUE.getIndex()</span><br>    <span class="hljs-meta">@ContentStyle(fillPatternType = FillPatternType.SOLID_FOREGROUND, fillForegroundColor = 40)</span><br>    <span class="hljs-comment">// 字符串的内容字体设置成20</span><br>    <span class="hljs-meta">@ContentFontStyle(fontHeightInPoints = 30)</span><br><br>    <span class="hljs-meta">@ExcelProperty(&quot;字符串标题&quot;)</span><br>    <span class="hljs-keyword">private</span> String title;<br>    <span class="hljs-meta">@ExcelProperty(&quot;日期标题&quot;)</span><br>    <span class="hljs-keyword">private</span> Date dateTitle;<br>    <span class="hljs-meta">@ExcelProperty(&quot;数字标题&quot;)</span><br>    <span class="hljs-keyword">private</span> Double numberTitle;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 忽略这个字段</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@ExcelIgnore</span><br>    <span class="hljs-keyword">private</span> String ignoreFiled;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="测试代码-7"><a href="#测试代码-7" class="headerlink" title="测试代码"></a>测试代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 注解形式自定义样式</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 1. 创建excel对应的实体对象 参照&#123;<span class="hljs-doctag">@link</span> SimpleWriteWithStyleByAnnotationEntity&#125;</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 3. 直接写即可</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2.2.0-beta1</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testWriteWithStyleByAnnotation</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> FileUtil.readUserHomeFile(<span class="hljs-string">&quot;WriteWithStyleByAnnotation&quot;</span> + System.currentTimeMillis() + SUFFIX_EXCEL_FILE_TYPE);<br>    <span class="hljs-comment">// 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br>    EasyExcel.write(file, SimpleWriteWithStyleByAnnotationEntity.class).sheet(<span class="hljs-string">&quot;模板&quot;</span>).doWrite(createData(<span class="hljs-number">10</span>));<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="自定义样式"><a href="#自定义样式" class="headerlink" title="自定义样式"></a>自定义样式</h2><h3 id="测试代码-8"><a href="#测试代码-8" class="headerlink" title="测试代码"></a>测试代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 自定义样式</span><br><span class="hljs-comment"> * &lt;p&gt;1. 创建excel对应的实体对象 参照&#123;<span class="hljs-doctag">@link</span> SimpleWriteEntity&#125;</span><br><span class="hljs-comment"> * &lt;p&gt;2. 创建一个style策略 并注册</span><br><span class="hljs-comment"> * &lt;p&gt;3. 直接写即可</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testWriteWithStyleByCustom</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> FileUtil.readUserHomeFile(<span class="hljs-string">&quot;WriteWithStyleByCustom&quot;</span> + System.currentTimeMillis() + SUFFIX_EXCEL_FILE_TYPE);<br>    <span class="hljs-comment">// 头的策略</span><br>    <span class="hljs-type">WriteCellStyle</span> <span class="hljs-variable">headWriteCellStyle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WriteCellStyle</span>();<br>    <span class="hljs-comment">// 背景设置为红色</span><br>    headWriteCellStyle.setFillForegroundColor(IndexedColors.RED.getIndex());<br>    <span class="hljs-type">WriteFont</span> <span class="hljs-variable">headWriteFont</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WriteFont</span>();<br>    headWriteFont.setFontHeightInPoints((<span class="hljs-type">short</span>)<span class="hljs-number">20</span>);<br>    headWriteCellStyle.setWriteFont(headWriteFont);<br>    <span class="hljs-comment">// 内容的策略</span><br>    <span class="hljs-type">WriteCellStyle</span> <span class="hljs-variable">contentWriteCellStyle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WriteCellStyle</span>();<br>    <span class="hljs-comment">// 这里需要指定 FillPatternType 为FillPatternType.SOLID_FOREGROUND 不然无法显示背景颜色.头默认了 FillPatternType所以可以不指定</span><br>    contentWriteCellStyle.setFillPatternType(FillPatternType.SOLID_FOREGROUND);<br>    <span class="hljs-comment">// 背景绿色</span><br>    contentWriteCellStyle.setFillForegroundColor(IndexedColors.GREEN.getIndex());<br>    <span class="hljs-type">WriteFont</span> <span class="hljs-variable">contentWriteFont</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WriteFont</span>();<br>    <span class="hljs-comment">// 字体大小</span><br>    contentWriteFont.setFontHeightInPoints((<span class="hljs-type">short</span>)<span class="hljs-number">20</span>);<br>    contentWriteCellStyle.setWriteFont(contentWriteFont);<br>    <span class="hljs-comment">// 这个策略是 头是头的样式 内容是内容的样式 其他的策略可以自己实现</span><br>    <span class="hljs-type">HorizontalCellStyleStrategy</span> <span class="hljs-variable">horizontalCellStyleStrategy</span> <span class="hljs-operator">=</span><br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">HorizontalCellStyleStrategy</span>(headWriteCellStyle, contentWriteCellStyle);<br><br>    <span class="hljs-comment">// 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br>    EasyExcel.write(file, SimpleWriteEntity.class).registerWriteHandler(horizontalCellStyleStrategy).sheet(<span class="hljs-string">&quot;模板&quot;</span>)<br>            .doWrite(createData(<span class="hljs-number">10</span>));<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="动态头，实时生成头写入"><a href="#动态头，实时生成头写入" class="headerlink" title="动态头，实时生成头写入"></a>动态头，实时生成头写入</h2><h3 id="创建头数据"><a href="#创建头数据" class="headerlink" title="创建头数据"></a>创建头数据</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> List&lt;List&lt;String&gt;&gt; <span class="hljs-title function_">head</span><span class="hljs-params">()</span> &#123;<br>    List&lt;List&lt;String&gt;&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;List&lt;String&gt;&gt;();<br>    List&lt;String&gt; head0 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;String&gt;();<br>    head0.add(<span class="hljs-string">&quot;字符串&quot;</span> + System.currentTimeMillis());<br>    List&lt;String&gt; head1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;String&gt;();<br>    head1.add(<span class="hljs-string">&quot;数字&quot;</span> + System.currentTimeMillis());<br>    List&lt;String&gt; head2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;String&gt;();<br>    head2.add(<span class="hljs-string">&quot;日期&quot;</span> + System.currentTimeMillis());<br>    list.add(head0);<br>    list.add(head1);<br>    list.add(head2);<br>    <span class="hljs-keyword">return</span> list;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="测试代码-9"><a href="#测试代码-9" class="headerlink" title="测试代码"></a>测试代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 动态头，实时生成头写入</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 思路是这样子的，先创建List&lt;String&gt;头格式的sheet仅仅写入头,然后通过table 不写入头的方式 去写入数据</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 1. 创建excel对应的实体对象 参照&#123;<span class="hljs-doctag">@link</span> SimpleWriteEntity&#125;</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 2. 然后写入table即可</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testWriteByDynamicHead</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> FileUtil.readUserHomeFile(<span class="hljs-string">&quot;WriteByDynamicHead&quot;</span> + System.currentTimeMillis() + SUFFIX_EXCEL_FILE_TYPE);<br>    EasyExcel.write(file)<br>            <span class="hljs-comment">// 这里放入动态头</span><br>            .head(head()).sheet(<span class="hljs-string">&quot;模板&quot;</span>)<br>            <span class="hljs-comment">// 当然这里数据也可以用 List&lt;List&lt;String&gt;&gt; 去传入</span><br>            .doWrite(createData(<span class="hljs-number">10</span>));<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="自定义拦截器"><a href="#自定义拦截器" class="headerlink" title="自定义拦截器"></a>自定义拦截器</h2><h3 id="创建Excel表拦截器"><a href="#创建Excel表拦截器" class="headerlink" title="创建Excel表拦截器"></a>创建Excel表拦截器</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@ClassName</span> CustomCellWriteHandler</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@Description</span> 自定义拦截器。对第一行第一列的头超链接到:https://github.com/alibaba/easyexcel</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@Author</span> will</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@Date</span> 2021/6/6 17:40</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomCellWriteHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">CellWriteHandler</span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">LOGGER</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(CustomCellWriteHandler.class);<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeCellCreate</span><span class="hljs-params">(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, Row row, Head head</span><br><span class="hljs-params">            , Integer integer, Integer integer1, Boolean aBoolean)</span> &#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCellCreate</span><span class="hljs-params">(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, Cell cell</span><br><span class="hljs-params">            , Head head, Integer integer, Boolean aBoolean)</span> &#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCellDataConverted</span><span class="hljs-params">(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, CellData cellData</span><br><span class="hljs-params">            , Cell cell, Head head, Integer integer, Boolean aBoolean)</span> &#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCellDispose</span><span class="hljs-params">(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, List&lt;CellData&gt; list</span><br><span class="hljs-params">            , Cell cell, Head head, Integer integer, Boolean isHead)</span> &#123;<br>        <span class="hljs-comment">// 这里可以对cell进行任何操作</span><br>        LOGGER.info(<span class="hljs-string">&quot;第&#123;&#125;行，第&#123;&#125;列写入完成。&quot;</span>, cell.getRowIndex(), cell.getColumnIndex());<br>        <span class="hljs-keyword">if</span> (isHead &amp;&amp; cell.getColumnIndex() == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-type">CreationHelper</span> <span class="hljs-variable">createHelper</span> <span class="hljs-operator">=</span> writeSheetHolder.getSheet().getWorkbook().getCreationHelper();<br>            <span class="hljs-type">Hyperlink</span> <span class="hljs-variable">hyperlink</span> <span class="hljs-operator">=</span> createHelper.createHyperlink(HyperlinkType.URL);<br>            hyperlink.setAddress(<span class="hljs-string">&quot;https://github.com/alibaba/easyexcel&quot;</span>);<br>            cell.setHyperlink(hyperlink);<br>    &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="创建ExcelSheet拦截器"><a href="#创建ExcelSheet拦截器" class="headerlink" title="创建ExcelSheet拦截器"></a>创建Excel<code>Sheet</code>拦截器</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@ClassName</span> CustomSheetWriteHandler</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@Description</span>  自定义拦截器.对第一列第一行和第二行的数据新增下拉框，显示 测试1 测试2</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@Author</span> will</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@Date</span> 2021/6/6 17:44</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomSheetWriteHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">SheetWriteHandler</span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">LOGGER</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(CustomSheetWriteHandler.class);<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeSheetCreate</span><span class="hljs-params">(WriteWorkbookHolder writeWorkbookHolder, WriteSheetHolder writeSheetHolder)</span> &#123;<br><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterSheetCreate</span><span class="hljs-params">(WriteWorkbookHolder writeWorkbookHolder, WriteSheetHolder writeSheetHolder)</span> &#123;<br>        LOGGER.info(<span class="hljs-string">&quot;第&#123;&#125;个Sheet写入成功。&quot;</span>, writeSheetHolder.getSheetNo());<br>        <span class="hljs-comment">// 区间设置 第一列第一行和第二行的数据。由于第一行是头，所以第一、二行的数据实际上是第二三行</span><br>        <span class="hljs-type">CellRangeAddressList</span> <span class="hljs-variable">cellRangeAddressList</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CellRangeAddressList</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>        <span class="hljs-type">DataValidationHelper</span> <span class="hljs-variable">helper</span> <span class="hljs-operator">=</span> writeSheetHolder.getSheet().getDataValidationHelper();<br>        <span class="hljs-type">DataValidationConstraint</span> <span class="hljs-variable">constraint</span> <span class="hljs-operator">=</span> helper.createExplicitListConstraint(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[] &#123;<span class="hljs-string">&quot;测试1&quot;</span>, <span class="hljs-string">&quot;测试2&quot;</span>&#125;);<br>        <span class="hljs-type">DataValidation</span> <span class="hljs-variable">dataValidation</span> <span class="hljs-operator">=</span> helper.createValidation(constraint, cellRangeAddressList);<br>        writeSheetHolder.getSheet().addValidationData(dataValidation);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="测试代码-10"><a href="#测试代码-10" class="headerlink" title="测试代码"></a>测试代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 下拉，超链接等自定义拦截器（上面几点都不符合但是要对单元格进行操作的参照这个）</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * demo这里实现2点。</span><br><span class="hljs-comment"> * 1. 对第一行第一列的头超链接到:https://github.com/alibaba/easyexcel</span><br><span class="hljs-comment"> * 2. 对第一列第一行和第二行的数据新增下拉框，显示 测试1 测试2</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 1. 创建excel对应的实体对象 参照&#123;<span class="hljs-doctag">@link</span> SimpleWriteEntity&#125;</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 2. 注册拦截器 &#123;<span class="hljs-doctag">@link</span> CustomCellWriteHandler&#125; &#123;<span class="hljs-doctag">@link</span> CustomSheetWriteHandler&#125;</span><br><span class="hljs-comment"> * &lt;p&gt;</span><br><span class="hljs-comment"> * 2. 直接写即可</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testWriteByCustomHandler</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> FileUtil.readUserHomeFile(<span class="hljs-string">&quot;WriteByCustomHandler&quot;</span> + System.currentTimeMillis() + SUFFIX_EXCEL_FILE_TYPE);<br>    <span class="hljs-comment">// 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭</span><br>    EasyExcel.write(file, SimpleWriteEntity.class).registerWriteHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomSheetWriteHandler</span>())<br>            .registerWriteHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomCellWriteHandler</span>()).sheet(<span class="hljs-string">&quot;模板&quot;</span>).doWrite(createData(<span class="hljs-number">10</span>));<br>&#125;<br></code></pre></td></tr></table></figure></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/%E5%A5%BD%E5%A5%BD%E7%A0%81%E4%BB%A3%E7%A0%81%E5%90%96/" class="category-chain-item">好好码代码吖</a> <span>></span> <a href="/categories/%E5%A5%BD%E5%A5%BD%E7%A0%81%E4%BB%A3%E7%A0%81%E5%90%96/JAVA/" class="category-chain-item">JAVA</a> <span>></span> <a href="/categories/%E5%A5%BD%E5%A5%BD%E7%A0%81%E4%BB%A3%E7%A0%81%E5%90%96/JAVA/POI/" class="category-chain-item">POI</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/POI/">#POI</a> <a href="/tags/EasyExcel/">#EasyExcel</a></div></div><div class="license-box my-3"><div class="license-title"><div>EasyExcel保姆级教程(2)</div><div>https://github.com/yangxiangnanwill/yangxiangnanwill.github.io/2023/05/28/好好码代码吖/JAVA/POI/EasyExcel保姆级教程(2)/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>will</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2023年5月28日</div></div><div class="license-meta-item"><div>许可协议</div><div><a target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/2023/05/28/%E5%A5%BD%E5%A5%BD%E7%A0%81%E4%BB%A3%E7%A0%81%E5%90%96/JAVA/POI/Excel%E7%94%9F%E6%88%90%E5%BB%BA%E8%A1%A8%E8%AF%AD%E5%8F%A5/" title="Excel生成建表语句"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">Excel生成建表语句</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2023/05/28/%E5%A5%BD%E5%A5%BD%E7%A0%81%E4%BB%A3%E7%A0%81%E5%90%96/JAVA/POI/EasyExcel%E4%BF%9D%E5%A7%86%E7%BA%A7%E6%95%99%E7%A8%8B(1)/" title="EasyExcel保姆级教程(1)"><span class="hidden-mobile">EasyExcel保姆级教程(1)</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t){var e=Fluid.plugins.typing;(t=t.getElementById("subtitle"))&&e&&e(t.getAttribute("data-typed-text"))}((window,document))</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){var t;"tocbot"in window&&(tocbot.refresh(),0!==(t=jQuery("#toc")).length)&&tocbot&&0<t.find(".toc-list-item").length&&t.css("visibility","visible")}))})</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback(function(){if("anchors"in window){anchors.removeAll();var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}})})</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>